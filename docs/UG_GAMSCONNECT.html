<!-- modified HTML header for doxygen 1.12.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta name="generator" content="Doxygen"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!--PROJECTNAME GAMS Documentation-->
<title>GAMS Connect</title>
<!--<link href="./style/tabs.css" rel="stylesheet" type="text/css"/>-->
<script type="text/javascript" src="./style/jquery.js"></script>
<script type="text/javascript" src="./style/jquery.highlight.js"></script>
<script type="text/javascript" src="./style/dynsections.js"></script>
<script type="text/javascript" src="./style/resize.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="./style/MathJax/es5/tex-svg.js"></script>
<script type="text/javascript" language="javascript" src="./style/prism.js"></script>
<link href="./style/prism.css" rel="stylesheet" type="text/css" />
<link href="./style/stylesheet.css" rel="stylesheet" type="text/css" id="gamsstylesheet" />
<link href="./style/navtree.css" rel="stylesheet" type="text/css" />
<link href="./style/icono.min.css" rel="stylesheet"  type="text/css" />
<link href="./style/stylesheet-new.css" rel="stylesheet" type="text/css" id="newgamsstylesheet" />
<script type="text/javascript" src="./style/toc-highlight.js"></script>
<script type="text/javascript" src="./style/doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="./style/doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- -->

<link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/img/favicons/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/img/favicons/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/img/favicons/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/img/favicons/apple-icon-180x180.png" />
<link rel="icon" type="image/png" sizes="192x192"  href="/img/favicons/android-icon-192x192.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicons/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/img/favicons/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicons/favicon-16x16.png" />
<link rel="manifest" href="/img/favicons/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<script defer data-domain="gams.com" src="https://plausible.io/js/script.file-downloads.js"></script>
<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
<link href="https://www.gams.com/css/website_custom.css" rel="stylesheet" type="text/css" id="customgamsstylesheet" />
</head>
<body class="doc-page" id="doc-page">
<header class="topnav" id="menu-area">
    





  <link rel="stylesheet" href="/scss/custom.min.8f1cf34ed4c4a291367186297b3ef5d070fb1783f3414cf1e4c4f2bf5a4bffa2.css" >

  <style>
    .row {
      flex-wrap: unset;
    }

  .modal-backdrop {
    z-index: 100;
  }

  </style>


<div class="gams-site">
  <nav id="gams-nav" class="navbar navbar-expand-xl navbar-light bg-white py-2 px-2">
      
    <div class="container px-0">
    
      <a class="navbar-brand p-0" href="/">
          <img id="gams-logo" src="/img/gams_logo.svg" alt="" width="250">
        </a>
        
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse flex-column" id="navbarNavDropdown">
          
          <ul id="top-buttons" class="navbar-nav flex-row ml-auto">
            
            <li  class="nav-item">
                <a id="navBuyBtn" style="" class="top-button btn btn-gams-light-orange" href="/buy_gams" aria-label="Get a Quote Button">
                  <strong>GET A QUOTE</strong>
                </a>
              </li>
            
            
            <li class="nav-item ">
              <button id="searchBtn" type="button" class="top-button btn btn-secondary ml-2 " data-toggle="modal" data-target="#uni_searchModal" aria-label="Search Button">
                  <i width="18px" data-feather="search"></i> 
                  <strong> SEARCH</strong>
              </button>
            </li>
          
          </ul>
          
          
          <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Products</a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                <li><a class="dropdown-item" href="/products/gams/gams-language"> GAMS - The Modeling Language</a></li>
                <li><a class="dropdown-item" href="/sales/miro_facts/"> GAMS MIRO</a></li>
                <li><a class="dropdown-item" href="/sales/engine_facts/"> GAMS Engine</a></li>
                <li><a class="dropdown-item" href="/sales/gamspy_facts/"> GAMSPy</a></li></ul>
            </li>
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                <li><a class="dropdown-item" href="/latest/docs/"> GAMS</a></li>
                <li><a class="dropdown-item" href="/miro/"> MIRO</a></li>
                <li><a class="dropdown-item" href="/engine"> Engine</a></li>
                <li><a class="dropdown-item" href="https://gamspy.readthedocs.io/en/latest/index.html"> GAMSPy<i height='15px' data-feather='external-link'></i></a></li></ul>
            </li>
            
            
            <li class="nav-item">
              <a class="nav-link" href="/academics">Academics</a>
            </li><li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Download</a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                <li><a class="dropdown-item" href="/download/"> GAMS</a></li>
                <li><a class="dropdown-item" href="/miro/download.html"> MIRO</a></li>
                <li><a class="dropdown-item" href="/engine/installation.html"> Engine</a></li>
                <li><a class="dropdown-item" href="https://gamspy.readthedocs.io/en/latest/user/installation.html"> GAMSPy<i height='15px' data-feather='external-link'></i></a></li></ul>
            </li>
            
            
            <li class="nav-item">
              <a class="nav-link" href="/consulting">Consulting</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/support">Support</a>
            </li><li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Community</a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                <li><a class="dropdown-item" href="https:///www.gams.com/newsletter/signup/?utm_source=website&amp;utm_medium=menu&amp;utm_campaign=newsletter_signup"> Sign-up for our Newsletter</a></li>
                <li><a class="dropdown-item" href="/stories"> Case Studies</a></li>
                <li><a class="dropdown-item" href="https://forum.gams.com/"> The GAMS Forum<i height='15px' data-feather='external-link'></i></a></li>
                <li><a class="dropdown-item" href="/conferences"> Meet us at a Conference</a></li>
                <li><a class="dropdown-item" href="/blog"> Read our GAMS Blog</a></li>
                <li><a class="dropdown-item" href="/webinars"> Visit a GAMS Webinar</a></li>
                <li><a class="dropdown-item" href="/courses"> Take a GAMS Course</a></li></ul>
            </li>
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Us</a>
              <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                <li><a class="dropdown-item" href="/about/company"> Company Information</a></li>
                <li><a class="dropdown-item" href="/team"> The GAMS team</a></li>
                
                <li><a class="dropdown-item dropdown-toggle" href="#">Career</a>
                  <ul class="submenu submenu-left dropdown-menu"><li><a class="dropdown-item" href="/about/openings">Openings</a></li>
                    <li><a class="dropdown-item" href="/about/internships">Internships</a></li>
                    
                  </ul>
                </li>
                
                <li><a class="dropdown-item" href="/about/advisory"> Advisory Board</a></li>
                <li><a class="dropdown-item" href="/about/infosec"> Information Security</a></li></ul>
            </li>
            
            </ul>
        </div>
      </div> 
    </nav>
</div>


<div class="gams-site gams-modal-container">
  <div class="modal fade" id="uni_searchModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
      <div class="modal-content">

        <div class="modal-header">
          <h2 class='modal-title' id="exampleModalLabel">Search</h2>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">

          <section>

            <div class="input-group mb-3">
              <input type="text" id="uni_query" class="form-control" placeholder="What are you looking for?" aria-label="SearchQuery" aria-describedby="uni_searchbutton">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="button" id="uni_searchbutton">Search</button>
              </div>
            </div>

            <div style="display:none;">
              <input name="case_sensitive" id="case_sensitive" type="checkbox" ><label for="case_senstive">Case sensitive</label>
              <input name="match_whole_word" id="match_whole_word" type="checkbox"><label for="match_whole_word">Match whole word</label>
            </div>


            
            <div class="row">

              
              <div class="col-lg-4">
                <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                  
                  <a class="nav-link active" id="v-pills-gams-doc-tab" data-toggle="pill" href="#v-pills-gams-doc" role="tab" aria-controls="v-pills-gams-doc" aria-selected="false">GAMS Documentation</a>
                  <a class="nav-link" id="v-pills-mod-lib-tab" data-toggle="pill" href="#v-pills-mod-lib" role="tab" aria-controls="v-pills-mod-lib" aria-selected="false">Model Library</a>
                  <a class="nav-link" id="v-pills-miro-doc-tab" data-toggle="pill" href="#v-pills-miro-doc" role="tab" aria-controls="v-pills-miro-doc" aria-selected="false">MIRO Documentation</a>
                  <a class="nav-link" id="v-pills-engine-doc-tab" data-toggle="pill" href="#v-pills-engine-doc" role="tab" aria-controls="v-pills-engine-doc" aria-selected="false">ENGINE Documentation</a>
                  <a class="nav-link" id="v-pills-website-tab" data-toggle="pill" href="#v-pills-website" role="tab" aria-controls="v-pills-website" aria-selected="false">Website & Blog</a>
                </div>
              </div>


              
              <div class="col-lg-8">
                <div class="tab-content" id="v-pills-tabContent">


                  
                  

                  
                  <div class="tab-pane fade show active" id="v-pills-gams-doc" role="tabpanel" aria-labelledby="v-pills-gams-doc-tab">

                    <div id="uni_docsTab" class="mb-3 mt-3 mt-md-0" style="display: flex;">
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks active" onclick="uni_showSection(event, 'allsections')" id="uni_alldocsTab" value="docs/">All</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'userguides')" id="uni_ugTab" value="docs/"> User's Guide</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'solvers')" id="uni_solverTab" value="docs/">Solvers</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'tools')" id="uni_toolTab" value="docs/">Tools</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'apis')" id="uni_apiTab" value="docs/">APIs</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'releasenotes')" id="uni_rnTab" value="docs/">Release Notes</button>
                    </div>

                    <div class="uni_inforesults mb-3">
                      <div class="resultsummary"></div>
                    </div>

                    <div class="uni_searchresults"></div>

                    <div class="uni_navresults"></div>

                  </div>

                  
                  <div class="tab-pane fade show" id="v-pills-mod-lib" role="tabpanel" aria-labelledby="v-pills-mod-lib-tab">

                    <div id="uni_modlibsTab" class=" mb-3 mt-3 mt-md-0" style="display: flex;">
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks active" onclick="uni_showSection(event, 'all')" id="uni_allmodlibsTab" value="">All</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'gamslib')" id="uni_gamslibTab" value="">Model</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'testlib')" id="uni_testlibTab" value="">Test</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'datalib')" id="uni_datalibTab" value="">Data</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'emplib')" id="uni_emplibTab" value="">EMP</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'apilib')" id="uni_apilibTab" value="">API</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'finlib')" id="uni_finlibTab" value="">FIN</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'noalib')" id="uni_noalibTab" value="">NOA</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary uni_tablinks" onclick="uni_showSection(event, 'psoptlib')" id="uni_psoptlibTab" value="">PSOPT</button>
                    </div>

                    <div class="uni_inforesults mb-3">
                      <div class="resultsummary">
                      </div>
                    </div>

                    <div class="uni_searchresults">
                    </div>

                    <div class="uni_navresults"></div>



                  </div>

                  
                  <div class="tab-pane fade" id="v-pills-miro-doc" role="tabpanel" aria-labelledby="v-pills-miro-doc-tab">

                    <div class="uni_inforesults mb-3">
                      <div class="resultsummary">
                      </div>
                    </div>

                    <div class="uni_searchresults">
                    </div>

                    <div class="uni_navresults">
                    </div>


                  </div>

                  
                  <div class="tab-pane fade" id="v-pills-engine-doc" role="tabpanel" aria-labelledby="v-pills-engine-doc-tab">

                    <div class="uni_inforesults mb-3">
                      <div class="resultsummary">
                      </div>
                    </div>

                    <div class="uni_searchresults">
                    </div>

                    <div class="uni_navresults">
                    </div>


                  </div>
                  
                  <div class="tab-pane fade" id="v-pills-website" role="tabpanel" aria-labelledby="v-pills-website-tab">

                    <div class="uni_inforesults mb-3">
                      <div class="resultsummary">
                      </div>
                    </div>

                    <div class="uni_searchresults">
                    </div>

                    <div class="uni_navresults">
                    </div>

                  </div>

                </div>
              </div>
            </div>


          </section>

          
          <script src="https://www.gams.com/latest/docs/style/keyword.js"></script>

        </div>
      </div>
    </div>

  </div>
</div>


    <div class="versionwrapper">
      <li id='version' class='right'>
   <div class='styled-select'>
   <select id='versionfilter' class='selectbox'>
     <option id='50' value='/50/docs/index.html'>50 (latest)</option>
     <option id='49' value='/49/docs/index.html'>49</option>
     <option id='48' value='/48/docs/index.html'>48</option>
     <option id='47' value='/47/docs/index.html'>47</option>
     <option id='46' value='/46/docs/index.html'>46</option>
     <option id='45' value='/45/docs/index.html'>45</option>
     <option id='44' value='/44/docs/index.html'>44</option>
     <option id='43' value='/43/docs/index.html'>43</option>
     <option id='42' value='/42/docs/index.html'>42</option>
     <option id='41' value='/41/docs/index.html'>41</option>
     <option id='40' value='/40/docs/index.html'>40</option>
     <option id='39' value='/39/docs/index.html'>39</option>
     <option id='38' value='/38/docs/index.html'>38</option>
     <option id='37' value='/37/docs/index.html'>37</option>
     <option id='36' value='/36/docs/index.html'>36</option>
     <option id='35' value='/35/docs/index.html'>35</option>
     <option id='34' value='/34/docs/index.html'>34</option>
     <option id='33' value='/33/docs/index.html'>33</option>
     <option id='32' value='/32/docs/index.html'>32</option>
     <option id='31' value='/31/docs/index.html'>31</option>
     <option id='30' value='/30/docs/index.html'>30</option>
     <option id='29' value='/29/docs/index.html'>29</option>
     <option id='28' value='/28/docs/index.html'>28</option>
     <option id='27' value='/27/docs/index.html'>27</option>
     <option id='26' value='/26/docs/index.html'>26</option>
     <option id='25.1' value='/25.1/docs/index.html'>25.1</option>
   </select>
   </div>
</li>
<li class='right menutext'><div>Version:</div></li>

    </div> 
    <a href="javascript:void(0);" id="hamburger-nav" title="Open Menu" class="hamburger" onclick="toggleResponsive()">
       <div class="bar1"></div>
       <div class="bar2"></div>
       <div class="bar3"></div>
    </a>
    <a class="search" href="javascript:void(0);">
        <div class="searchwrapper">
           <div class="nav-icon"><i class="icono-search"></i></div>
           <input id="searchbar" type="text" placeholder="Search..." onkeypress="return handleSearchKeyPress(event);">
        </div>
    </a>
    <div class="nav">
        <div id="docs-menu-ctrl" title="Expand Submenu" class="submenu-icon collapsed"><i class="icono-caretDown"></i></div>
        <a id="docs" href="index.html" class="menu">Documentation</a>
        <div class="subnav">
            <a href="Preface.html" class="docsmenu collapsed">Preface</a>
            <a href="RN_MAIN.html" class="docsmenu collapsed">Release Notes</a>
            <a href="UG_MAIN.html#UG_INSTALL" class="docsmenu collapsed">Installation and Licensing</a>
            <a href="UG_MAIN.html#UG_Tutorial_Examples" class="docsmenu collapsed">Tutorials and Examples</a>
            <a href="UG_MAIN.html#UG_Language_Environment" class="docsmenu collapsed">GAMS Language and Environment</a>
            <a href="S_MAIN.html" class="docsmenu collapsed">Solver Manuals</a>
            <a href="T_MAIN.html" class="docsmenu collapsed">Tools Manuals</a>
            <a href="API_MAIN.html" class="docsmenu collapsed">Application Programming Interfaces</a>
            <a href="UG_Glossary.html" class="docsmenu collapsed">Glossary</a>
            <a href="citelist.html" class="docsmenu collapsed">Bibliograhpy</a>
        </div>
        <div id="modlibs-menu-ctrl" title="Expand Submenu" class="submenu-icon collapsed"><i class="icono-caretDown"></i></div>
        <a id="modlibs" href="modlibs.html" class="menu">Model Libraries</a>
        <div class="subnav">
            <a href="../gamslib_ml/libhtml/index.html" class="modlibsmenu collapsed">GAMS Model Library</a>
            <a href="../testlib_ml/libhtml/index.html" class="modlibsmenu collapsed">GAMS Test Library</a>
            <a href="../datalib_ml/libhtml/index.html" class="modlibsmenu collapsed">GAMS Data Library</a>
            <a href="../emplib_ml/libhtml/index.html" class="modlibsmenu collapsed">GAMS EMP Library</a>
            <a href="../apilib_ml/libhtml/index.html" class="modlibsmenu collapsed">GAMS API Library</a>
            <a href="../finlib_ml/libhtml/index.html" class="modlibsmenu collapsed">FIN Library</a>
            <a href="../noalib_ml/libhtml/index.html" class="modlibsmenu collapsed">NOA Library</a>
            <a href="../psoptlib_ml/libhtml/index.html" class="modlibsmenu collapsed">PSOPT Library</a>
        </div>  
        <a id="keyword" href="keyword.html" class="menu">Index</a>
        <a id="help" href="./style/../help.html" class="menu">Help</a>
    </div>  
</header>
<div id="content-area" class="content-page">
  <div  id="context-sidebar" class="ontop nav-menu">
    <div id="ctrl-expand-collapse"> 
        <div id="ctrl-icon" title="Show Table of Contents"><i class="icono-caretLeftCircle"></i></div>
        <span id="ctrl-toc-item" class="tocitem">Hide Table of Contents</span>
    </div>
    <div id="nav-area" class="collapsible-menu">
        <div id="nav-tree">
           <div id="nav-tree-contents">
             <div id="nav-sync" class="sync"></div>
        </div>
       </div>
    </div>
  </div>
  <div id="split-bar" class="expanded"></div>
  <div class="content" id="doc-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">GAMS Connect</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#UG_GAMSCONNECT_CONCEPT">Concept</a>
  </li>
  <li class="level1">
    <a href="#UG_GAMSCONNECT_USAGE">Usage</a>
    <ul>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_EDITOR">GAMS Studio Connect Editor</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#UG_GAMSCONNECT_AGENTS_OVERVIEW">Connect Agents Overview</a>
  </li>
  <li class="level1">
    <a href="#UG_GAMSCONNECT_GETTING_STARTED">Getting Started Examples</a>
    <ul>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_CSV">CSV</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_EXCEL">Excel</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_SQL">SQL</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#UG_GAMSCONNECT_AGENTS">Connect Agents</a>
    <ul>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_CONCATENATE">Concatenate</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_CSVREADER">CSVReader</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_CSVWRITER">CSVWriter</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_DOMAINWRITER">DomainWriter</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_EXCELREADER">ExcelReader</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_EXCELWRITER">ExcelWriter</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_FILTER">Filter</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_GDXREADER">GDXReader</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_GDXWRITER">GDXWriter</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_LABELMANIPULATOR">LabelManipulator</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_PROJECTION">Projection</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_PYTHONCODE">PythonCode</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_RAWCSVREADER">RawCSVReader</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_RAWEXCELREADER">RawExcelReader</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_SQLREADER">SQLReader</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_SQLWRITER">SQLWriter</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#UG_GAMSCONNECT_EXAMPLES">Examples</a>
    <ul>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_EXAMPLES_CONNECT06">Connect Example for Excel (executeTool win32.ExcelMerge)</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_EXAMPLES_CONNECT01">Connect Example for Excel</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_EXAMPLES_CONNECT02">Connect Example for CSV</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#UG_GAMSCONNECT_GAMSCONNECT_CMDPROGRAM">Command Line Utility gamsconnect</a>
  </li>
  <li class="level1">
    <a href="#UG_GAMSCONNECT_ADVANCED">Advanced Topics</a>
    <ul>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_CASE_SENSITIVITY">Concept of Case Sensitivity</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_TEXT_SUBSTITUTIONS_IN_YAML_FILE">Text Substitutions in YAML Instructions</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_ENCODING">Encoding of YAML Instructions</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_SORTING_BEHAVIOR">Sorting Behavior of Connect Agents</a>
      </li>
      <li class="level2">
        <a href="#UG_GAMSCONNECT_CUSTOM_PYTHON_CODE">Use Connect Agents in Custom Python Code</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="UG_GAMSCONNECT_CONCEPT"></a>
Concept</h1>
<p>GAMS Connect is a framework inspired by the concept of a so-called ETL (extract, transform, load) procedure that allows to integrate data from various data sources. The GAMS Connect framework consists of the Connect database and the Connect agents that operate on the Connect database. Via the available Connect interfaces the user passes instructions to call Connect agents for reading data from various file types into the Connect database, transforming data in the Connect database, and writing data from the Connect database to various file types. Instructions are passed in <a target="_blank" href="https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html">YAML syntax</a>. Note that in contrast to a typical ETL procedure, read, transform and write operations do not need to be strictly separated.</p>
<div class="image">
<img src="connect_database.png" alt=""/>
<div class="caption">
The GAMS Connect Framework</div></div>
<h1><a class="anchor" id="UG_GAMSCONNECT_USAGE"></a>
Usage</h1>
<p>GAMS Connect is available via the GAMS command line parameters <a class="el" href="UG_GamsCall.html#GAMSAOconnectin">ConnectIn</a> and <a class="el" href="UG_GamsCall.html#GAMSAOconnectout">ConnectOut</a>, via <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_Connect">embedded code Connect</a>, and as a standalone command line utility <a class="el" href="#UG_GAMSCONNECT_GAMSCONNECT_CMDPROGRAM">gamsconnect</a>.</p>
<p>Instructions processed by the GAMS Connect interfaces need to be passed in YAML syntax as follows: </p><pre class="fragment">- &lt;agent name1&gt;:
    &lt;root option1&gt;: &lt;value&gt;
    &lt;root option2&gt;: &lt;value&gt;
    .
    .
    &lt;root option3&gt;:
      - &lt;option1&gt;: &lt;value&gt;
        &lt;option2&gt;: &lt;value&gt;
        .
        .
      - &lt;option1&gt;: &lt;value&gt;
        &lt;option2&gt;: &lt;value&gt;
        .
        .
      .
      .
- &lt;agent name2&gt;:
    .
    .
.
.
</pre><p> The user lists the instructions to be performed. All individual agent instructions begin at the same indentation level starting with a <code>-</code> (a dash and a space) followed by the Connect agent name and a <code>:</code> (a colon). Connect agent options are represented in a simple <code>&lt;option&gt;: &lt;value&gt;</code> form. Please check the documentation of <a class="el" href="#UG_GAMSCONNECT_AGENTS">Connect Agents</a> for available options. Options at the first indentation level are called <code>root</code> options and typically define general settings, e.g. the file name. While some agents only have <code>root</code> options, others have a more complex options structure, where a root option may be a list of dictionaries containing other options. A common example is the root option <code>symbols</code> (see e.g. <a class="el" href="#UG_GAMSCONNECT_GDXREADER">GDXReader</a>). Via <code>symbols</code> many agents allow to define symbol specific options, e.g. the name of the symbol. The option tables of agents with a more complex options structure provide a <em>Scope</em> to reflect this structure - options may be allowed at the first indentation level (<code>root</code>) and/or are assigned to other root options (e.g. <code>symbols</code>).</p>
<p>Checkout the <a class="el" href="#UG_GAMSCONNECT_EDITOR">GAMS Studio Connect Editor</a> that allows creating and editing YAML instructions by a simple drag and drop of agents and corresponding options.</p>
<p>Note that <a target="_blank" href="https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html">YAML syntax</a> also supports an abbreviated form for lists and dictionary, e.g. <code>&lt;root option3&gt;: [ {&lt;option1&gt;: &lt;value&gt;, &lt;option2&gt;: &lt;value&gt;}, {&lt;option1&gt;: &lt;value&gt;, &lt;option2&gt;: &lt;value&gt;} ]</code>.</p>
<p>Here is an example that uses embedded Connect code to process instructions:</p>
<pre><code class="language-gams">$onecho &gt; distance.csv
i;j;distance in miles
seattle;new-york;2,5
seattle;chicago;1,7
seattle;topeka;1,8
san-diego;new-york;2,5
san-diego;chicago;1,8
san-diego;topeka;1,4
$offecho

$onecho &gt; capacity.csv
i,capacity in cases
seattle,350.0
san-diego,600.0
$offecho

Set i 'Suppliers', j 'Markets';
Parameter d(i&lt;,j&lt;) 'Distance', a(i) 'Capacity';

$onEmbeddedCode Connect:
- CSVReader:
    file: distance.csv
    name: distance
    indexColumns: [1, 2]
    valueColumns: [3]
    fieldSeparator: ';'
    decimalSeparator: ','
- CSVReader:
    file: capacity.csv
    name: capacity
    indexColumns: [1]
    valueColumns: [2]
- GAMSWriter:
    symbols:
      - name: distance
        newName: d
      - name: capacity
        newName: a
$offEmbeddedCode

display i, j, d, a;
</code></pre>
<p>In this example, we are reading two CSV files <code>distance.csv</code> and <code>capacity.csv</code> using the <a class="el" href="#UG_GAMSCONNECT_CSVREADER">CSVReader</a>. Then we directly write to symbols in GAMS using the <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a>.</p>
<h2><a class="anchor" id="UG_GAMSCONNECT_EDITOR"></a>
GAMS Studio Connect Editor</h2>
<p>The <a class="el" href="T_STUDIO.html#STUDIO_CONNECT_EDITOR">GAMS Studio Connect Editor</a> provides functionalities for creating and editing so-called GAMS Connect files, containing instructions in YAML syntax which will be processed by the GAMS Connect interfaces. With the Connect Editor, the user can create YAML instructions by a simple drag and drop of agents and corresponding options, instead of creating the YAML instructions for Connect manually. The content of the Connect file can also be displayed and edited in plain YAML format using a text editor. See documentation of the <a class="el" href="T_STUDIO.html#STUDIO_CONNECT_EDITOR">Connect Editor</a> for more information.</p>
<h1><a class="anchor" id="UG_GAMSCONNECT_AGENTS_OVERVIEW"></a>
Connect Agents Overview</h1>
<p>Current Connect agents support the following data source formats: CSV, Excel, GDX and SQL. The following Connect agents are available:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Connect agent   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Supported symbol types    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE">Concatenate</a>   </td><td class="markdownTableBodyLeft">Allows concatenating multiple symbols in the Connect database.   </td><td class="markdownTableBodyLeft">Sets and parameters    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER">CSVReader</a>   </td><td class="markdownTableBodyLeft">Allows reading a symbol from a specified CSV file into the Connect database.   </td><td class="markdownTableBodyLeft">Sets and parameters    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER">CSVWriter</a>   </td><td class="markdownTableBodyLeft">Allows writing a symbol in the Connect database to a specified CSV file.   </td><td class="markdownTableBodyLeft">Sets and parameters    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_DOMAINWRITER">DomainWriter</a>   </td><td class="markdownTableBodyLeft">Allows rewriting the domain information of an existing Connect symbol.   </td><td class="markdownTableBodyLeft">Sets, parameters, variables, and equations    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER">ExcelReader</a>   </td><td class="markdownTableBodyLeft">Allows reading symbols from a specified Excel file into the Connect database.   </td><td class="markdownTableBodyLeft">Sets and parameters    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER">ExcelWriter</a>   </td><td class="markdownTableBodyLeft">Allows writing symbols in the Connect database to a specified Excel file.   </td><td class="markdownTableBodyLeft">Sets and parameters    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER">Filter</a>   </td><td class="markdownTableBodyLeft">Allows to reduce symbol data by applying filters on labels and numerical values.   </td><td class="markdownTableBodyLeft">Sets, parameters, variables, and equations    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a>   </td><td class="markdownTableBodyLeft">Allows reading symbols from the GAMS database into the Connect database.   </td><td class="markdownTableBodyLeft">Sets, parameters, variables, and equations    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a>   </td><td class="markdownTableBodyLeft">Allows writing symbols in the Connect database to the GAMS database.   </td><td class="markdownTableBodyLeft">Sets, parameters, variables, and equations    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXREADER">GDXReader</a>   </td><td class="markdownTableBodyLeft">Allows reading symbols from a specified GDX file into the Connect database.   </td><td class="markdownTableBodyLeft">Sets, parameters, variables, and equations    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXWRITER">GDXWriter</a>   </td><td class="markdownTableBodyLeft">Allows writing symbols in the Connect database to a specified GDX file.   </td><td class="markdownTableBodyLeft">Sets, parameters, variables, and equations    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR">LabelManipulator</a>   </td><td class="markdownTableBodyLeft">Allows to modify labels of symbols in the Connect database.   </td><td class="markdownTableBodyLeft">Sets, parameters, variables, and equations    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a>   </td><td class="markdownTableBodyLeft">Allows index reordering, projection onto a reduced index space, and expansion to an extended index space through index duplication of a GAMS symbol.   </td><td class="markdownTableBodyLeft">Sets, parameters, variables, and equations    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PYTHONCODE">PythonCode</a>   </td><td class="markdownTableBodyLeft">Allows executing arbitrary Python code.   </td><td class="markdownTableBodyLeft">-    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER">RawCSVReader</a>   </td><td class="markdownTableBodyLeft">Allows reading unstructured data from a specified CSV file into the Connect database.   </td><td class="markdownTableBodyLeft">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER">RawExcelReader</a>   </td><td class="markdownTableBodyLeft">Allows reading unstructured data from a specified Excel file into the Connect database.   </td><td class="markdownTableBodyLeft">-    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER">SQLReader</a>   </td><td class="markdownTableBodyLeft">Allows reading symbols from a specified SQL database into the Connect database.   </td><td class="markdownTableBodyLeft">Sets and parameters    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER">SQLWriter</a>   </td><td class="markdownTableBodyLeft">Allows writing symbols in the Connect database to a specified SQL database.   </td><td class="markdownTableBodyLeft">Sets and parameters   </td></tr>
</table>
<h1><a class="anchor" id="UG_GAMSCONNECT_GETTING_STARTED"></a>
Getting Started Examples</h1>
<p>We introduce the basic functionalities of GAMS Connect agents on some simple examples. For more examples see section <a class="el" href="#UG_GAMSCONNECT_EXAMPLES">Examples</a>.</p>
<h2><a class="anchor" id="UG_GAMSCONNECT_GETTING_STARTED_CONNECT_CSV"></a>
CSV</h2>
<p>The following example (a modified version of the <a class="elRef" href="../gamslib_ml/libhtml/gamslib_trnsport.html">trnsport</a> model) shows how to read and write CSV files. The full example is part of DataLib as model <a class="elRef" href="../datalib_ml/libhtml/datalib_connect03.html">connect03</a>. Here is a code snippet of the first lines:</p>
<pre><code class="language-gams">$onEcho &gt; distance.csv
i,new-york,chicago,topeka
seattle,2.5,1.7,1.8
san-diego,2.5,1.8,1.4
$offEcho

$onEcho &gt; capacity.csv
i,capacity
seattle,350
san-diego,600
$offEcho

$onEcho &gt; demand.csv
j,demand
new-york,325
chicago,300
topeka,275
$offEcho

Set i 'canning plants', j 'markets';

Parameter d(i&lt;,j&lt;)  'distance in thousands of miles'
          a(i)      'capacity of plant i in cases'
          b(j)      'demand at market j in cases';

$onEmbeddedCode Connect:
- CSVReader:
    file: distance.csv
    name: d
    indexColumns: 1
    valueColumns: "2:lastCol"
- CSVReader:
    file: capacity.csv
    name: a
    indexColumns: 1
    valueColumns: 2
- CSVReader:
    file: demand.csv
    name: b
    indexColumns: 1
    valueColumns: 2
- GAMSWriter:
    symbols: all
$offEmbeddedCode

[...]
</code></pre>
<p>It starts out with the declaration of sets and parameters. With compile-time embedded Connect code, data for the parameters is read from CSV files using the Connect agent <a class="el" href="#UG_GAMSCONNECT_CSVREADER">CSVReader</a>. The CSVReader agent, for example, reads the CSV file <code>distance.csv</code> and creates the parameter <code>d</code> in the Connect database. The name of the parameter must be given by the option <a class="el" href="#UG_GAMSCONNECT_CSVREADER_NAME">name</a>. Column number 1 is specified as the first domain set using option <a class="el" href="#UG_GAMSCONNECT_CSVREADER_INDEXCOLS">indexColumns</a>. The <a class="el" href="#UG_GAMSCONNECT_CSVREADER_VALUECOLS">valueColumns</a> option is used to specify the column numbers 2, 3 and 4 containing the values. Per default, the first row of the columns specified via <code>valueColumns</code> will be used as the second domain set. The symbolic constant <code>lastCol</code> can be used if the number of index or value columns is unknown. As a last step, all symbols from the Connect database are written to the GAMS database using the Connect agent <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a>. The GAMSWriter agent makes the parameters <code>d</code>, <code>a</code> and <code>b</code> available outside the embedded Connect code. Note that the sets <code>i</code> and <code>j</code> are defined implicitly through parameter <code>d</code>.</p>
<p>Finally, after solving the <code>transport</code> model, Connect can be used to export results to a CSV file:</p>
<pre><code class="language-gams">[...]

Model transport / all /;

solve transport using lp minimizing z;

embeddedCode Connect:
- GAMSReader:
    symbols:
      - name: x
- Projection:
    name: x.l(i,j)
    newName: x_level(i,j)
- CSVWriter:
    file: shipment_quantities.csv
    name: x_level
    unstack: True
endEmbeddedCode
</code></pre>
<p>This time, we need to use execution-time embedded Connect code. The Connect agent <a class="el" href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a> imports variable <code>x</code> into the Connect database. With the Connect agent <a class="el" href="#UG_GAMSCONNECT_CSVWRITER">CSVWriter</a> we write the variable level to the CSV file <code>shipment_quantities.csv</code>:</p>
<pre class="fragment">i_0,new-york,chicago,topeka
seattle,50.0,300.0,0.0
san-diego,275.0,0.0,275.0
</pre><p>Setting the option <a class="el" href="#UG_GAMSCONNECT_CSVWRITER_UNSTACK">unstack</a> to <code>True</code> allows to use the last dimension as the header row.</p>
<h2><a class="anchor" id="UG_GAMSCONNECT_GETTING_STARTED_CONNECT_EXCEL"></a>
Excel</h2>
<p>The following example is part of GAMS Model Library as model <a class="elRef" href="../gamslib_ml/libhtml/gamslib_cta.html">cta</a> and shows how to read and write Excel spreadsheets. Here is a code snippet of the first lines:</p>
<pre><code class="language-gams">Set
   i 'rows'
   j 'columns'
   k 'planes';

Parameter
   dat(k&lt;,i&lt;,j&lt;) 'unprotected data table'
   pro(k,i,j)    'information sensitive cells';

* extract data from Excel workbook
$onEmbeddedCode Connect:
- ExcelReader:
    file: cox3.xlsx
    symbols:
      - name: dat
        range: Sheet1!A1
        rowDimension: 2
        columnDimension: 1
      - name: pro
        range: Sheet2!A1
        rowDimension: 2
        columnDimension: 1
- GAMSWriter:
    symbols: all
$offEmbeddedCode

[...]
</code></pre>
<p>It starts out with the declaration of sets and parameters. With compile-time embedded Connect code, data for the parameters is read from the Excel file <code>cox3.xlsx</code> using the Connect agent <a class="el" href="#UG_GAMSCONNECT_EXCELREADER">ExcelReader</a>. The ExcelReader agent allows reading data for multiple symbols that are listed under the keyword <code>symbols</code>, here, parameter <code>dat</code> and <code>pro</code>. For each symbol, the symbol name is given by option <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_NAME">name</a> and the Excel range by option <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_RNG">range</a>. The option <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_RDIM">rowDimension</a> defines that the first two columns of the data range will be used for the labels. In addition, the option <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_CDIM">columnDimension</a> defines that the first row of the data range will be used for the labels. As a last step, all symbols from the Connect database are written to the GAMS database using the Connect agent <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a>. The GAMSWriter agent makes the parameters <code>dat</code> and <code>pro</code> available outside the embedded Connect code. Note that the sets <code>i</code>, <code>j</code> and <code>k</code> are defined implicitly through parameter <code>dat</code>.</p>
<p>Finally, after solving the <code>cox3c</code> model with alternative solutions, Connect can be used to export results to Excel:</p>
<pre><code class="language-gams">[...]

loop(l$((obj.l - best)/best &lt;= 0.01),
   ll(l) = yes;
   binrep(s,l)             = round(b.l(s));
   binrep('','','Obj',l)   = obj.l;
   binrep('','','mSec',l)  = cox3c.resUsd*1000;
   binrep('','','nodes',l) = cox3c.nodUsd;
   binrep('Comp','Cells','Adjusted',l) = sum((i,j,k)$(not s(i,j,k)), 1$round(adjn.l(i,j,k) + adjp.l(i,j,k)));
   solve cox3c min obj using mip;
);

embeddedCode Connect:
- GAMSReader:
    symbols:
      - name: binrep
- ExcelWriter:
    file: results.xlsx
    clearSheet: True
    symbols:
      - name: binrep
endEmbeddedCode
</code></pre>
<p>This time, we need to use execution-time embedded Connect code. The Connect agent <a class="el" href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a> imports the reporting parameter <code>binrep</code> into the Connect database. With the Connect agent <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER">ExcelWriter</a> we write the parameter into the <code>binrep</code> sheet of the Excel file <code>results.xlsx</code>.</p>
<h2><a class="anchor" id="UG_GAMSCONNECT_GETTING_STARTED_CONNECT_SQL"></a>
SQL</h2>
<p>The following example (a modified version of the <a class="elRef" href="../gamslib_ml/libhtml/gamslib_whouse.html">whouse</a> model) shows how to read from and write to a SQL database (sqlite). The full example is part of DataLib as model <a class="elRef" href="../datalib_ml/libhtml/datalib_connect04.html">connect04</a>. Here is a code snippet of the first lines:</p>
<pre><code class="language-gams">[...]

Set t 'time in quarters';

Parameter
   price(t)  'selling price ($ per unit)'
   istock(t) 'initial stock      (units)';

Scalar
   storecost 'storage cost  ($ per quarter per unit)'
   storecap  'stocking capacity of warehouse (units)';

$onEmbeddedCode Connect:
- SQLReader:
    connection: {"database": "whouse.db"}
    symbols:
      - name: t
        query: "SELECT * FROM timeTable;"
        type: set
      - name: price
        query: "SELECT * FROM priceTable;"
      - name: istock
        query: "SELECT * FROM iniStockTable;"
      - name: storecost
        query: "SELECT * FROM storeCostTable;"
      - name: storecap
        query: "SELECT * FROM storeCapTable;"
- GAMSWriter:
    symbols: all
$offEmbeddedCode

[...]
</code></pre>
<p>It starts out with the declaration of sets and parameters. With compile-time embedded Connect code, data for all the symbols are read from the sqlite database <code>whouse.db</code> using the Connect agent <a class="el" href="#UG_GAMSCONNECT_SQLREADER">SQLReader</a> by passing the connection url through the option <a class="el" href="#UG_GAMSCONNECT_SQLREADER_CONNECTION">connection</a>. The SQLReader agent, for example, queries the table <code>priceTable</code> for data and creates the parameter <code>price</code> in the Connect database. The SQLReader allows reading data for multiple symbols that are listed under the keyword <code>symbols</code> and are fetched through the same connection. For each symbol the name must be given by the option <a class="el" href="#UG_GAMSCONNECT_SQLREADER_NAME">name</a>. The SQL query statement is passed through the option <a class="el" href="#UG_GAMSCONNECT_SQLREADER_QUERY">query</a>. The symbol type can be specified using the option <a class="el" href="#UG_GAMSCONNECT_SQLREADER_TYPE">type</a>. By default, every symbol is treated as a GAMS parameter. As a last step, all symbols from the Connect database are written to the GAMS database using the Connect agent <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a>. The GAMSWriter agent makes all read in symbols available outside the embedded Connect code.</p>
<p>Further, after solving the warehouse model, Connect can be used to export the results to tables in the SQL database.</p>
<pre><code class="language-gams">[...]

Model swp 'simple warehouse problem' / all /;

solve swp minimizing cost using lp;


embeddedCode Connect:
- GAMSReader:
    symbols: all
- Projection:
    name: stock.l(t)
    newName: stock_level(t)
- Projection:
    name: sell.l(t)
    newName: sell_level(t)
- Projection:
    name: buy.l(t)
    newName: buy_level(t)
- SQLWriter:
    connection: {"database": "whouse.db"}
    ifExists: replace
    symbols:
      - name: stock_level
        tableName: stock_level
      - name: sell_level
        tableName: sell_level
      - name: buy_level
        tableName: buy_level
endEmbeddedCode
</code></pre>
<p>Here, we need to use execution-time embedded Connect code. The Connect agent <a class="el" href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a> imports all the variables into the Connect database. The <a class="el" href="#UG_GAMSCONNECT_SQLWRITER">SQLWriter</a> agent then writes each symbol to respective tables in the SQL database <code>whouse.db</code>. For example the stock level:</p>
<pre class="fragment">|t_0     |level     |
|:-------|:---------|
|q-1     |100.0     |
|q-2     |0.0       |
|q-3     |0.0       |
|q-4     |0.0       |
</pre><p>The <a class="el" href="#UG_GAMSCONNECT_SQLWRITER_IFEXISTS">ifExists</a> option allows to either append to an extending table or replace it with new data. By default, the value for <code>ifExists</code> is set to <code>fails</code>.</p>
<h1><a class="anchor" id="UG_GAMSCONNECT_AGENTS"></a>
Connect Agents</h1>
<p>This section provides a reference for the available Connect agents and their options. Each agent provides a table overview of available options that allows to identify the scope of an option as well as its default value.</p>
<p>Each option can be either <em>optional</em> or <em>required</em>:</p><ul>
<li>If an optional option is omitted, it will automatically receive a default value.</li>
<li>Required options must be provided, but only if the parent option has been specified. A typical example is the <code>symbols</code> option. By default, <code>symbols</code> is set to <code>all</code> for certain agents. However, if <code>symbols</code> is specified as a list of individual symbols (instead of <code>all</code>), then its child option <code>name</code> becomes required.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The option value <code>null</code> indicates that an option is missing. For optional options, it is allowed to set <code>null</code> which will have the same effect as omitting the option. This means that even an explicit <code>null</code> will result in the default value for this option.</dd></dl>
<p>The table overview also allows to determine the scope of an option. In some cases, agents may have the same option available across different scopes, for example the <code>root</code> scope and the <code>symbols</code> scope:</p><ul>
<li>An omitted option in the <code>symbols</code> scope inherits its value from the <code>root</code> scope. Therefore, the technical default of the option in the <code>symbols</code> scope is <code>null</code> which indicates that the option is omitted and inherits the value from the <code>root</code> scope. Note that the table overview does not show this technical <code>null</code> default.</li>
<li>If an option is specified in the <code>symbols</code> scope, it will not inherit the value from the <code>root</code> scope.</li>
</ul>
<h2><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE"></a>
Concatenate</h2>
<p>The Concatenate agent allows concatenating multiple symbols (sets or parameters) in the Connect database into a single symbol of the same type. It takes the union of domain sets of all concatenated symbols and uses that as the domain for the output symbol. There are several options to guide this domain finding process which are explained below. The general idea is best explained with an example. Consider three parameters <code>p1(i,j)</code>, <code>p2(k,i)</code>, and <code>p3(k,l)</code>. The union of all domain sets is <code>i</code>, <code>j</code>, <code>k</code>, and <code>l</code> and, hence, the output symbol will be <code>parameterOutput(symbols,i,j,k,l)</code>. The very first index of <code>parameterOutput</code> contains the name of the concatenated symbol followed by the domain sets. If a domain set is not used by a concatenated symbol the corresponding records in <code>parameterOutput</code> will feature the <a class="el" href="#UG_GAMSCONNECT_CONCATENATE_EMPTYUEL">emptyUel</a>, a <code>-</code> (dash) by default, as the following figures show:</p>
<div class="image">
<img src="connect_concat1.png" alt=""/>
<div class="caption">
Parameter p1, p2 and p3</div></div>
 <div class="image">
<img src="connect_concat2.png" alt=""/>
<div class="caption">
The resulting parameterOutput</div></div>
<p>The Concatenate agent is especially useful in combination with UI components that provide a pivot table, like GAMS MIRO, to represent many individual output symbols in a single powerful and configurable table format.</p>
<p>Obviously, there are more complex situations with respect to the domain of the resulting <code>parameterOutput</code>. For example, only a subset of domain sets are relevant and the remaining ones should be combined in as few index positions as possible. For this, assume only domain sets <code>i</code> and <code>k</code> from the above example are relevant and <code>j</code> and <code>l</code> can be combined in a single index position - a so-called universal domain. The resulting <code>parameterOutput</code> would look as follows:</p>
<div class="image">
<img src="connect_concat3.png" alt=""/>
<div class="caption">
The resulting parameterOutput with relevant domains i and k</div></div>
<p>Moreover, the Concatenate agent needs to deal with universe domain sets <code>*</code> and domain sets that are used multiple times in a concatenated symbol. In addition to the <code>symbols</code> index (always the first index position of the output symbol), by default the union of domain sets of the concatenated symbols determine the domain of the output symbol. If a domain set (including the universe <code>*</code>) appears multiple times in a concatenated symbol domain, these duplicates will be part of the output symbol domain. For example, <code>q1(*,i,j,*)</code> and <code>q2(*,i,i)</code> will result in the output symbol <code>parameterOutput(symbols,*,i,j,*,i,)</code> by default, mapping index positions 1 to 4 of <code>q1</code> to positions 2 to 5 of <code>parameterOutput</code> and index positions 1 to 3 of <code>q2</code> to 2, 3, and 6.</p>
<p>All the described situations can be configured with a few options of the agent. The option <a class="el" href="#UG_GAMSCONNECT_CONCATENATE_OUTPUTDIMENSIONS">outputDimensions</a> allows to control the domain of the output symbol. The default behavior (<code>outputDimension: all</code>) gets the domain sets from the concatenated symbols and builds the union with duplicates if required. Alternatively, <code>outputDimensions</code> can be a list of the relevant domain sets (including an empty list). In any case, the agent iterates through the concatenated symbols and maps the index positions of a concatenated symbol into the index positions of the output symbol using the domain set names. Names not present in <code>outputDimensions</code> will be added as universal domains. Per default, the domain set names of a concatenated symbol will be the original domain set names as stored in the Connect database. There are two ways to adjust the domain set names of concatenated symbols: <a class="el" href="#UG_GAMSCONNECT_CONCATENATE_DIMENSIONMAP">dimensionMap</a> and an explicitly given domain for a symbol in the <a class="el" href="#UG_GAMSCONNECT_CONCATENATE_NAME">name</a> option. The <code>dimensionMap</code> which is given once and holds for all symbols allows to map original domain names of concatenated symbols to the desired domain names. The <code>name</code> option provides such a map by symbol and via the index position rather than the domain names of the concatenated symbol. In the above example with <code>p1(i,j)</code>, <code>p2(k,i)</code>, and <code>p3(k,l)</code>, we could put indices <code>i</code> and <code>l</code> as well as <code>j</code> and <code>k</code> together resulting in the following output symbol:</p>
<div class="image">
<img src="connect_concat4.png" alt=""/>
<div class="caption">
The resulting parameterOutput with i and l as well as j and k combined in a single index position</div></div>
<p>This can be accomplished in two ways: either we use <code>dimensionMap: {i: il, l: il, j: jk, k: jk}</code> or we use <code>name: p1(il,jk)</code>, <code>name: p2(jk,il)</code>, and <code>name: p3(jk,il)</code> to explicitly define the domain names for each symbol. Note that it is not required to set <code>outputDimensions: [il,jk]</code> since per default the union of domain sets is built using the mapped domain names. In case a domain set is used more than once in a domain of a concatenated symbol the mapping goes from left to right to find the corresponding output domain. If this is not desired, the <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent can be used to reorder index positions in symbols or explicit index naming can be used. In the example with <code>q1(*,i,j,*)</code> and <code>q2(*,i,i)</code>, the second index position of <code>q2</code> will be put together with the second index position of <code>q1</code>. If one wants to map the second <code>i</code> of <code>q2</code> (in the third index position) together with the <code>i</code> of <code>q1</code> (in second index position), one can, e.g. do with <code>name: q1(*,i,j,*)</code>, and <code>name: q2(*,i2,i)</code>.</p>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>The Concatenate agent creates result symbols <code>parameterOutput</code> and <code>setOutput</code> for parameters and sets separately. Both have the same output domain. If different output domains for <code>parameterOutput</code> and <code>setOutput</code> are desired, use two instantiations of the Concatenate agent.</li>
<li>Variables and equations need to be turned into parameters with the <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent before they can be concatenated.</li>
<li>If option <code>name</code> is given without an explicit domain for the concatenated symbol, the domain names stored in the Connect container are used and mapped via the <code>dimensionMap</code> option, if provided.</li>
<li>A domain set of a concatenated symbol that cannot be assigned to an index in <code>outputDimensions</code> will be mapped to a so-called universal domain. The Concatenate agent automatically adds as many universal domains as required to the output symbols.</li>
</ol>
</dd></dl>
<p>Here is an example that uses the Concatenate agent:</p>
<pre><code class="language-gams">Sets
   i(i) / i0*i3 "i_text" /
   j(j) / j0*j3 "j_text" /
   k(k) / k0*k3 "k_text" /;

Parameters
   p1(i) / i1 1 /
   p2(k,j) / k1.j0 2, k1.j1 3, k1.j3 4 /
   p3(j,j) / j1.j2 5, j2.j0 6, j3.j1 7, j3.j2 8 /
   s / 5 /;

Positive Variable x(i,j);
x.l(i,j)$(uniform(0,1)&gt;0.8) = uniformint(0,10);

embeddedCode Connect:
- GAMSReader:
    symbols: all
- Projection:
    name: x.l(i,j)
    newName: x_level(i,j)
- Concatenate:
    outputDimensions: [j,i]
- GDXWriter:
    file: concat_output.gdx
    symbols:
      - name: setOutput
      - name: parameterOutput
endEmbeddedCode
</code></pre>
<p>The resulting set and parameter outputs look as follows:</p>
<div class="image">
<img src="connect_concat5.png" alt="" width="700"/>
<div class="caption">
The resulting setOutput and parameterOutput</div></div>
<p>The following options are available for the Concatenate agent.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_DIMENSIONMAP">dimensionMap</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Define a mapping for the domain names of concatenated symbols as stored in the Connect database to the desired domain names.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_EMPTYUEL">emptyUel</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>-</code>   </td><td class="markdownTableBodyLeft">Define a character to use for empty UELs.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol with potentially index space.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_NEWNAME">newName</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a new name for the symbol in the <code>symbols</code> dimension of the output symbol.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_OUTPUTDIMENSIONS">outputDimensions</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Define the dimensions of the output symbols.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_PARAMETERNAME">parameterName</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>parameterOutput</code>   </td><td class="markdownTableBodyLeft">Name of the parameter output symbol.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_SETNAME">setName</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>setOutput</code>   </td><td class="markdownTableBodyLeft">Name of the set output symbol.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_SKIP">skip</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Indicate if sets or parameters should be skipped.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_SYMBOLSDIMENSION">symbolsDimension</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>True</code>   </td><td class="markdownTableBodyLeft">Specify if output symbols should have a <code>symbols</code> dimension.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CONCATENATE_UNIVERSALDIMENSION">universalDimension</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>uni</code>   </td><td class="markdownTableBodyLeft">Specify the base name of universal dimensions.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_DIMENSIONMAP"></a><b>dimensionMap:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Define a mapping for domain names of concatenated symbols as stored in the Connect database to the desired domain names. For example, <code>dimensionMap: {i: ij, j: ij}</code> will map both symbol domains <code>i</code> and <code>j</code> to <code>ij</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_EMPTYUEL"></a><b>emptyUel:</b> <em>string</em> (default: <code>-</code>) </p><blockquote class="doxtable">
<p>Define a character to use for empty UELs. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol with potentially index space. Requires the format <code>symName(i1,i2,...,iN)</code>. The index space may be specified to establish a mapping for the domain names of the symbol as stored in the Connect database to the desired domain names. If no index space is provided, the domain names stored in the Connect data are used and mapped via the <code>dimensionMap</code> option if provided. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_NEWNAME"></a><b>newName:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a new name for the symbol in the <code>symbols</code> dimension of the output symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_OUTPUTDIMENSIONS"></a><b>outputDimensions:</b> <code>all</code>, <em>list of strings</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>Define the dimensions of the output symbols explicitly using a list, e.g. <code>outputDimensions: [i,j]</code>. The default <code>all</code> gets the domain sets from the concatenated symbols and builds the union with duplicates if required. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_PARAMETERNAME"></a><b>parameterName:</b> <em>string</em> (default: <code>parameterOutput</code>) </p><blockquote class="doxtable">
<p>Name of the parameter output symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_SETNAME"></a><b>setName:</b> <em>string</em> (default: <code>setOutput</code>) </p><blockquote class="doxtable">
<p>Name of the set output symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_SKIP"></a><b>skip:</b> <code>set</code>, <code>par</code> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Indicate if sets or parameters should be skipped. Per default the agent takes both sets and parameters into account (if both are available via <a class="el" href="#UG_GAMSCONNECT_CONCATENATE_SYMBOLS">symbols</a>) and generates a set and parameter output symbol with the same domain. If <code>set</code> is specified, the sets will be skipped, i.e. sets are not taken into account for setting up the domain and no set output symbol will be generated. If <code>par</code> is specified, the parameters will be skipped. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. Allows to concatenate a subset of symbols. The default <code>all</code> concatenates all sets and parameters in the given database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_SYMBOLSDIMENSION"></a><b>symbolsDimension:</b> <em>boolean</em> (default: <code>True</code>) </p><blockquote class="doxtable">
<p>Specify if output symbols should have a <code>symbols</code> dimension that contains the input symbol names. If <code>True</code>, the Concatenate agent adds a <code>symbols</code> dimension at the first index position. If <code>False</code>, no <code>symbols</code> dimension will be added. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CONCATENATE_UNIVERSALDIMENSION"></a><b>universalDimension:</b> <em>string</em> (default: <code>uni</code>) </p><blockquote class="doxtable">
<p>Specify the base name of universal dimensions. </p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_CSVREADER"></a>
CSVReader</h2>
<p>The CSVReader allows reading a symbol (set or parameter) from a specified CSV file into the Connect database. Its implementation is based on the <code>pandas.DataFrame</code> class and its I/O API method <code>read_csv</code>. See <a class="el" href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_CSV">getting started example</a> for a simple example that uses the CSVReader.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_AUTOCOL">autoColumn</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Generate automatic column names.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_AUTOROW">autoRow</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Generate automatic row labels.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_DECIMALSEP">decimalSeparator</a>   </td><td class="markdownTableBodyLeft"><code>.</code> (period)   </td><td class="markdownTableBodyLeft">Specify a decimal separator.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_FIELDSEP">fieldSeparator</a>   </td><td class="markdownTableBodyLeft"><code>,</code> (comma)   </td><td class="markdownTableBodyLeft">Specify a field separator.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_FILE">file</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a CSV file path.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_HEADER">header</a>   </td><td class="markdownTableBodyLeft"><code>infer</code>   </td><td class="markdownTableBodyLeft">Specify the header(s) used as the column names.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_INDEXCOLS">indexColumns</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify columns to use as the row labels.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_INDEXSUB">indexSubstitutions</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for substitutions in the index columns.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_NAME">name</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a symbol name for the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_NAMES">names</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">List of column names to use.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_QUOTING">quoting</a>   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Control field quoting behavior.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_READCSVARGS">readCSVArguments</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary containing keyword arguments for the <code>pandas.read_csv</code> method.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_SKIPROWS">skipRows</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify the rows to skip or the number of rows to skip.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_STACK">stack</a>   </td><td class="markdownTableBodyLeft"><code>infer</code>   </td><td class="markdownTableBodyLeft">Stacks the column names to index.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_THOUSANDSSEP">thousandsSeparator</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a thousands separator.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_TYPE">type</a>   </td><td class="markdownTableBodyLeft"><code>par</code>   </td><td class="markdownTableBodyLeft">Control the symbol type.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_VALUECOLS">valueColumns</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify columns to get the values from.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVREADER_VALUESUB">valueSubstitutions</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for substitutions in the value columns.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_AUTOCOL"></a><b>autoColumn:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Generate automatic column names. The <code>autoColumn</code> string is used as the prefix for the column label numbers. This option overrides the use of a <code>header</code> or <code>names</code>. However, if there is a header row, one must skip the row by enabling <code>header</code> or using <code>skipRows</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_AUTOROW"></a><b>autoRow:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Generate automatic row labels. The <code>autoRow</code> string is used as the prefix for the row label numbers. The generated unique elements will be used in the first index position shifting other elements to the right. Using <code>autoRow</code> can be helpful when there are no labels that can be used as unique elements but also to store entries that would be a duplicate entry without a unique row label. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_DECIMALSEP"></a><b>decimalSeparator:</b> <em>string</em> (default: <code>.</code>) </p><blockquote class="doxtable">
<p>Specify a decimal separator, e.g. <code>.</code> (period) or <code>,</code> (comma). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_FIELDSEP"></a><b>fieldSeparator:</b> <em>string</em> (default: <code>,</code>) </p><blockquote class="doxtable">
<p>Specify a field separator, e.g. <code>,</code> (comma), <code>;</code> (semicolon), or <code>\t</code> (tab). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_FILE"></a><b>file:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a CSV file path. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_HEADER"></a><b>header:</b> <code>infer</code>, <em>boolean</em>, <em>list of integers</em> (default: <code>infer</code>) </p><blockquote class="doxtable">
<p>Specify the header(s) used as the column names. Default behavior is to infer the column names: if no <a class="el" href="#UG_GAMSCONNECT_CSVREADER_NAMES">names</a> are passed the behavior is identical to <code>header=True</code> and column names are inferred from the first line of data, if column names are passed explicitly then the behavior is identical to <code>header=False</code>. Explicitly pass <code>header=True</code> to be able to replace existing names. Note that missing column names are filled with <code>Unnamed: n</code> (where n is the nth column (zero based) in the <code>DataFrame</code>). Hence, reading the CSV file:</p>
<pre class="fragment">,j1,
i1,1,2
i2,3,4
,5,6
</pre><p>results in the following 2-dimensional parameter: </p><pre class="fragment">            j1  Unnamed: 2

i1       1.000       2.000
i2       3.000       4.000
</pre><p>For a multi-row header, a list of integers can be passed providing the positions of the header rows in the data. Note that reading multi-row header is only supported for parameters. Moreover, the CSVReader can only read all columns and not a subset of columns, wherefore only <code>indexColumns</code> can be specified and all other columns will automatically be read as <code>valueColumns</code>. Note that <code>indexColumns</code> can not be provided as column names together with a multi-row header. <code>autoRow</code> and <code>autoColumn</code> will be ignored in case of a multi-row header. Here is an example how to read data with a multi-row header:</p>
<pre><code class="language-gams">$onecho &gt; multirow_header.csv
j,,j1,j1,j1,j2,j2,j2
k,,k1,k2,k3,k1,k2,k3
h,i,,,,,,
h1,i1,1,2,,4,5,6
h1,i2,,,3,4,5,
$offEcho

$onEmbeddedCode Connect:
- CSVReader:
    file: multirow_header.csv
    name: p
    header: [1,2]
    indexColumns: [1,2]
- PythonCode:
    code: |
        print(connect.container["p"].records)
$offEmbeddedCode
</code></pre>
<p>The same can be achieved if the data has no index column names:</p>
<pre class="fragment">j,,j1,j1,j1,j2,j2,j2
k,,k1,k2,k3,k1,k2,k3
h1,i1,1,2,,4,5,6
h1,i2,,,3,4,5,
</pre><p>If the first line of data after the multi-row header has no data in the <code>valueColumns</code>, the CSVReader will interpret this line as index column names. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_INDEXCOLS"></a><b>indexColumns:</b> <em>integer</em>, <em>string</em>, <em>list of integers</em>, <em>list of strings</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify columns to use as the row labels. The columns can either be given as column positions or column names. Column positions can be represented as an integer, a list of integers or a string. For example: <code>indexColumns: 1</code>, <code>indexColumns: [1, 2, 3, 4, 6]</code> or <code>indexColumns: "1:4, 6"</code>. The symbolic constant <code>lastCol</code> can be used with the string representation: <code>"2:lastCol"</code>. If no <code>header</code> or <code>names</code> is provided, <code>lastCol</code> will be determined by the first line of data. Column names can be represented as a list of strings. For example: <code>indexColumns: ["i1","i2"]</code>. Note that <code>indexColumns</code> and <code>valueColumns</code> must either be given as positions or names not both. Further note that <code>indexColumns</code> as column names are not supported together with a multi-row header.</p>
<p>By default the <code>pandas.read_csv</code> method interprets the following indices as <code>NaN</code>: "", "#N/A", "#N/A N/A", "#NA", "-1.#IND", "-1.#QNAN", "-NaN", "-nan", "1.#IND", "1.#QNAN", "&lt;NA&gt;", "N/A", "NA", "NULL", "NaN", "n/a", "nan", "null". The default can be changed by specifying <code>pandas.read_csv</code> arguments <code>keep_default_na</code> and <code>na_value</code> via <a class="el" href="#UG_GAMSCONNECT_CSVREADER_READCSVARGS">readCSVArguments</a>. Rows with indices that are interpreted as <code>NaN</code> will be dropped automatically. The <a class="el" href="#UG_GAMSCONNECT_CSVREADER_INDEXSUB">indexSubstitutions</a> option allows to map <code>NaN</code> entries in the index columns. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_INDEXSUB"></a><b>indexSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for substitutions in the index columns. Each key in <code>indexSubstitutions</code> is replaced by its corresponding value. This option allows arbitrary replacements in the index columns of the <code>DataFrame</code> including stacked column names. Consider the following CSV file:</p>
<pre class="fragment">i1,j1,2.5
i1,,1.7
i2,j1,1.8
i2,,1.4
</pre><p>Reading this data into a 2-dimensional parameter results in a parameter with <code>NaN</code> entries dropped: </p><pre class="fragment">            j1

i1       2.500
i2       1.800
</pre><p>By specifying <code>indexSubstitutions: { .nan: j2 }</code> we can substitute <code>NaN</code> entries by <code>j2</code>: </p><pre class="fragment">            j1          j2

i1       2.500       1.700
i2       1.800       1.400
</pre> </blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a symbol name for the Connect database. Note that each symbol in the Connect database must have a unique name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_NAMES"></a><b>names:</b> <em>list of strings</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>List of column names to use. If the file contains a header row, then you should explicitly pass <code>header=True</code> to override the column names. Duplicates in this list are not allowed. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_QUOTING"></a><b>quoting:</b> <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Control field quoting behavior. Use QUOTE_MINIMAL (<code>0</code>), QUOTE_ALL (<code>1</code>), QUOTE_NONNUMERIC (<code>2</code>) or QUOTE_NONE (<code>3</code>). QUOTE_NONNUMERIC (<code>2</code>) instructs the reader to convert all non-quoted fields to type float. QUOTE_NONE (<code>3</code>) instructs reader to perform no special processing of quote characters. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_READCSVARGS"></a><b>readCSVArguments:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary containing keyword arguments for the <a target="_blank" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">pandas.read_csv</a> method. Not all arguments of that method are exposed through the YAML interface of the CSVReader agent. By specifying <code>readCSVArguments</code>, it is possible to pass arguments directly to the <code>pandas.read_csv</code> method that is used by the CSVReader agent. For example, <code>readCSVArguments: {keep_default_na: False, skip_blank_lines: False}</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_SKIPROWS"></a><b>skipRows:</b> <em>integer</em>, <em>list of integers</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify the rows to skip (list) or the number of rows to skip (integer). For example: <code>skipRows: [1, 3]</code> or <code>skipRows: 5</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_STACK"></a><b>stack:</b> <code>infer</code>, <em>boolean</em> (default: <code>infer</code>) </p><blockquote class="doxtable">
<p>If <code>True</code>, stacks the column names to index. With the default <code>infer</code>, <code>stack</code> will be set to <code>True</code> if there is more than one value column, otherwise <code>False</code>. Note that missing column names are filled with <code>Unnamed: n</code> (where n is the nth column (zero based) in the <code>DataFrame</code>). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_THOUSANDSSEP"></a><b>thousandsSeparator:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a thousands separator. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_TYPE"></a><b>type:</b> <code>par</code>, <code>set</code> (default: <code>par</code>) </p><blockquote class="doxtable">
<p>Control the symbol type. Supported symbol types are <code>par</code> for parameters and <code>set</code> for sets. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_VALUECOLS"></a><b>valueColumns:</b> <em>integer</em>, <em>string</em>, <em>list of integers</em>, <em>list or strings</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify columns to get the values from. The value columns contain numerical values in case of a GAMS parameter and set element text in case of a GAMS set. Note that specifying <code>valueColumns</code> is required for parameters (except for parameter data with a multi-row header). The columns can be given as column positions or column names. Column positions can be represented as an integer, a list of integers or a string. For example: <code>valueColumns: 1</code>, <code>valueColumns: [1, 2, 3, 4, 6]</code> or <code>valueColumns: "1:4, 6"</code>. The symbolic constant <code>lastCol</code> can be used with the string representation: <code>"2:lastCol"</code>. If no <code>header</code> or <code>names</code> is provided, <code>lastCol</code> will be determined by the first line of data. Column names can be represented as a list of strings. For example: <code>valueColumns: ["i1","i2"]</code>. Note that <code>valueColumns</code> and <code>indexColumns</code> must either be given as positions or names not both.</p>
<p>By default the <code>pandas.read_csv</code> method interprets the following values as <code>NaN</code>: "", "#N/A", "#N/A N/A", "#NA", "-1.#IND", "-1.#QNAN", "-NaN", "-nan", "1.#IND", "1.#QNAN", "&lt;NA&gt;", "N/A", "NA", "NULL", "NaN", "n/a", "nan", "null". The default can be changed by specifying <code>pandas.read_csv</code> arguments <code>keep_default_na</code> and <code>na_value</code> via <a class="el" href="#UG_GAMSCONNECT_CSVREADER_READCSVARGS">readCSVArguments</a>. Rows with values that are interpreted as <code>NaN</code> will be dropped automatically. Changing the default of values that are interpreted as <code>NaN</code> is useful if, e.g. "NA" values should not be dropped but interpreted as GAMS special value <code>NA</code>. Moreover, the <a class="el" href="#UG_GAMSCONNECT_CSVREADER_VALUESUB">valueSubstitutions</a> option allows to map <code>NaN</code> entries in the value columns. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVREADER_VALUESUB"></a><b>valueSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for substitutions in the value column. Each key in <code>valueSubstitutions</code> is replaced by its corresponding value. The replacement is only performed on the values which is the numerical value in case of a GAMS parameter and the set element text in case of a GAMS set. While it is possible to make arbitrary replacements this is especially useful for controlling sparse/dense reading. All <code>NaN</code> entries are removed automatically by default which results in a sparse reading behavior. Consider the following CSV file:</p>
<pre class="fragment">i1,j1,
i1,j2,1.7
i2,j1,
i2,j2,1.4
</pre><p>Reading this data into a 2-dimensional parameter results in a sparse parameter with all <code>NaN</code> entries removed: </p><pre class="fragment">            j2

i1       1.700
i2       1.400
</pre><p>By specifying <code>valueSubstitutions: { .nan: EPS }</code> we get a dense representation where all <code>NaN</code> entries are replaced by GAMS special value <code>EPS</code>: </p><pre class="fragment">            j1          j2

i1         EPS       1.700
i2         EPS       1.400
</pre><p>Beside <code>EPS</code> there are the following other GAMS special values that can be used by specifying their string representation: <code>INF</code>, <code>-INF</code>, <code>EPS</code>, <code>NA</code>, and <code>UNDEF</code>. See the <a class="el" href="API_PY_GAMSTRANSFER_ADDITIONAL_TOPICS.html#PY_GAMSTRANSFER_SPECVALS">GAMS Transfer documentation</a> for more information.</p>
<p>Let's assume we have data representing a GAMS set: </p><pre class="fragment">i1,text1
i2,
i3,text3
</pre><p>Reading this data into a 1-dimensional set results in a sparse set in which all <code>NaN</code> entries (those that do not have any set element text) are removed: </p><pre class="fragment">'i1' 'text 1',
'i3' 'text 3'
</pre><p>By specifying <code>valueSubstitutions: { .nan: '' }</code> we get a dense representation: </p><pre class="fragment">'i1' 'text 1',
'i2',
'i3' 'text 3'
</pre><p>It is also possible to use <code>valueSubstitutions</code> in order to interpret the set element text. Let's assume we have the following CSV file: </p><pre class="fragment">,j1,j2,j3
i1,Y,Y,Y
i2,Y,Y,N
i3,0,Y,Y
</pre><p>Reading this data into a 2-dimensional set results in a dense set: </p><pre class="fragment">'i1'.'j1' Y,
'i1'.'j2' Y,
'i1'.'j3' Y,
'i2'.'j1' Y,
'i2'.'j2' Y,
'i2'.'j3' N,
'i3'.'j1' 0,
'i3'.'j2' Y,
'i3'.'j3' Y
</pre><p>By specifying <code>valueSubstitutions: { 'N': .nan, '0': .nan }</code> we replace all occurrences of <code>N</code> and <code>0</code> by <code>NaN</code> which gets dropped automatically: </p><pre class="fragment">'i1'.'j1' Y,
'i1'.'j2' Y,
'i1'.'j3' Y,
'i2'.'j1' Y,
'i2'.'j2' Y,
'i3'.'j2' Y,
'i3'.'j3' Y
</pre> </blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER"></a>
CSVWriter</h2>
<p>The CSVWriter allows writing a symbol (set or parameter) in the Connect database to a specified CSV file. Variables and equations need to be turned into parameters with the <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent before they can be written. See <a class="el" href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_CSV">getting started example</a> for a simple example that uses the CSVWriter.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_DECIMALSEP">decimalSeparator</a>   </td><td class="markdownTableBodyLeft"><code>.</code> (period)   </td><td class="markdownTableBodyLeft">Specify a decimal separator.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_FILE">file</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a CSV file path.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_FIELDSEP">fieldSeparator</a>   </td><td class="markdownTableBodyLeft"><code>,</code> (comma)   </td><td class="markdownTableBodyLeft">Specify a field separator.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_HEADER">header</a>   </td><td class="markdownTableBodyLeft"><code>True</code>   </td><td class="markdownTableBodyLeft">Indicate if the header will be written.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_NAME">name</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_QUOTING">quoting</a>   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Control field quoting behavior.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_SETHEADER">setHeader</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a string that will be used as the header.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_SKIPTEXT">skipText</a>   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Indicate if the set element text will be skipped.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_TOCSVARGS">toCSVArguments</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary containing keyword arguments for the <code>pandas.to_csv</code> method.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_UNSTACK">unstack</a>   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Specify the dimensions to be unstacked to the header row(s).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_CSVWRITER_VALUESUB">valueSubstitutions</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for mapping in the value column of the <code>DataFrame</code>.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_DECIMALSEP"></a><b>decimalSeparator:</b> <em>string</em> (default: <code>.</code>) </p><blockquote class="doxtable">
<p>Specify a decimal separator, e.g. <code>.</code> (period) or <code>,</code> (comma). </p><dl class="section note"><dt>Note</dt><dd>Changing the decimal separator (e.g. to <code>,</code>) will have no effect if the value column contains non-numerical values. This can be the case if either numerical values are replaced with strings using <a class="el" href="#UG_GAMSCONNECT_CSVWRITER_VALUESUB">valueSubstitutions</a> or in case of special values which get translated into strings by default. </dd></dl>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_FILE"></a><b>file:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a CSV file path. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_FIELDSEP"></a><b>fieldSeparator:</b> <em>string</em> (default: <code>,</code>) </p><blockquote class="doxtable">
<p>Specify a field separator, e.g. <code>,</code> (comma), <code>;</code> (semicolon), or <code>\t</code> (tab). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_HEADER"></a><b>header:</b> <em>boolean</em> (default: <code>True</code>) </p><blockquote class="doxtable">
<p>Indicate if the header will be written. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol in the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_QUOTING"></a><b>quoting:</b> <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Control field quoting behavior. Use QUOTE_MINIMAL (<code>0</code>), QUOTE_ALL (<code>1</code>), QUOTE_NONNUMERIC (<code>2</code>) or QUOTE_NONE (<code>3</code>). QUOTE_MINIMAL (<code>0</code>) instructs the writer to only quote those fields which contain special characters such as <code>fieldSeparator</code>. QUOTE_ALL (<code>1</code>) instructs the writer to quote all fields. QUOTE_NONNUMERIC (<code>2</code>) instructs the writer to quote all non-numeric fields. QUOTE_NONE (<code>3</code>) instructs the writer to never quote fields. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_SETHEADER"></a><b>setHeader:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a string that will be used as the header. If an empty header is desired, the string can be empty. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_SKIPTEXT"></a><b>skipText:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Indicate if the set element text will be skipped. If <code>False</code>, the set element text will be written in the last column of the CSV file. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_TOCSVARGS"></a><b>toCSVArguments:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary containing keyword arguments for the <a target="_blank" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html">pandas.to_csv</a> method. Not all arguments of that method are exposed through the YAML interface of the CSVWriter agent. By specifying <code>toCSVArguments</code>, it is possible to pass arguments directly to the <code>pandas.to_csv</code> method that is used by the CSVWriter agent. For example, <code>toCSVArguments: {index_label: ["index1", "index2", "index3"]}</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_UNSTACK"></a><b>unstack:</b> <em>boolean</em>, <em>list of integers</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Specify the dimensions to be unstacked to the header row(s). If <code>False</code> (default) no dimension will be unstacked to the header row. If <code>True</code> the last dimension will be unstacked to the header row. If multiple dimensions should be unstacked to header rows, a list of integers providing the dimension numbers to unstack can be specified. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_CSVWRITER_VALUESUB"></a><b>valueSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for mapping in the value column of the <code>DataFrame</code>. Each key in <code>valueSubstitutions</code> is replaced by its corresponding value. The replacement is only performed on the value column of the <code>DataFrame</code> which is the numerical value in case of a GAMS parameter and the set element text in case of a GAMS set. Note that for parameters the CSVWriter automatically converts numerical GAMS special values to their string representation, i.e. <code>INF</code>, <code>-INF</code>, <code>EPS</code>, <code>NA</code>, and <code>UNDEF</code>. If the GAMS special values should be replaced by custom values, use the string representation (upper case) in the dictionary. For example, specify <code>{'EPS': 0}</code> to replace GAMS special value <code>EPS</code> by zero. See the <a class="el" href="API_PY_GAMSTRANSFER_ADDITIONAL_TOPICS.html#PY_GAMSTRANSFER_SPECVALS">GAMS Transfer documentation</a> for more information on GAMS special values. </p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_DOMAINWRITER"></a>
DomainWriter</h2>
<p>The DomainWriter agent allows to rewrite domain information for existing Connect symbols and helps dealing with domain violations.</p>
<p>Here is an example that uses the DomainWriter agent:</p>
<pre><code class="language-gams">Set i / i1*i2 /, ii(i) / i1 /;

Parameter a(i) / i1 1, i2 2 /, b(i) / i1 1, i2 2 /;

$onEmbeddedCode Connect:
- GAMSReader:
    symbols: all
- DomainWriter:
    symbols:
      - name: a(ii)
        dropDomainViolations: after
      - name: b('ii')
- PythonCode:
    code: |
        print("Parameter a:\n", connect.container["a"].records)
        print("Parameter b:\n",connect.container["b"].records)
- GDXWriter:
    file: a_mod.gdx
    symbols: all
$offEmbeddedCode
</code></pre>
<p>In this example, the DomainWriter is used to modify the one-dimensional parameters <code>a</code> and <code>b</code>. For parameter <code>a</code>, a regular domain with domain set <code>ii</code> (a subset of set <code>i</code>) is established. Since parameter <code>a</code> still has the <code>(i2 2.0)</code> record, the parameter now contains a domain violation as <code>i2</code> is not part of the new regular domain <code>ii</code>. While the Connect database in general can hold symbols with domain violations, this is not the case for GAMS or GDX. Since the symbols are later written to GDX, <code>dropDomainViolations: after</code> is specified instructing the DomainWriter to drop all domain violations after the new domain is applied. For parameter <code>b</code>, a relaxed domain <code>'ii'</code> is established. This means that the universal domain <code>*</code> is established while using <code>ii</code> as the relaxed domain name. As the new domain is relaxed, no domain violations are introduced.</p>
<p>After the DomainWriter parameter <code>a</code> and <code>b</code> look as follows:</p>
<pre class="fragment">Set a:
    ii  value
0  i1    1.0

Set b:
    ii  value
0  i1    1.0
1  i2    2.0
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_DOMAINWRITER_DROPDOMAINVIOLATIONS">dropDomainViolations</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Indicate how to deal with domain violations.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_DOMAINWRITER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_DOMAINWRITER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_DOMAINWRITER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_DOMAINWRITER_DROPDOMAINVIOLATIONS"></a><b>dropDomainViolations:</b> <code>after</code>, <code>before</code>, <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>The Connect symbols might have some domain violations. This agent allows to drop these domain violations, so a write to GAMS or GDX works properly. Indicate how to deal with domain violations that can cause issues in GAMS or GDX. Per default domain violations will not be dropped. Setting <code>dropDomainViolations</code> to <code>after</code> will drop domain violations <em>after</em> a new domain is applied. Setting the option to <code>before</code> will drop domain violations <em>before</em> a new domain is applied. Setting the option to <code>True</code> will drop domain violations before and after a new domain is applied. The DomainWriter agent does not necessarily need to be used to rewrite domain information for specific symbols but can also handle domain violations for all symbols in the Connect database. With <code>symbols: all</code> and <code>dropDomainViolations: True</code> the agent drops domain violations from all symbols in the Connect database. In this case, <code>after</code> and <code>before</code> will have the same effect as <code>True</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_DOMAINWRITER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a symbol name with index space for the Connect database. <code>name</code> requires the format <code>symName(i1,i2,...,iN)</code>. The list of indices needs to coincide with the names of the actual GAMS domain sets for a <em>regular</em> domain. A <em>relaxed</em> domain is set if the index is quoted. For example <code>name: x(i,'j')</code> means that for the first index a regular domain with domain set <code>i</code> is established, while for the second index the universal domain <code>*</code> is used and a <em>relaxed domain name</em> <code>j</code> is set. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_DOMAINWRITER_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options or <code>all</code> for applying the DomainWriter to all symbols in the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_DOMAINWRITER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER"></a>
ExcelReader</h2>
<p>The ExcelReader agent allows to read symbols (sets and parameters) from an Excel file into the Connect database. See <a class="el" href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_EXCEL">getting started example</a> for a simple example that uses the ExcelReader.</p>
<dl class="section note"><dt>Note</dt><dd>The ExcelReader supports <code>.xlsx</code> and <code>.xlsm</code> files.</dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_AUTOMERGE">autoMerge</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Indicate if empty cells in the labels should be merged with previous cells.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_CDIM">columnDimension</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>1</code>   </td><td class="markdownTableBodyLeft">Column dimension of the symbol.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_FILE">file</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify an Excel file path.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_IGNORECOLUMNS">ignoreColumns</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Columns to be ignored when reading.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_IGNOREROWS">ignoreRows</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Rows to be ignored when reading.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_IGNORETEXT">ignoreText</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>infer</code>   </td><td class="markdownTableBodyLeft">Indicate if the set element text should be ignored.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_INDEX">index</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the Excel range for reading symbols and options directly from the spreadsheet.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_INDEXSUB">indexSubstitutions</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for substitutions in the row and column index.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_MERGEDCELLS">mergedCells</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Control the handling of empty cells in the labels and the values that are part of a merged Excel range.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_RNG">range</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>[name]!A1</code>   </td><td class="markdownTableBodyLeft">Specify the Excel range of a symbol.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_RDIM">rowDimension</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>1</code>   </td><td class="markdownTableBodyLeft">Row dimension of the symbol.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_SKIPEMPTY">skipEmpty</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>1</code>   </td><td class="markdownTableBodyLeft">Number of empty rows or columns to skip before the next empty row or column indicates the end of the block for reading with open ranges.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_TYPE">type</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>par</code>   </td><td class="markdownTableBodyLeft">Control the symbol type.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELREADER_VALUESUB">valueSubstitutions</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for mapping in the values.   </td></tr>
</table>
<p>Detailed description of the options: <a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_AUTOMERGE"></a> <b>autoMerge:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Indicate if empty cells in the labels should be merged with previous cells. If <code>True</code>, each empty cell in the labels will be filled with the value of a previous cell that is not empty. This will resolve merged cells in the labels and will also fill empty cells in the labels that are not part of a merged cell. If the user wants to keep empty cells in the labels that are not part of a merged cell and still resolve merged cells, <code>autoMerge</code> needs to be set to <code>False</code> and <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_MERGEDCELLS">mergedCells</a> needs to be set to <code>True</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_CDIM"></a><b>columnDimension:</b> <em>integer</em> (default: <code>1</code>) </p><blockquote class="doxtable">
<p>The number of rows in the data range that will be used to define the labels for columns. The first <code>columnDimension</code> rows of the data range will be used for labels. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_FILE"></a><b>file:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify an Excel file path. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_IGNORECOLUMNS"></a><b>ignoreColumns:</b> <em>integer</em>, <em>string</em>, <em>list of integers and strings</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Columns to be ignored when reading the file. They can be specified by any of the following methods:</p>
<ul>
<li><b>Single column</b>: Use a single column number (e.g. <code>ignoreColumns: 3</code>) or letter (e.g. <code>ignoreColumns: C</code>).</li>
<li><b>Ranges</b>: Specify ranges in the format <code>start:end</code>. Ranges can include:<ul>
<li>Integers (e.g. <code>ignoreColumns: "2:6"</code>)</li>
<li>Letters (e.g. <code>ignoreColumns: "B:F"</code>)</li>
<li>A mixture of both (e.g. <code>ignoreColumns: "B:6"</code>)</li>
</ul>
</li>
<li><b>A list of columns</b>: Include multiple column numbers, letters, and/or ranges (e.g. <code>ignoreColumns: [2, "D", "7:10"]</code>). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_IGNOREROWS"></a><b>ignoreRows:</b> <em>integer</em>, <em>string</em>, <em>list of integers and strings&gt;</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify rows to be ignored when reading. You can specify:</p>
<ul>
<li><b>Single row</b>: Use a single row number (e.g. <code>ignoreRows: 4</code>).</li>
<li><b>Ranges</b>: Specify ranges in the format <code>start:end</code>. Ranges should only include integers (e.g. <code>ignoreRows: "2:6"</code>).</li>
<li><b>A list of rows</b>: Include multiple row numbers and/or ranges (e.g. <code>ignoreRows: [2, 5, "7:10"]</code>.) </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_IGNORETEXT"></a><b>ignoreText:</b> <code>infer</code>, <em>boolean</em> (default: <code>infer</code>) </p><blockquote class="doxtable">
<p>Indicate if the set element text should be ignored. With the default <code>infer</code> the set element text will be ignored based on the specification of <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_RNG">range</a> and <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_CDIM">columnDimension</a>/<a class="el" href="#UG_GAMSCONNECT_EXCELREADER_RDIM">rowDimension</a>. If either <code>columnDimension</code> or <code>rowDimension</code> is set to <code>0</code> and an open range is specified, the set element text will be ignored. If either <code>columnDimension</code> or <code>rowDimension</code> is set to <code>0</code> and a full range is specified, the set element text will be ignored if it is not included in the range specification. In all other cases the set element text will not be ignored. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_INDEX"></a><b>index:</b> <em>string</em> (required: <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_INDEX">index</a> or <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_SYMBOLS">symbols</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_SYMBOLS">symbols</a>) </p><blockquote class="doxtable">
<p>Specify the Excel range for reading symbols options directly from the spreadsheet similar to <a class="el" href="T_GDXXRW.html">GDXXRW</a>s <a class="el" href="T_GDXXRW.html#GDXXRW_OPTIONS_INDEX">index</a> option. The general structure of an index sheet follows roughly the rules of <code>GDXXRW</code>, but there are also options that are either not supported at all or work differently.</p><ul>
<li>Supported options:<ul>
<li><code>rdim/rowDimension</code></li>
<li><code>cdim/columnDimension</code></li>
<li><code>se/skipEmpty</code></li>
<li><code>ignoreText</code></li>
<li><code>autoMerge</code></li>
<li><code>ignoreRows</code></li>
<li><code>ignoreColumns</code></li>
<li><code>mergedCells</code></li>
</ul>
</li>
<li>All supported options are processed case insensitive.</li>
<li>All unsupported options are ignored.</li>
<li>Since there is no support for <code>dSet</code>, the ExcelReader will process such symbols as <code>set</code>. The <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_DUPLICATERECORDS">duplicateRecords</a> option of the <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a> or <a class="el" href="#UG_GAMSCONNECT_GDXWRITER">GDXWriter</a> can be used to get rid of potential duplicate records. Alternatively the <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent with an appropriate <a class="el" href="#UG_GAMSCONNECT_PROJECTION_AGGMETHOD">aggregationMethod</a> can be used.</li>
<li>No support for <code>dim</code> but <code>rDim/rowDimension</code> and <code>cDim/columnDimension</code> only.</li>
<li>Missing values for <code>rDim/rowDimension</code> and <code>cDim/columnDimension</code> will not have the <code>GDXXRW</code> defaults but will use the root-scoped values of <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_RDIM">rowDimension</a> and <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_CDIM">columnDimension</a>. When migrating from <code>GDXXRW</code> to Connect it is best to explicitly specify those values in the index sheet instead of relying on default value.</li>
<li>Per default <code>GDXXRW</code> does not store zeros, but the ExcelReader does. In order to change this, one has to specify <code>valueSubstitutions: {0: .nan}</code> in the root scope which will drop all records with value <code>0</code>.</li>
</ul>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_SYMBOLS">symbols</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_INDEXSUB"></a><b>indexSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for substitutions in the row and column index. Each key in <code>indexSubstitutions</code> is replaced by its corresponding value. This option allows arbitrary replacements in the index. Consider the following Excel spreadsheet:</p>
<div class="image">
<img src="connect_xlsr1.png" alt=""/>
<div class="caption">
Two dimensional data containing NaN entries in the index</div></div>
<p>Reading this data into a 2-dimensional parameter results in a parameter with <code>NaN</code> entries dropped: </p><pre class="fragment">            j1

i1       1.000
i2       3.000
</pre><p>By specifying <code>indexSubstitutions: { .nan: j2 }</code> we can substitute <code>NaN</code> entries by <code>j2</code>: </p><pre class="fragment">            j1          j2

i1       1.000       2.000
i2       3.000       4.000
</pre> </blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_MERGEDCELLS"></a><b>mergedCells:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Control the handling of empty cells that are part of a merged Excel range. The option applies to merged cells in the labels and the values, i.e. the numerical values in case of a GAMS parameter and the set element text in case of a GAMS set. If <code>False</code>, the cells are left empty. If <code>True</code>, the merged label/value is used in all cells. Note that setting this option to <code>True</code> has an impact on performance since the Excel file has to be opened in a non-read-only mode that results in non-constant memory consumption (no lazy loading). From the performance perspective, <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_AUTOMERGE">autoMerge</a> should be preferred over <code>mergedCells</code> if applicable. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a symbol name for the Connect database. Note that each symbol in the Connect database must have a unique name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_RNG"></a><b>range:</b> <em>string</em> (default: <code>[name]!A1</code>) </p><blockquote class="doxtable">
<p>Specify the Excel range of a symbol using the format <code>sheetName!cellRange</code>. <code>cellRange</code> can be either a single cell also known as an <em>open range</em> (north-west corner like <code>B2</code>) or a <em>full range</em> (north-west and south-east corner like <code>B2:D4</code>). Per default the ExcelReader uses the range <code>[name]!A1</code>, where <code>[name]</code> is the <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_NAME">name</a> of the symbol that is read. If only <code>sheetName!</code> is specified, the ExcelReader will use an open range starting at cell <code>A1</code>. The ExcelReader also allows for named ranges - a named range includes a sheet name and a cell range. Before interpreting the provided <code>range</code> attribute, the string will be used to search for a pre-defined Excel range with that name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_RDIM"></a><b>rowDimension:</b> <em>integer</em> (default: <code>1</code>) </p><blockquote class="doxtable">
<p>The number of columns in the data range that will be used to define the labels for the rows. The first <code>rowDimension</code> columns of the data range will be used for the labels. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_SKIPEMPTY"></a><b>skipEmpty:</b> <em>integer</em> (default: <code>1</code>) </p><blockquote class="doxtable">
<p>Number of empty rows or columns to skip before the next empty row or column indicates the end of the block for reading with open ranges. If a full range is specified <code>skipEmpty</code> will be ignored. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_SYMBOLS"></a><b>symbols:</b> <em>list of symbols</em> (required: <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_INDEX">index</a> or <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_SYMBOLS">symbols</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_INDEX">index</a>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options.</p>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_INDEX">index</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_TYPE"></a><b>type:</b> <code>par</code>, <code>set</code> (default: <code>par</code>) </p><blockquote class="doxtable">
<p>Control the symbol type. Supported symbol types are <code>par</code> for parameters and <code>set</code> for sets. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELREADER_VALUESUB"></a><b>valueSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for substitutions in the value column. Each key in <code>valueSubstitutions</code> is replaced by its corresponding value. The replacement is only performed on the values which is the numerical value in case of a GAMS parameter and the set element text in case of a GAMS set. While it is possible to make arbitrary replacements, this is especially useful for controlling sparse/dense reading. All <code>NaN</code> entries are removed automatically by default which results in a sparse reading behavior. Let's assume we have the following spreadsheet:</p>
<div class="image">
<img src="connect_pdxlsr1.png" alt=""/>
<div class="caption">
Two dimensional data containing NaN entries</div></div>
<p>Reading this data into a 2-dimensional parameter results in a sparse parameter in which all <code>NaN</code> entries are removed: </p><pre class="fragment">'i1'.'j1' 2.5,
'i1'.'j2' 1.7,
'i2'.'j2' 1.8,
'i2'.'j3' 1.4
</pre><p>By specifying <code>valueSubstitutions: { .nan: EPS }</code> we get a dense representation in which all <code>NaN</code> entries are replaced by GAMS special value <code>EPS</code>: </p><pre class="fragment">'i1'.'j1' 2.5,
'i1'.'j2' 1.7,
'i1'.'j3' Eps,
'i2'.'j1' Eps,
'i2'.'j2' 1.8,
'i2'.'j3' 1.4
</pre><p>Beside <code>EPS</code> there are the following other GAMS special values that can be used by specifying their string representation: <code>INF</code>, <code>-INF</code>, <code>EPS</code>, <code>NA</code>, and <code>UNDEF</code>. See the <a class="el" href="API_PY_GAMSTRANSFER_ADDITIONAL_TOPICS.html#PY_GAMSTRANSFER_SPECVALS">GAMS Transfer documentation</a> for more information.</p>
<p>Let's assume we have data representing a GAMS set:</p>
<div class="image">
<img src="connect_pdxlsr2.png" alt=""/>
<div class="caption">
Data representing a GAMS set</div></div>
<p>Reading this data into a 1-dimensional set results in a sparse set in which all <code>NaN</code> entries (those that do not have any set element text) are removed: </p><pre class="fragment">'i1' 'text 1',
'i3' 'text 3'
</pre><p>By specifying <code>valueSubstitutions: { .nan: '' }</code> we get a dense representation: </p><pre class="fragment">'i1' 'text 1'
'i2' ''
'i3' 'text 3'
</pre><p>It is also possible to use <code>valueSubstitutions</code> in order to interpret the set element text. Let's assume we have the following Excel data:</p>
<div class="image">
<img src="connect_pdxlsr3.png" alt=""/>
<div class="caption">
Data representing a GAMS set</div></div>
<p>Reading this data into a 2-dimensional set results in a dense set: </p><pre class="fragment">'i1'.'j1' No,
'i1'.'j2' Y,
'i1'.'j3' Y,
'i2'.'j1' Y,
'i2'.'j2' Y,
'i2'.'j3' Y,
'i3'.'j1' Y,
'i3'.'j2' Y,
'i3'.'j3' N
</pre><p>By specifying <code>valueSubstitutions: { 'N': .nan, 'No': .nan }</code> we replace all occurrences of <code>N</code> and <code>No</code> by <code>NaN</code> which gets dropped automatically. Note that <code>No</code> has to be quotes in order to not be interpreted as <code>False</code> by the YAML parser: </p><pre class="fragment">'i1'.'j2' Y,
'i1'.'j3' Y,
'i2'.'j1' Y,
'i2'.'j2' Y,
'i2'.'j3' Y,
'i3'.'j1' Y,
'i3'.'j2' Y
</pre> </blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER"></a>
ExcelWriter</h2>
<p>The ExcelWriter agent allows to write symbols (sets and parameters) from the Connect database to an Excel file. Variables and equations need to be turned into parameters with the <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent before they can be written. If the Excel file exists, the ExcelWriter appends to the existing file. See <a class="el" href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_EXCEL">getting started example</a> for a simple example that uses the ExcelWriter.</p>
<dl class="section note"><dt>Note</dt><dd>The ExcelWriter only supports <code>.xlsx</code> files.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Please be aware of the following limitation when appending to an Excel file with formulas using the ExcelWriter: Whereas Excel stores formulas and the corresponding values, the ExcelReader and the ExcelWriter read/store either formulas or values, not both. As a consequence, when appending to an Excel file with formulas, all cells with formulas within the Excel file will not have values anymore and a subsequent read by the ExcelReader results into <code>NaN</code> for these cells. To avoid this, write to a separate output Excel file. On Windows one can merge the input Excel file with the output Excel file at the end using the tool <a class="el" href="T_WIN32_EXCELMERGE.html">win32.ExcelMerge</a> (see <a class="el" href="#UG_GAMSCONNECT_EXAMPLES_CONNECT06">Connect Example for Excel (executeTool win32.ExcelMerge)</a>). An alternative approach when appending to an Excel file with formulas is to open and save the Excel file before reading it to let Excel evaluate formulas and restore the corresponding values.</dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_CLEAR">clearSheet</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Indicate if a sheet should be cleared before writing if it exists.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_CDIM">columnDimension</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>infer</code>   </td><td class="markdownTableBodyLeft">Column dimension of the symbol.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_EMPTYSYMBOLS">emptySymbols</a>   </td><td class="markdownTableBodyLeft">tableOfContents   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Controls if empty symbols should be listed in the table of contents.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_FILE">file</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify an Excel file path.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_INDEX">index</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify the Excel range for reading symbols and options directly from the spreadsheet.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_MERGEDCELLS">mergedCells</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Write merged cells.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_RNG">range</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>[name]!A1</code>   </td><td class="markdownTableBodyLeft">Specify the Excel range of a symbol.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_SHEETNAME">sheetName</a>   </td><td class="markdownTableBodyLeft">tableOfContents   </td><td class="markdownTableBodyLeft"><code>Table Of Contents</code>   </td><td class="markdownTableBodyLeft">Specify the sheet name containing the table of contents.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_SORT">sort</a>   </td><td class="markdownTableBodyLeft">tableOfContents   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Controls if symbol names in the table of contents are sorted alphabetically.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_TOC">tableOfContents</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Controls the writing of a table of contents.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_VALUESUB">valueSubstitutions</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for mapping in the value column of the <code>DataFrame</code>.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_CLEAR"></a><b>clearSheet:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Indicate if a sheet should be cleared before writing if it exists. The default is <code>False</code> where a sheet will not be cleared if it exists, instead the ExcelWriter overwrites, i.e. writes content to the sheet without removing the existing content. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_CDIM"></a><b>columnDimension:</b> <code>infer</code>, <em>integer</em> (default: <code>infer</code>) </p><blockquote class="doxtable">
<p>The last <code>columnDimension</code> index positions of the symbol that will be written to the rows that define the labels of the columns. The first <code>dim-columnDimension</code> index positions will be written to the columns that define the labels for the rows. With the default <code>infer</code>, <code>columnDimension</code> will be set to <code>1</code> if <code>dim&gt;0</code> and otherwise to <code>0</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_EMPTYSYMBOLS"></a><b>emptySymbols:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>If <code>True</code> empty symbols will be contained in the table of contents. Since empty symbols will not be written to the Excel file, those entries will not contain a link. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_FILE"></a><b>file:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify an Excel file path. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_INDEX"></a><b>index:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify the Excel range for reading symbols options directly from the spreadsheet similar to <a class="el" href="T_GDXXRW.html">GDXXRW</a>s <a class="el" href="T_GDXXRW.html#GDXXRW_OPTIONS_INDEX">index</a> option. If specified, <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_SYMBOLS">symbols</a> is ignored. The general structure of an index sheet follows roughly the rules of <code>GDXXRW</code>, but there are also options that are either not supported at all or work differently.</p><ul>
<li>Supported options:<ul>
<li><code>cdim/columnDimension</code></li>
<li><code>mergedCells</code></li>
<li><code>clearSheet</code></li>
</ul>
</li>
<li>All supported options are processed case insensitive.</li>
<li>All unsupported options are ignored.</li>
<li>No support for <code>dim</code> but and <code>rDim/rowDimension</code> but <code>cDim/columnDimension</code> only.</li>
<li>Missing value for <code>cDim/columnDimension</code> will use the root-scoped value of <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_CDIM">columnDimension</a>. When migrating from <code>GDXXRW</code> to Connect it is best to explicitly specify this value in the index sheet instead of relying on the default value. </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_MERGEDCELLS"></a><b>mergedCells:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Write merged cells. Please be aware that overwriting already existing merged cells in a sheet may cause problems, in that case consider setting <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_CLEAR">clearSheet</a> to <code>True</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a symbol name for the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_RNG"></a><b>range:</b> <em>string</em> (default: <code>[name]!A1</code>) </p><blockquote class="doxtable">
<p>Specify the Excel range of a symbol using the format <code>sheetName!cellRange</code>. <code>cellRange</code> can be either a single cell (north-west corner like <code>B2</code>) or a full range (north-west and south-east corner like <code>B2:D4</code>). Per default the ExcelWriter uses the range <code>[name]!A1</code>, where <code>[name]</code> is the <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_NAME">name</a> of the symbol that is written. If only <code>sheetName!</code> is specified, the ExcelWriter will use an open range starting at cell <code>A1</code>. The ExcelWriter also allows for named ranges - a named range includes a sheet name and a cell range. Before interpreting the provided <code>range</code> attribute, the string will be used to search for a pre-defined Excel range with that name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_SHEETNAME"></a><b>sheetName:</b> <em>string</em> (default: <code>Table Of Contents</code>) </p><blockquote class="doxtable">
<p>Specify the sheet name which will contain the table of contents. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_SORT"></a><b>sort:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>If <code>True</code> the table of contents is sorted by symbol name in alphabetical order. If <code>False</code> the order is determined from the order given in <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_SYMBOLS">symbols</a> or the order of symbols in the Connect database in case <code>symbols: all</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. The default <code>all</code> writes each parameter and set into a separate sheet using the range <code>[name]!A1</code>. If specified, <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_INDEX">index</a> takes precedence over <code>symbols</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_TOC"></a><b>tableOfContents:</b> <em>boolean</em>, <em>dictionary</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>If <code>True</code> writes a table of contents into sheet <code>Table Of Contents</code>. If a dictionary is provided, valid keys are <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_SHEETNAME">sheetName</a>, <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_SORT">sort</a> and <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_EMPTYSYMBOLS">emptySymbols</a>. The sheet used for the table of contents is always cleared before writing. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_EXCELWRITER_VALUESUB"></a><b>valueSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for mapping in the value column of the <code>DataFrame</code>. Each key in <code>valueSubstitutions</code> is replaced by its corresponding value. The replacement is only performed on the value column of the <code>DataFrame</code> which is the numerical value in case of a GAMS parameter and the set element text in case of a GAMS set. Note that for parameters the ExcelWriter automatically converts numerical GAMS special values to their string representation, i.e. <code>INF</code>, <code>-INF</code>, <code>EPS</code>, <code>NA</code>, and <code>UNDEF</code>. If the GAMS special values should be replaced by custom values, use the string representation (upper case) in the dictionary. For example, specify <code>{'EPS': 0}</code> to replace GAMS special value <code>EPS</code> by zero. See the <a class="el" href="API_PY_GAMSTRANSFER_ADDITIONAL_TOPICS.html#PY_GAMSTRANSFER_SPECVALS">GAMS Transfer documentation</a> for more information on GAMS special values. </p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_FILTER"></a>
Filter</h2>
<p>The Filter agent allows to reduce symbol data by applying filters on labels and numerical values. Here is an example that uses the Filter agent:</p>
<pre><code class="language-gams">Set i / seattle, san-diego /
    j / new-york, chicago, topeka /;

Parameter d(i,j) /
seattle.new-york   2.5
seattle.chicago    1.7
seattle.topeka     1.8
san-diego.new-york 2.5
san-diego.chicago  1.8
san-diego.topeka   1.4
/;

$onEmbeddedCode Connect:
- GAMSReader:
    symbols:
      - name: d
- Filter:
    name: d
    newName: d_new
    labelFilters:
      - dimension: 1
        keep: ['seattle']
      - dimension: 2
        reject: ['topeka']
    valueFilters:
      - rule: x&lt;2.5
- GDXWriter:
    file: report.gdx
    symbols:
      - name: d_new
$offEmbeddedCode
</code></pre>
<p>The records of the parameter <code>d</code> are filtered and stored in a new parameter called <code>d_new</code>. Two label filters remove all labels except <code>seattle</code> from the first dimension and remove the label <code>topeka</code> from the second one. The remaining records are filtered by value where only values less than 2.5 are kept in the data. The resulting parameter <code>d_new</code> which is exported into <code>report.gdx</code> has only one record (<code>seattle.chicago 1.7</code>) left.</p>
<p>The following options are available for the Filter agent:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_ATTRIBUTE">attribute</a>   </td><td class="markdownTableBodyLeft">valueFilters   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify the attribute to which a value filter is applied.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_DIMENSION">dimension</a>   </td><td class="markdownTableBodyLeft">labelFilters   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify the dimension to which a label filter is applied.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_KEEP">keep</a>   </td><td class="markdownTableBodyLeft">labelFilters   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a list of labels to keep.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_LABELFILTERS">labelFilters</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify filters for index columns of a symbol.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_NAME">name</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a symbol name for the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_NEWNAME">newName</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a new name for the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_REGEX">regex</a>   </td><td class="markdownTableBodyLeft">labelFilters   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a regular expression to be used for filtering labels.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">reject</a>   </td><td class="markdownTableBodyLeft">labelFilters   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a list of labels to reject.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_REJECTSV">rejectSpecialValues</a>   </td><td class="markdownTableBodyLeft">valueFilters   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify the special values to reject.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_RULE">rule</a>   </td><td class="markdownTableBodyLeft">valueFilters   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a boolean expression to be used for filtering on numerical columns.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_RULEIDENTIFIER">ruleIdentifier</a>   </td><td class="markdownTableBodyLeft">valueFilters   </td><td class="markdownTableBodyLeft"><code>x</code>   </td><td class="markdownTableBodyLeft">The identifier used for the value filter rule.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_FILTER_VALUEFILTERS">valueFilters</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify filters for numerical columns of a symbol.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_ATTRIBUTE"></a><b>attribute:</b> <code>all</code>, <code>value</code>, <code>level</code>, <code>marginal</code>, <code>upper</code>, <code>lower</code>, <code>scale</code> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>Used to specify the attribute to which a value filter is applied. The following strings are allowed depending on the symbol type:</p>
<ul>
<li>Set: Not allowed</li>
<li>Parameter: <code>all</code> (default), <code>value</code></li>
<li>Variable and equation: <code>all</code> (default), <code>level</code>, <code>marginal</code>, <code>upper</code>, <code>lower</code>, <code>scale</code></li>
</ul>
<p>The default <code>all</code> will apply the value filter on all value columns of the symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_DIMENSION"></a><b>dimension:</b> <code>all</code>, <em>integer</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>Used to specify the dimension to which a label filter is applied. The default <code>all</code> will apply the label filter on all dimensions of the symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_KEEP"></a><b>keep:</b> <em>list of strings</em> (required: <a class="el" href="#UG_GAMSCONNECT_FILTER_KEEP">keep</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REGEX">regex</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">reject</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_FILTER_REGEX">regex</a>, <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">reject</a>) </p><blockquote class="doxtable">
<p>A list of labels to be kept when applying the label filter.</p>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_FILTER_REGEX">regex</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">reject</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_LABELFILTERS"></a><b>labelFilters:</b> <em>list of label filters</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>A list containing label filters. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol from the Connect database on whose data the filters will be applied. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_NEWNAME"></a><b>newName:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a new name for the symbol in the Connect database which will get the data after all filters have been applied. Each symbol in the Connect database must have a unique name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_REGEX"></a><b>regex:</b> <em>string</em> (required: <a class="el" href="#UG_GAMSCONNECT_FILTER_KEEP">keep</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REGEX">regex</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">reject</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_FILTER_KEEP">keep</a>, <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">reject</a>) </p><blockquote class="doxtable">
<p>A string containing a regular expression that needs to match in order to keep the corresponding label. Uses a full match paradigm which means that the whole label needs to match the specified regular expression.</p>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_FILTER_KEEP">keep</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">reject</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_REJECT"></a><b>reject:</b> <em>string</em> (required: <a class="el" href="#UG_GAMSCONNECT_FILTER_KEEP">keep</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REGEX">regex</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">reject</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_FILTER_KEEP">keep</a>, <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">regex</a>) </p><blockquote class="doxtable">
<p>A list of labels to be rejected when applying the label filter.</p>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_FILTER_KEEP">keep</a> or <a class="el" href="#UG_GAMSCONNECT_FILTER_REJECT">regex</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_REJECTSV"></a><b>rejectSpecialValues:</b> <code>EPS</code>, <code>+INF</code>, <code>-INF</code>, <code>UNDEF</code>, <code>NA</code>, <em>list of special values</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Can be used to reject single special values, e.g. <code>rejectSpecialValues: EPS</code>, or a list of special values, e.g. <code>rejectSpecialValues: [EPS, UNDEF, -INF]</code>. The following string representation of the GAMS special values must be used: <code>INF</code>, <code>-INF</code>, <code>EPS</code>, <code>NA</code> and <code>UNDEF</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_RULE"></a><b>rule:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Used to specify a boolean expression for a value filter. Each numerical value of the specified <a class="el" href="#UG_GAMSCONNECT_FILTER_DIMENSION">dimension</a> is tested and the corresponding record is only kept if the expression evaluates to true. The string needs to contain Python syntax that is valid for <code>pandas.Series</code>. Comparison operators like <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>==</code>, or <code>!=</code> can be used in combination with boolean operators like <code>&amp;</code> or <code>|</code>, but not <code>and</code> or <code>or</code>. Note that using <code>&amp;</code> or <code>|</code> requires the operands to be enclosed in round brackets in order to form a valid expression. As an example, the expression <code>((x&lt;=10) &amp; (x&gt;=0)) | (x&gt;20)</code> would keep only those values that are between <code>0</code> and <code>10</code> (included) or greater than <code>20</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_RULEIDENTIFIER"></a><b>ruleIdentifier:</b> <em>string</em> (default: <code>x</code>) </p><blockquote class="doxtable">
<p>Specifies the identifier that is used in the <a class="el" href="#UG_GAMSCONNECT_FILTER_RULE">rule</a> of a value filter. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_FILTER_VALUEFILTERS"></a><b>valueFilters:</b> <em>list of value filters</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>A list containing value filters. </p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_GAMSREADER"></a>
GAMSReader</h2>
<p>The GAMSReader allows reading symbols from the GAMS database into the Connect database. Without GAMS context (e.g. when running the <code>gamsconnect</code> script from the command line) this agent is not available and its execution will result in an exception.</p>
<p>The GAMSReader allows to either read all symbols from the GAMS database:</p>
<pre class="fragment">- GAMSReader:
    symbols: all
</pre><p>Or specific symbols only:</p>
<pre class="fragment">- GAMSReader:
    symbols:
      - name: i 
      - name: p
        newName: p_new
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSREADER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the GAMS database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSREADER_NEWNAME">newName</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a new name for the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSREADER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSREADER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSREADER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol in the GAMS database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSREADER_NEWNAME"></a><b>newName:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a new name for the symbol in the Connect database. Each symbol in the Connect database must have a unique name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSREADER_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. Allows to read a subset of symbols. The default <code>all</code> reads all symbols from the GAMS database into the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSREADER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_GAMSWRITER"></a>
GAMSWriter</h2>
<p>The GAMSWriter allows writing symbols in the Connect database to the GAMS database. Without GAMS context (e.g. when running the <code>gamsconnect</code> script from the command line) and as part of the <a class="el" href="UG_GamsCall.html#GAMSAOconnectout">connectOut</a> command line option this agent is not available and its execution will result in an exception.</p>
<p>The GAMSWriter allows to either write all symbols in the Connect database to the GAMS database:</p>
<pre class="fragment">- GAMSWriter:
    symbols: all
</pre><p>Or specific symbols only:</p>
<pre class="fragment">- GAMSWriter:
    symbols:
      - name: i 
      - name: p
        newName: p_new
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_DOMAINCHECKTYPE">domainCheckType</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>default</code>   </td><td class="markdownTableBodyLeft">Specify if domain checking is applied or if records that would cause a domain violation are filtered.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_DUPLICATERECORDS">duplicateRecords</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify which record(s) to keep in case of duplicate records.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_MERGETYPE">mergeType</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>default</code>   </td><td class="markdownTableBodyLeft">Specify if data in a GAMS symbol is merged or replaced.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_NEWNAME">newName</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a new name for the symbol in the GAMS database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSWRITER_DOMAINCHECKTYPE"></a><b>domainCheckType:</b> <code>checked</code>, <code>default</code>, <code>filtered</code> (default: <code>default</code>) </p><blockquote class="doxtable">
<p>Specify if <a class="el" href="UG_SetDefinition.html#UG_SetDefinition_DomainChecking">Domain Checking</a> is applied (<code>checked</code>) or if records that would cause a domain violation are filtered (<code>filtered</code>). If left at <code>default</code> it depends on the setting of <a class="el" href="UG_DollarControlOptions.html#DOLLARonofffiltered">$on/offFiltered</a> if GAMS does a filtered load or checks the domains during <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_SyntaxCT">compile time</a>. During <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_SyntaxET">execution time</a> <code>default</code> is the same as <code>filtered</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSWRITER_DUPLICATERECORDS"></a><b>duplicateRecords:</b> <code>all</code>, <code>first</code>, <code>last</code>, <code>none</code> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A symbol in the Connect database can hold multiple records for the same indexes. Such duplicate records are only a problem when exchanging the data with GAMS (and GDX). The attribute determines which record(s) to keep in case of (case insensitive) duplicate records. With the default of <code>all</code> the GAMSWriter will fail in case duplicate records exist. With <code>first</code> the first record will be written to GAMS, with <code>last</code> the last record will be written to GAMS. With <code>none</code> none of the duplicate records will be written to GAMS. Note that the agent deals with duplicate records in a case insensitive way. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSWRITER_MERGETYPE"></a><b>mergeType:</b> <code>default</code>, <code>merge</code>, <code>replace</code> (default: <code>default</code>) </p><blockquote class="doxtable">
<p>Specify if data in a GAMS symbol is merged (<code>merge</code>) or replaced (<code>replace</code>). If left at <code>default</code> it depends on the setting of <a class="el" href="UG_DollarControlOptions.html#DOLLARonoffmulti">$on/offMulti[R]</a> if GAMS does a merge, replace, or triggers an error during <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_SyntaxCT">compile time</a>. During <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_SyntaxET">execution time</a> <code>default</code> is the same as <code>merge</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSWRITER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol in the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSWRITER_NEWNAME"></a><b>newName:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a new name for the symbol in the GAMS database. Note, each symbol in the GAMS database must have a unique name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSWRITER_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. Allows to write a subset of symbols. The default <code>all</code> writes all symbols from the Connect database into to the GAMS database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GAMSWRITER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_GDXREADER"></a>
GDXReader</h2>
<p>The GDXReader allows reading symbols from a specified GDX file into the Connect database.</p>
<p>The GDXReader allows to either read all symbols from a GDX file:</p>
<pre class="fragment">- GDXReader:
    file: in.gdx
    symbols: all
</pre><p>Or specific symbols only:</p>
<pre class="fragment">- GDXReader:
    file: in.gdx
    symbols:
      - name: i 
      - name: p
        newName: p_new
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXREADER_FILE">file</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a GDX file path.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXREADER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the GDX file.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXREADER_NEWNAME">newName</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a new name for the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXREADER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXREADER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXREADER_FILE"></a><b>file:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a GDX file path. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXREADER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol in the GDX file. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXREADER_NEWNAME"></a><b>newName:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a new name for the symbol in the Connect database. Each symbol in the Connect database must have a unique name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXREADER_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. Allows to read a subset of symbols. The default <code>all</code> reads all symbols from the GDX file into the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXREADER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_GDXWRITER"></a>
GDXWriter</h2>
<p>The GDXWriter allows writing symbols in the Connect database to a specified GDX file.</p>
<p>The GDXWriter allows to either write all symbols in the Connect database to a GDX file:</p>
<pre class="fragment">- GDXWriter:
    file: out.gdx
    symbols: all
</pre><p>Or specific symbols only:</p>
<pre class="fragment">- GDXWriter:
    file: out.gdx
    symbols:
      - name: i 
      - name: p
        newName: p_new
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXWRITER_DUPLICATERECORDS">duplicateRecords</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify which record(s) to keep in case of duplicate records.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXWRITER_FILE">file</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a GDX file path.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXWRITER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXWRITER_NEWNAME">newName</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a new name for the symbol in the GDX file.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXWRITER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_GDXREADER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXWRITER_DUPLICATERECORDS"></a><b>duplicateRecords:</b> <code>all</code>, <code>first</code>, <code>last</code>, <code>none</code> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A symbol in the Connect database can hold multiple records for the same indexes. Such duplicate records are only a problem when exchanging the data with GDX (and GAMS). The attribute determines which record(s) to keep in case of (case insensitive) duplicate records. With the default of <code>all</code> the GDXWriter will fail in case duplicate records exist. With <code>first</code> the first record will be written to GDX, with <code>last</code> the last record will be written to GDX. With <code>none</code> none of the duplicate records will be written to GDX. Note that the agent deals with duplicate records in a case insensitive way. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXWRITER_FILE"></a><b>file:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a GDX file path. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXWRITER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol in the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXWRITER_NEWNAME"></a><b>newName:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a new name for the symbol in the GDX file. Note, each symbol in the GDX file must have a unique name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXWRITER_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. Allows to write a subset of symbols. The default <code>all</code> writes all symbols from the Connect database into to the GDX file. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_GDXWRITER_TRACE"></a><b>trace</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output. For <code>trace &gt; 1</code> some scalar debugging output will be written to the log. For <code>trace &gt; 2</code> the intermediate data frames will be written abbreviated to the log. For <code>trace &gt; 3</code> the intermediate data frames will be written entirely to the log (potentially large output). </p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR"></a>
LabelManipulator</h2>
<p>The LabelManipulator agent allows to modify labels of symbols in the Connect database. Four different modes are available:</p>
<ul>
<li>case: Applies either upper, lower, or capitalize casing to labels.</li>
<li>code: Replaces labels using a Python code.</li>
<li>map: Uses a 1-dimensional GAMS set to perform an explicit mapping of labels.</li>
<li>regex: Performs a replacement based on a regular expression.</li>
</ul>
<p>The LabelManipulator supports manipulating the labels of the entire symbol (default) or in a specific dimension by specifying the <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_DIMENSION">dimension</a> option.</p>
<p>Here is an example that uses the LabelManipulator agent in all four modes:</p>
<pre><code class="language-gams">Set i / seattle, san-diego /
    j / new-york, chicago, topeka /
    map / chicago 'Berlin', san-diego 'Oslo' /;

Parameter d(i,j) /
seattle.new-york   2.5
seattle.chicago    1.7
seattle.topeka     1.8
san-diego.new-york 2.5
san-diego.chicago  1.8
san-diego.topeka   1.4
/;

$onEmbeddedCode Connect:
- GAMSReader:
    symbols: all
- LabelManipulator:
    map:
        setName: map
- LabelManipulator:
    case:
        rule: upper
- LabelManipulator:
    symbols:
      - name: d
    code:
        rule: x.split('-')[-1]
- LabelManipulator:
    symbols:
      - name: d
    regex:
        pattern: '[^O]$'
        replace: '\g&lt;0&gt;X'
    dimension: 1
- PythonCode:
    code: |
        print("Set i:\n", connect.container["i"].records)
        print("Set j:\n",connect.container["j"].records)
        print("Parameter d:\n",connect.container["d"].records)
$offEmbeddedCode
</code></pre>
<p>In this example, various LabelManipulator agents are utilized to demonstrate different label manipulation capabilities:</p>
<ul>
<li>The first LabelManipulator uses the <code>map</code> mode to apply mappings defined in the GAMS set <code>map</code> across all symbols in the Connect database. Specifically, it maps the label <code>chicago</code> to <code>Berlin</code> and <code>san-diego</code> to <code>Oslo</code>, affecting all occurrences of these labels.</li>
<li>The second LabelManipulator employs the <code>case</code> mode to convert all symbol labels in the database to uppercase. This modification is applied universally to every label across all symbols.</li>
<li>The third LabelManipulator, configured in <code>code</code> mode, targets only the symbol <code>d</code>. It processes each label by splitting it at the hyphen (<code>-</code>) and retains only the last segment of the split. For instance, the label <code>NEW-YORK</code> is transformed to <code>YORK</code>.</li>
<li>The last LabelManipulator, operating in <code>regex</code> mode and equipped with the <code>dimension</code> option set to 1, specifically alters labels in the first dimension of the symbol <code>d</code> (i.e. the <code>i</code> dimension in <code>d(i,j)</code>). It appends an <code>X</code> to labels in the first dimension that do not end with an <code>O</code>.</li>
</ul>
<p>The resulting symbols look as follows:</p>
<pre class="fragment">Set i:
        uni element_text
0  SEATTLE             
1     OSLO 

Set j:
         uni element_text
0  NEW-YORK             
1    BERLIN             
2    TOPEKA 

Parameter d:
           i       j   value
0  SEATTLEX    YORK    2.5
1  SEATTLEX  BERLIN    1.7
2  SEATTLEX  TOPEKA    1.8
3      OSLO    YORK    2.5
4      OSLO  BERLIN    1.8
5      OSLO  TOPEKA    1.4
</pre><p>The following options are available for the LabelManipulator agent:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Apply specified casing to labels.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Replace labels using Python code.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_DIMENSION">dimension</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify the dimension of the symbols for label manipulations.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_INVERT">invert</a>   </td><td class="markdownTableBodyLeft">map   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Used to invert the mapping direction.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Replace labels using a 1-dimensional GAMS set containing an explicit key-value mapping.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a symbol name for the Connect database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_NEWNAME">newName</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify a new name for the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_OUTPUTSET">outputSet</a>   </td><td class="markdownTableBodyLeft">regex/case/code   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Name of the output set that contains the applied mapping.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_PATTERN">pattern</a>   </td><td class="markdownTableBodyLeft">regex   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">The regular expression that needs to match.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Replace labels using a regular expression.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REPLACE">replace</a>   </td><td class="markdownTableBodyLeft">regex   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">The rule used for replacing labels that match the given pattern.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_RULE">rule</a>   </td><td class="markdownTableBodyLeft">case/code   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">case: The type of casing to be applied. code: Python function that defines the mapping behavior.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_RULEIDENTIFIER">ruleIdentifier</a>   </td><td class="markdownTableBodyLeft">code   </td><td class="markdownTableBodyLeft"><code>x</code>   </td><td class="markdownTableBodyLeft">The identifier used for labels in the rule.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_SETNAME">setName</a>   </td><td class="markdownTableBodyLeft">map   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">The name of the GAMS set used in map mode.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_CASE"></a><b>case:</b> <em>dictionary</em> (required: <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>) </p><blockquote class="doxtable">
<p>Used for executing the LabelManipulator in case mode to apply a specified casing to labels.</p>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a>, or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_CODE"></a><b>code:</b> <em>dictionary</em> (required: <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>) </p><blockquote class="doxtable">
<p>Used for executing the LabelManipulator in code mode to replace labels using a Python function. The given Python function is executed with each label and its return value is used as the replacement.</p>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a>, or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_DIMENSION"></a><b>dimension:</b> <code>all</code>, <em>integer</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>Specifies the dimension of the symbol that the label manipulations will be applied to. The default <code>all</code> will apply manipulations to all dimensions of the symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_INVERT"></a><b>invert:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Used for controlling the mapping direction in map mode. If set to <code>False</code> (default), the labels that match a label of the provided 1-dimensional GAMS set are replaced by the corresponding set element text. If set to <code>True</code> the direction is inverted, meaning all labels that match a set element text of the GAMS set are replaced by the corresponding label. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_MAP"></a><b>map:</b> <em>dictionary</em> (required: <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>) </p><blockquote class="doxtable">
<p>Used for executing the LabelManipulator in map mode to replace labels using a 1-dimensional GAMS set containing an explicit key-value mapping.</p>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a>, or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol in the GAMS database. Data of the symbol gets replaced if no <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_NEWNAME">newName</a> is specified. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_NEWNAME"></a><b>newName:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify a new name for the symbol in the Connect database. The original symbol specified under <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_NAME">name</a> remains unchanged. Each symbol in the Connect database must have a unique name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_OUTPUTSET"></a><b>outputSet:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Name of the output set that contains mappings that were actually applied on the symbol labels. Per default no output set is written. Providing a name for the output set indicates that an output set should be written to the Connect database. Note that each symbol in the Connect database must have a unique name. Supported by <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a> and <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a> mode. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_PATTERN"></a><b>pattern:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>The regular expression that needs to match for a label to be replaced. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_REGEX"></a><b>regex:</b> <em>dictionary</em> (required: <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a> or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a>) (excludes: <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a>) </p><blockquote class="doxtable">
<p>Used for executing the LabelManipulator in regex mode to replace labels using a regular expression.</p>
<p>This option can not be specified together with <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a>, or <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_MAP">map</a>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_REPLACE"></a><b>replace:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>A string that specifies the replacement for all labels for which a given <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_PATTERN">pattern</a> in <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_REGEX">regex</a> mode matches. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_RULE"></a><b>rule:</b> <em>string</em> for <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a>, <code>capitalize</code>, <code>lower</code>, <code>upper</code> for <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a> (required) </p><blockquote class="doxtable">
<p>Can be specified in <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CASE">case</a> and <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a> mode.</p>
<p>case: The type of casing to be applied. Allowed values are:</p><ul>
<li><code>lower</code>: Change all labels to lower case.</li>
<li><code>upper</code>: Change all labels to upper case.</li>
<li><code>capitalize</code>: Change all labels to a capitalized casing - first letter becomes upper case, all others become lower case.</li>
</ul>
<p>code: A Python function that defines the mapping behavior. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_RULEIDENTIFIER"></a><b>ruleIdentifier:</b> <em>string</em> (default: <code>x</code>) </p><blockquote class="doxtable">
<p>Specifies the identifier that is used in the <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_RULE">rule</a> of the <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR_CODE">code</a> mode. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_SETNAME"></a><b>setName:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Replace labels using a 1-dimensional GAMS set containing an explicit key-value mapping. A 1-dimensional GAMS set that contains an explicit key-value mapping to replace labels. If <code>invert: False</code> (default) all labels that match a label of the GAMS set will be replaced by the corresponding set element text. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. Allows to execute the LabelManipulator on a subset of GAMS symbols in the Connect database. The default <code>all</code> will apply the LabelManipulator to all symbols of the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_LABELMANIPULATOR_TRACE"></a><b>trace</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_PROJECTION"></a>
Projection</h2>
<p>The Projection agent allows index reordering, projection onto a reduced index space, and expansion to an extended index space through index duplication of a GAMS symbol. It can combine these operations, allowing for complex transformations such as simultaneously duplicating some indices, eliminating others, and reordering (e.g., transforming <code>p(i,j,k)</code> to <code>p_new(k,k,j)</code>). For variables and equations a single suffix (<code>.l</code>, <code>.m</code>, <code>.lo</code>, <code>.up</code>, <code>.scale</code>, or <code>.all</code>) or a list of suffixes (e.g. <code>.[l,m,lo,up,scale]</code> or <code>.[all]</code>) can be extracted and written to a parameter. Otherwise, the type of the source symbol determines the type of the new symbol, unless <code>asSet</code> is set to <code>True</code>. If <code>name</code> is a <em>list</em> of scalar symbols of the same type (parameters, variables, or equations), they can be stored in a one-dimensional symbol of the same type with the index label being the <em>name</em> of the scalar symbol.</p>
<p>Here is an example that uses the Projection agent:</p>
<pre><code class="language-gams">Set i / i1*i2 /, j / j1*j2 /;

Parameter
   p(i,j) / i1.j1 1, i1.j2 2, i2.j1 3, i2.j2 4 /
   s1 / 10 /
   s2 / 11 /
   s3 / 12 /;

Variable x(i,j);
x.l(i,j) = p(i,j);

embeddedCode Connect:
- GAMSReader:
    symbols: all
- Projection:
    # 1. reduce index space
    name: p(i,j)
    newName: p_reduced(i)
    aggregationMethod: sum
- Projection:
    # 2. reorder index space
    name: p(idx1,idx2)
    newName: p_reordered(idx2,idx1)
- Projection:
    # 3. Extend index space
    name: p(i,j)
    newName: p_extended(i,j,i)
- Projection:
    # 4. variable with single suffix
    name: x.l(i,j)
    newName: x_level(i,j)
- Projection:
    # 5. variable with all suffix
    name: x.all(i,j)
    newName: x_all(i)
    aggregationMethod: last
- Projection:
    # 6. parameter as set
    name: p(i,j)
    newName: p_set(i,j)
    asSet: True
    text: "from {i} to {j}"
- Projection:
    # 7. list of scalars
    name: [s1,s2,s3]
    newName: p_scalars
- PythonCode:
    code: |
        print("Parameter p_reduced:\n", connect.container["p_reduced"].records)
        print("Parameter p_reordered:\n", connect.container["p_reordered"].records)
        print("Parameter p_extended:\n", connect.container["p_extended"].records)
        print("Parameter x_level:\n", connect.container["x_level"].records)
        print("Parameter x_all:\n", connect.container["x_all"].records)
        print("Set p_set:\n", connect.container["p_set"].records)
        print("Parameter p_scalars:\n", connect.container["p_scalars"].records)
endEmbeddedCode
</code></pre>
<p>In this example, various Projection agents are utilized to demonstrate different projection capabilities:</p>
<ol type="1">
<li>The Projection agent is used to project parameter <code>p</code> to a reduced index space. Aggregation method <code>sum</code> is selected to aggregate records on the remaining index by taking the sum. <pre class="fragment">    Parameter p_reduced:
         i  value
    0  i1    3.0
    1  i2    7.0</pre></li>
<li>The Projection agent is used to only reorder the index space of parameter <code>p</code>. Note that the list of indices specified under <code>name</code> and <code>newName</code> is solely intended to establish the index order for the new symbol and therefore does not need to coincide with the names of the actual GAMS domain sets. <pre class="fragment">    Parameter p_reordered:
         j   i  value
    0  j1  i1    1.0
    1  j2  i1    2.0
    2  j1  i2    3.0
    3  j2  i2    4.0</pre></li>
<li>The Projection agent is used to project parameter <code>p</code> to an extended index space by duplicating index <code>i</code>. The new symbol has an additional index <code>i</code> with the same values as the original index <code>i</code>. <pre class="fragment">    Parameter p_extended:
       i_0 j_1 i_2   value
    0  i1  j1  i1    1.0
    1  i1  j2  i1    2.0
    2  i2  j1  i2    3.0
    3  i2  j2  i2    4.0</pre></li>
<li>A single suffix (<code>.l</code>) turns the variable into a parameter with only the level values. <pre class="fragment">    Parameter x_level:
         i   j  value
    0  i1  j1    1.0
    1  i1  j2    2.0
    2  i2  j1    3.0
    3  i2  j2    4.0</pre></li>
<li>The <code>.all</code> suffix turns the variable into a parameter with an additional index for the attributes. At the same time the index space is reduced using aggregation method <code>last</code>, i.e. only the last record is kept. <pre class="fragment">    Parameter x_all:
         i   level_1  value
    0  i1     level    2.0
    1  i1  marginal    0.0
    2  i1     lower   -inf
    3  i1     upper    inf
    4  i1     scale    1.0
    5  i2     level    4.0
    6  i2  marginal    0.0
    7  i2     lower   -inf
    8  i2     upper    inf
    9  i2     scale    1.0</pre></li>
<li>The Projection agent is used to turn the parameter into a set (<code>asSet: True</code>) with custom <code>text</code>. <pre class="fragment">    Set p_set:
         i   j   element_text
    0  i1  j1  from i1 to j1
    1  i1  j2  from i1 to j2
    2  i2  j1  from i2 to j1
    3  i2  j2  from i2 to j2
</pre></li>
<li>A list of scalars is concatenated into a one-dimensional symbol where the index labels are the names of the scalar symbols. <pre class="fragment">    Parameter p_scalars:
       uni_0  value
    0    s1   10.0
    1    s2   11.0
    2    s3   12.0
</pre></li>
</ol>
<p>Note that many of the Projection capabilities can be combined (e.g. reducing and reordering the index space of a variable while turning the symbol into a parameter using a suffix). The Projection agent can also be used to aggregate duplicate records according to the selected aggregation method.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PROJECTION_AGGMETHOD">aggregationMethod</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify the aggregation method for the projection.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PROJECTION_ASSET">asSet</a>   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Indicate that the new symbol is a set independent of the type of the source symbol.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PROJECTION_NAME">name</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a symbol name with index space and potentially suffix for the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PROJECTION_NEWNAME">newName</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a new name with index space for the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PROJECTION_TEXT">text</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Element text for resulting sets.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PROJECTION_TRACE">trace</a>   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_PROJECTION_AGGMETHOD"></a><b>aggregationMethod:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify the method used for aggregation. The default <code>null</code> will not perform any aggregation which might result in duplicate records if at least one index position is projected out. For sets, variables, and equations (without suffix) only <code>first</code> and <code>last</code> are meaningful. For parameters, variables, and equations (with suffix) many other aggregation methods are available and meaningful: <code>max</code>, <code>mean</code>, <code>median</code>, <code>min</code>, <code>prod</code>, <code>sem</code> (unbiased standard error of the mean), <code>sum</code>, <code>std</code> (standard deviation), <code>nunique</code> (number of distinct elements), <code>first</code>, <code>last</code>. The projection agent is based on pandas <code>DataFrames</code> and more detailed explanations of the aggregation method can be found at the <a target="_blank" href="https://pandas.pydata.org/docs/reference/frame.html">pandas website</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Performing a projection that results in a scalar symbol with multiple values is currently not supported and requires the use of an aggregation method. </dd></dl>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_PROJECTION_ASSET"></a><b>asSet:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Usually the type of the source symbol and the use of a suffix with variables and equations determine the type of the target symbol. With <code>asSet</code> set to <code>True</code> the target symbol will be a set. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_PROJECTION_NAME"></a><b>name:</b> <em>string</em>, <em>list of strings</em> (required) </p><blockquote class="doxtable">
<p>One either specifies a single symbol name with index space and potentially suffix for the Connect database or a list of symbol names of scalar symbols. In the prior case, <code>name</code> requires the format <code>symName[.suffix](i1,i2,...,iN)</code>. The suffix is only allowed on variable and equation symbols and can be either a single suffix (<code>.l</code>, <code>.m</code>, <code>.lo</code>, <code>.up</code>, <code>.scale</code>, or <code>.all</code>) or a list of suffixes in square brackets (e.g. <code>.[l,m,lo,up,scale]</code>, <code>.[l]</code>, or <code>.[all]</code>). If a list of suffixes is provided an additional index is added at the end of the index list that contains the selected attribute labels (e.g. <code>level</code>, <code>marginal</code>, <code>lower</code>, <code>upper</code>, and <code>scale</code>). Using <code>.all</code> is equivalent to <code>.[all]</code> and <code>.[l,m,lo,up,scale]</code> and will always add an additional index. The list of indices does not need to coincide with the names of the actual GAMS domain sets. This index list together with the index list specified for <code>newName</code> is solely intended to establish the index order in the symbol specified by <code>newName</code>. The names in the index list need to be unique. In the latter case (a list of symbol names), the symbols need to be scalar symbols of the same type (parameter, variable, or equation) and a new one-dimensional symbol (of the same type) is created that holds the symbol names as labels. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_PROJECTION_NEWNAME"></a><b>newName:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a new name with index space for the projected or reordered symbol in the Connect database. Note that each symbol in the Connect database must have a unique name. <code>newName</code> is given as <code>symName(i1,i2,...,iN)</code>. The list of indices does not need to coincide with the names of the actual GAMS domain sets. This index list together with the index list specified for <code>name</code> is solely intended to establish the index order. Only names that are part of the index list specified for <code>name</code> can be used. Unlike the index list for <code>name</code>, the names in the index list for <code>newName</code> can be duplicated. For example: <code>name: p(i,j,k)</code> and <code>newName: q(k,i,i,k)</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_PROJECTION_TEXT"></a><b>text:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Control the handling of element text if the resulting symbol is a set. If set to <code>""</code>, the text will be dropped. When left at default (<code>None</code>) and the projected symbol is a set, the element text of the original set will be used. For other symbols types, the text will be dropped. If <code>text</code> is a string, this string will be assigned to all elements. The string can contain <em>placeholders</em> <code>{i}</code> that will be replaced with the content of the matching index position. For example, <code>text: "{j} - {i}: {element_text}"</code>, where <code>{i}</code> and <code>{j}</code> should be index space names in the index space of the symbol <a class="el" href="#UG_GAMSCONNECT_PROJECTION_NAME">name</a>. <code>{element_text}</code> refers to original element text (set) or string representation of a numerical value (parameter or variable/equation with a given suffix) of the source symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_PROJECTION_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_PYTHONCODE"></a>
PythonCode</h2>
<p>The PythonCode agent allows to execute arbitrary Python code. From within the code, it is possible to access the GAMS database via <code>gams.db</code> (if the PythonCode agent is running in a GAMS context) and the Connect database via <code>connect.container</code>. The GAMS database is an instance of <a class="elRef" href="apis/python/classgams_1_1control_1_1database_1_1GamsDatabase.html">GamsDatabase</a>, whereas the Connect database is a <a class="el" href="API_PY_GAMSTRANSFER.html">GAMS Transfer</a> <code>Container</code> object. Furthermore there is a predefined <code>instructions</code> list that can be filled with agent instructions that are automatically executed.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PYTHONCODE_CODE">code</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Python code to be executed.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_PYTHONCODE_TRACE">trace</a>   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_PYTHONCODE_CODE"></a><b>code:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Python code to be executed. The YAML syntax offers the pipe character (<code>|</code>) for specifying multi-line strings: </p><pre class="fragment">- PythonCode:
    code: |
      print("Print from Python")
      # insert more Python code here
</pre><p>It is possible to generate agents by appending individual agent instructions to the Python <code>instructions</code> list. Those have to be specified by using Python data structures that match the schema of a specific Connect agent. At the end of the Python code, all instructions from the <code>instructions</code> list are automatically executed. The following example shows how to fill the <code>instructions</code> list with three ExcelWriter agents that write different parameters (<code>p0</code>, <code>p1</code>, <code>p2</code>) into separate Excel workbooks (<code>data_p0.xlsx</code>, <code>data_p1.xlsx</code>, <code>data_p2.xlsx</code>). </p><pre class="fragment">- GAMSReader:
    symbols: all
- PythonCode:
    code: |
      symbols = [ 'p0', 'p1', 'p2' ]
      for s in symbols:
        instructions.append(
        {
          'ExcelWriter':
          {
            'file': 'data_{}.xlsx'.format(s),
            'symbols': [{'name': s}]
          }
        })
</pre><p><a class="anchor" id="UG_GAMSCONNECT_PYTHONCODE_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log generated instructions if any. </li>
</ul>
</blockquote>
<p>Using <code>connect.container</code> allows to access the Connect database directly in the Python code. The <code>connect.container</code> is a <a class="el" href="API_PY_GAMSTRANSFER_MAIN_CLASSES.html#PY_GAMSTRANSFER_CREATE_CONTAINER">GAMS Transfer Container</a> object and data within the container is stored as pandas <code>DataFrames</code>. Please refer to the documentation of <a class="el" href="API_PY_GAMSTRANSFER.html">GAMS Transfer</a> to learn more about GAMS Transfer and its functionalities.</p>
<p>The following complete example shows how to access and modify Connect container data and manually add a new symbol with the modified data to the Connect container:</p>
<pre><code class="language-gams">Set i /1, 2, 3/
    i_mod;

$onembeddedCode Connect:
- GAMSReader:
    symbols: all
- PythonCode:
    code: |
        i_mod_records = [ 'i'+n for n in connect.container["i"].records.iloc[:,0] ]
        connect.container.addSet("i_mod", ["*"], records=i_mod_records)
- GAMSWriter:
    symbols:
      - name: i_mod
$offembeddedCode

display i, i_mod;
</code></pre>
<p>The first line takes the data of set <code>i</code> and adds an i at the beginning of each UEL in the first column of the <code>DataFrame</code>. The last line writes the modified <code>DataFrame</code> as set <code>i_mod</code> to the Connect database.</p>
<p>Here is another complete example modifying Connect container data and adding a new symbol with the modified data:</p>
<pre><code class="language-gams">Parameter p;

$onEcho &gt; p_raw.csv
i,j,2000,2001
i1,j1,1,2
i2,j2,3,4
i3,j3,5,6
$offEcho

$onEmbeddedCode Connect:
- CSVReader:
    file: p_raw.csv
    name: p_raw
    header: True
    indexColumns: "1,2"
    valueColumns: "2:lastCol"
- PythonCode:
    code: |
        p_records = [ [r[0] + '_' + r[1]] + list(r) for i,r in connect.container["p_raw"].records.iterrows() ]
        connect.container.addParameter("p", ["*"]*4, records=p_records)
- GAMSWriter:
    symbols:
      - name: p
$offEmbeddedCode

display p;
</code></pre>
<p>In this example, we take the data of parameter <code>p_raw</code> and insert a column of the concatenated row dimensions into the first column of the <code>DataFrame</code>. The modified <code>DataFrame</code> is then added to the Connect container as records for the new symbol <code>p</code>. Here is a display of GAMS parameter <code>p</code>:</p>
<pre class="fragment">INDEX 1 = i1_j1

             2000        2001

i1.j1       1.000       2.000

INDEX 1 = i2_j2

             2000        2001

i2.j2       3.000       4.000

INDEX 1 = i3_j3

             2000        2001

i3.j3       5.000       6.000
</pre><p></p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER"></a>
RawCSVReader</h2>
<p>The RawCSVReader allows reading of unstructured data from a specified CSV file into the Connect database. Due to performance issues this agent is recommended for small to medium sized unstructured CSV only. This reader works similarly compared to the <a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER">RawExcelReader</a> agent. It reads the entire CSV file and represents its content in a couple of GAMS sets:</p>
<ul>
<li><code>r / r1, r2, ... /</code> (rows)</li>
<li><code>c / c1, c2, ... /</code> (columns)</li>
<li><code>vs(r,c) / s1.r1.c2 "cell text", ... /</code> (cells with explanatory text)</li>
<li><code>vu(r,c,*) / s1.r1.c1."cell text" "cell text", ...</code> (cells with potential GAMS label)</li>
</ul>
<p>and a parameter <code>vf(r,c) / r2.c2 3.14, ... /</code> (cells with numerical values). Unlike <a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER">RawExcelReader</a> cells with a <em>date</em> will be not interpreted and stored in <code>vs</code> and <code>vu</code>. Cells with a string value will be stored in <code>vs</code>. If the string length exceeds the maximum length allowed for elements text, it will be truncated. RawCSVReader will try to represent the cell value as a number and if this succeeds stores the number in <code>vf</code>. Strings of GAMS special values <code>INF</code>, <code>-INF</code>, <code>EPS</code>, <code>NA</code>, and <code>UNDEF</code> as well as <code>TRUE</code> and <code>FALSE</code> will be also converted to its numerical counterpart. It will also try to represent the cell value as a string and stores this as a label in the third position in <code>vu</code>. GAMS labels have a length limitation and hence RawCSVReader automatically shortens the label to fit this limit. RawCSVReader will provide a unique label (ending in <code>~n</code> where <code>n</code> is an integer for strings exceeding the label length limit) for each string in the CSV file. The full string (if it fits) will be available as the element text of the <code>vu</code> record.</p>
<p>To read a CSV file with the RawCSVReader specify: </p><pre class="fragment">- RawCSVReader:
    file: data.csv
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_CNAME">cName</a>   </td><td class="markdownTableBodyLeft"><code>c</code>   </td><td class="markdownTableBodyLeft">Symbol name for columns.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_COLUMNLABEL">columnLabel</a>   </td><td class="markdownTableBodyLeft"><code>C</code>   </td><td class="markdownTableBodyLeft">Label for columns.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_FILE">file</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify a CSV file path.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_READASSTRING">readAsString</a>   </td><td class="markdownTableBodyLeft"><code>True</code>   </td><td class="markdownTableBodyLeft">Control the automatic pandas type conversion of cells.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_READCSVARGS">readCSVArguments</a>   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary containing keyword arguments for the <code>pandas.read_csv</code> method.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_RNAME">rName</a>   </td><td class="markdownTableBodyLeft"><code>r</code>   </td><td class="markdownTableBodyLeft">Symbol name for rows.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_ROWLABEL">rowLabel</a>   </td><td class="markdownTableBodyLeft"><code>R</code>   </td><td class="markdownTableBodyLeft">Label for rows.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_VFNAME">vfName</a>   </td><td class="markdownTableBodyLeft"><code>vf</code>   </td><td class="markdownTableBodyLeft">Symbol name for cells with a numerical value.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_VSNAME">vsName</a>   </td><td class="markdownTableBodyLeft"><code>vs</code>   </td><td class="markdownTableBodyLeft">Symbol name for cells with an explanatory text.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWCSVREADER_VUNAME">vuName</a>   </td><td class="markdownTableBodyLeft"><code>vu</code>   </td><td class="markdownTableBodyLeft">Symbol name for cells with a potential GAMS label.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_CNAME"></a><b>cName:</b> <em>string</em> (default: <code>c</code>) </p><blockquote class="doxtable">
<p>Control the name of the set of columns. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_COLUMNLABEL"></a><b>columnLabel:</b> <em>string</em> (default: <code>C</code>) </p><blockquote class="doxtable">
<p>Control the labels for the set of columns (<code>c</code>). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_FILE"></a><b>file:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify a CSV file path. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_READASSTRING"></a><b>readAsString:</b> <em>boolean</em> (default: <code>True</code>) </p><blockquote class="doxtable">
<p>Control the type of cells returned by <a target="_blank" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">pandas.read_csv</a>. If this is set to <code>True</code> (default) all cells are returned as string and the agent tries to interpret the string itself. If this is set to <code>False</code> pandas will try to infer the type. In such a case the agent can't distinguish between cells with <code>1</code> and <code>1.00</code> because pandas turned the integer <code>1</code> already into a float and the agent has no way for recovering the original cell. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_READCSVARGS"></a><b>readCSVArguments:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary containing keyword arguments for the <a target="_blank" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">pandas.read_csv</a> method. By specifying <code>readCSVArguments</code>, it is possible to pass arguments directly to the <code>pandas.read_csv</code> method. For example, <code>readCSVArguments:</code> {delimiter: ';'}. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_RNAME"></a><b>rName:</b> <em>string</em> (default: <code>r</code>) </p><blockquote class="doxtable">
<p>Control the name of the set of rows. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_ROWLABEL"></a><b>rowLabel:</b> <em>string</em> (default: <code>R</code>) </p><blockquote class="doxtable">
<p>Control the labels for the set of rows (<code>r</code>). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames and the cell values and it's processing (potentially large output).</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_VFNAME"></a><b>vfName:</b> <em>string</em> (default: <code>vf</code>) </p><blockquote class="doxtable">
<p>Control the name of the parameter for cells with a numerical value. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_VSNAME"></a><b>vsName:</b> <em>string</em> (default: <code>vs</code>) </p><blockquote class="doxtable">
<p>Control the name of the set for cells with an explanatory text. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWCSVREADER_VUNAME"></a><b>vuName:</b> <em>string</em> (default: <code>vu</code>) </p><blockquote class="doxtable">
<p>Control the name of the set for cells with a potential GAMS label. </p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER"></a>
RawExcelReader</h2>
<p>The RawExcelReader allows reading of unstructured data from a specified Excel file into the Connect database. Due to performance issues this agent is recommended for small to medium sized unstructured Excel files only. This reader works similarly compared to the <a class="el" href="T_XLSDUMP.html">xlsdump</a> tool. It reads the entire spreadsheet and represents its content in a couple of GAMS sets:</p>
<ul>
<li><code>s /s1, s2,.../</code> (workbook sheets)</li>
<li><code>w / Sheet1, Sheet2, ... /</code> (workbook sheets by name)</li>
<li><code>ws(s,w) / s1.Sheet1, s2.Sheet2, ... /</code> (workbook map)</li>
<li><code>r / r1, r2, ... /</code> (rows)</li>
<li><code>c / c1, c2, ... /</code> (columns)</li>
<li><code>vs(s,r,c) / s1.r1.c2 "cell text", ... /</code> (cells with explanatory text)</li>
<li><code>vu(s,r,c,*) / s1.r1.c1."cell text" "cell text", ...</code> (cells with potential GAMS label)</li>
</ul>
<p>and a parameter <code>vf(s,r,c) / s1.r2.c2 3.14, ... /</code> (cells with numerical values). Cells with a <em>date</em> will be stored in it's string representation in <code>vu</code> and as a Julian date in <code>vf</code>. Cells with a string value will be stored in <code>vs</code>. If the string length exceeds the maximum length allowed for elements text, it will be truncated. Excel offers many other cell value types. RawExcelReader will try to represent the cell value as a number and if this succeeds stores the number in <code>vf</code>. Strings of GAMS special values <code>INF</code>, <code>-INF</code>, <code>EPS</code>, <code>NA</code>, and <code>UNDEF</code> will be also converted to its numerical counterpart. It will also try to represent the cell value as a string and stores this as a label in the fourth position in <code>vu</code>. GAMS labels have a length limitation and hence RawExcelReader automatically shortens the label to fit this limit. RawExcelReader will provide a unique label (ending in <code>~n</code> where n is an integer for strings exceeding the label length limit) for each string in the workbook. The full string (if it fits) will be available as the element text of the <code>vu</code> record.</p>
<p>To read an Excel file with the RawExcelReader specify: </p><pre class="fragment">- RawExcelReader:
    file: data.xlsx
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_CNAME">cName</a>   </td><td class="markdownTableBodyLeft"><code>c</code>   </td><td class="markdownTableBodyLeft">Symbol name for columns.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_COLUMNLABEL">columnLabel</a>   </td><td class="markdownTableBodyLeft"><code>C</code>   </td><td class="markdownTableBodyLeft">Label for columns.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_FILE">file</a>   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify an Excel file path.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_MERGEDCELLS">mergedCells</a>   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Control the handling of empty cells that are part of a merged Excel range.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_RNAME">rName</a>   </td><td class="markdownTableBodyLeft"><code>r</code>   </td><td class="markdownTableBodyLeft">Symbol name for rows.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_ROWLABEL">rowLabel</a>   </td><td class="markdownTableBodyLeft"><code>R</code>   </td><td class="markdownTableBodyLeft">Label for rows.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_SHEETLABEL">sheetLabel</a>   </td><td class="markdownTableBodyLeft"><code>S</code>   </td><td class="markdownTableBodyLeft">Label for workbook sheets.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_SNAME">sName</a>   </td><td class="markdownTableBodyLeft"><code>s</code>   </td><td class="markdownTableBodyLeft">Symbol name for workbook sheets.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_VFNAME">vfName</a>   </td><td class="markdownTableBodyLeft"><code>vf</code>   </td><td class="markdownTableBodyLeft">Symbol name for cells with a numerical value.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_VSNAME">vsName</a>   </td><td class="markdownTableBodyLeft"><code>vs</code>   </td><td class="markdownTableBodyLeft">Symbol name for cells with an explanatory text.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_VUNAME">vuName</a>   </td><td class="markdownTableBodyLeft"><code>vu</code>   </td><td class="markdownTableBodyLeft">Symbol name for cells with a potential GAMS label.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_WNAME">wName</a>   </td><td class="markdownTableBodyLeft"><code>w</code>   </td><td class="markdownTableBodyLeft">Symbol name for workbook sheets by name.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER_WSNAME">wsName</a>   </td><td class="markdownTableBodyLeft"><code>ws</code>   </td><td class="markdownTableBodyLeft">Symbol name for workbook map.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_CNAME"></a><b>cName:</b> <em>string</em> (default: <code>c</code>) </p><blockquote class="doxtable">
<p>Control the name of the set of columns. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_COLUMNLABEL"></a><b>columnLabel:</b> <em>string</em> (default: <code>C</code>) </p><blockquote class="doxtable">
<p>Control the labels for the set of columns (<code>c</code>). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_FILE"></a><b>file:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify an Excel file path. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_MERGEDCELLS"></a><b>mergedCells:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Control the handling of empty cells that are part of a merged Excel range. If <code>False</code>, the cells are left empty. If <code>True</code>, the merged value is used in all cells. Note that setting this option to <code>True</code> has an impact on performance since the Excel workbook has to be opened in a non-read-only mode that results in non-constant memory consumption (no lazy loading). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_RNAME"></a><b>rName:</b> <em>string</em> (default: <code>r</code>) </p><blockquote class="doxtable">
<p>Control the name of the set of rows. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_ROWLABEL"></a><b>rowLabel:</b> <em>string</em> (default: <code>R</code>) </p><blockquote class="doxtable">
<p>Control the labels for the set of rows (<code>r</code>). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_SHEETLABEL"></a><b>sheetLabel:</b> <em>string</em> (default: <code>S</code>) </p><blockquote class="doxtable">
<p>Control the labels for the set of workbook sheet (<code>s</code>). </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_SNAME"></a><b>sName:</b> <em>string</em> (default: <code>s</code>) </p><blockquote class="doxtable">
<p>Control the name of the set of workbook sheets. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames and the cell values and it's processing (potentially large output).</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_VFNAME"></a><b>vfName:</b> <em>string</em> (default: <code>vf</code>) </p><blockquote class="doxtable">
<p>Control the name of the parameter for cells with a numerical value. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_VSNAME"></a><b>vsName:</b> <em>string</em> (default: <code>vs</code>) </p><blockquote class="doxtable">
<p>Control the name of the set for cells with an explanatory text. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_VUNAME"></a><b>vuName:</b> <em>string</em> (default: <code>vu</code>) </p><blockquote class="doxtable">
<p>Control the name of the set for cells with a potential GAMS label. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_WNAME"></a><b>wName:</b> <em>string</em> (default:<code>w</code>) </p><blockquote class="doxtable">
<p>Control the name of the set of workbook sheets by name. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_RAWEXCELREADER_WSNAME"></a><b>wsName:</b> <em>string</em> (default: <code>ws</code>) </p><blockquote class="doxtable">
<p>Control the name of the set of the workbook map. </p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_SQLREADER"></a>
SQLReader</h2>
<p>The SQLReader agent allows to read symbols (sets and parameters) from a specified database management system (DBMS) into the Connect database. The SQLReader provides DBMS specific connection types for fast and efficient communication with MS-Access, MySQL, Postgres, SQLite and SQL Server (MS-SQL), as well as the generic connection types, PyODBC and SQLAlchemy, that allow to connect to various DBMS if the required database drivers are installed on the system. The SQLAlchemy connection type is based on <code>pandas.DataFrame</code> class' I/O API method <code>read_sql</code>. See <a class="el" href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_SQL">getting started example</a> for a simple example that uses the SQLReader.</p>
<dl class="section note"><dt>Note</dt><dd>The connectivity to MS-Access databases is available on Windows only and requires a 64-bit MS-Access ODBC driver. See <a class="el" href="#UG_GAMSCONNECT_SQLREADER_CONNECTION">connection</a> for more information.</dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_CONNECTION">connection</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Connection dictionary to specify credentials for the database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_CONNECTIONARGUMENTS">connectionArguments</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary containing keyword arguments for the <code>connect</code> constructor of the respective SQL library or for the <code>sqlalchemy.create_engine</code> constructor.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_CONNECTIONTYPE">connectionType</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>sqlite</code>   </td><td class="markdownTableBodyLeft">Specify the connection type that will be used to connect to the database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_DTYPEMAP">dTypeMap</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used to specify the dtype of columns.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_INDEXSUBSTITUTIONS">indexSubstitutions</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for substitutions in the index columns.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_QUERY">query</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the SQL query.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_READSQLARGS">readSQLArguments</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary containing keyword arguments for the <code>pandas.read_sql</code> method.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_TYPE">type</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>par</code>   </td><td class="markdownTableBodyLeft">Control the symbol type.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_VALUECOLS">valueColumns</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"><code>infer</code>   </td><td class="markdownTableBodyLeft">Specify columns to get the values from.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLREADER_VALUESUB">valueSubstitutions</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for mapping in the value column of the <code>DataFrame</code>.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_CONNECTION"></a><b>connection:</b> <em>dictionary</em> (required) </p><blockquote class="doxtable">
<p>Allows to specify the credentials to access the database. Below are examples for connection dictionaries based on the selected <a class="el" href="#UG_GAMSCONNECT_SQLREADER_CONNECTIONTYPE">connectionType</a>.</p>
<p><b>sqlite:</b> </p><pre class="fragment">connection: {'database': 'absolute//path//to//datafile.db'}
</pre><p><b>postgres/mysql/sqlserver:</b> </p><pre class="fragment">connection: {'user': &lt;username of the database server&gt;, 'password': &lt;password&gt;, 'host': &lt;hostname or ip address&gt;, 'port': &lt;port number of remote machine&gt;, 'database': &lt;database name&gt;}
</pre><p><b>access:</b> </p><pre class="fragment">connection: {'DRIVER': 'Microsoft Access Driver (*.mdb, *.accdb)', 'DBQ': 'absolute//path//to//datafile.db'}
</pre><dl class="section note"><dt>Note</dt><dd>The connectivity to MS-Access databases is available on Windows only and requires a 64-bit MS-Access ODBC driver. If no MS-Access is installed or a 32-bit version of MS-Access, download and install a 64-bit MS-Access ODBC Driver as a redistributable package from Microsoft (e.g. <a target="_blank" href="https://www.microsoft.com/en-in/download/details.aspx?id=39358">MS-Access 2013 Runtime_x64</a>).</dd></dl>
<p><b>sqlalchemy:</b></p>
<p>Use <code>connectionType: sqlalchemy</code> to connect to various databases. Note that the argument <code>drivername: &lt;dialect+driver&gt;</code> is required.</p>
<p>For dialect <em>SQLite</em>: </p><pre class="fragment">connection: {'drivername': 'sqlite', 'database': 'absolute//path//to//datafile.db'}
</pre><p>For dialect <em>Postgres</em>: </p><pre class="fragment">connection: {'drivername': 'postgresql+psycopg2', 'username': &lt;username&gt;, 'password': &lt;password&gt;, 'host': &lt;hostname or ip address&gt;, 'port': &lt;port number of remote machine&gt;, 'database': &lt;database name&gt;}
</pre><p>For dialect <em>MySQL</em>: </p><pre class="fragment">connection: {'drivername': 'mysql+pymysql', 'username': &lt;username&gt;, 'password': &lt;password&gt;, 'host': &lt;hostname or ip address&gt;, 'port': &lt;port number of remote machine&gt;, 'database': &lt;database name&gt;}
</pre><p>For dialect <em>SQL Server</em>: </p><pre class="fragment">connection: {'drivername': 'mssql+pymssql', 'username': &lt;username&gt;, 'password': &lt;password&gt;, 'host': &lt;hostname or ip address&gt;, 'port': &lt;port number of remote machine&gt;, 'database': &lt;database name&gt;}
</pre><p>For dialect <em>MS-Access</em>: </p><pre class="fragment">connection: {'drivername': 'access+pyodbc', 'query': {'odbc_connect': 'DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=absolute//path//to//datafile.db;'}}
</pre><dl class="section note"><dt>Note</dt><dd>Connecting to databases other than MySQL, Postgres, SQLite and SQL Server through SQLAlchemy requires the respective driver of that database to be present on the system. For the MS-Access dialect, <a target="_blank" href="https://pypi.org/project/sqlalchemy-access/">sqlalchemy-access</a> must be installed on the system.</dd></dl>
<p><b>pyodbc:</b></p>
<p>Use <code>connectionType: pyodbc</code> to connect any database that provides an ODBC (Open Database Connectivity) driver. Therefore, either specify the DSN (Data Source Name): </p><pre class="fragment">connection: {'DSN': &lt;Data Source Name&gt;}
</pre><p> or insert the connection information directly: </p><pre class="fragment">connection: {'user': &lt;username&gt;, 'password': &lt;password&gt;, 'host': &lt;hostname or ip address&gt;, 'port': &lt;port number of remote machine&gt;, 'database': &lt;database name&gt;, 'driver': &lt;name of the ODBC driver&gt;}
</pre> </blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_CONNECTIONARGUMENTS"></a><b>connectionArguments:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary containing keyword arguments for the <code>connect</code> constructor of the respective SQL library or for the <code>sqlalchemy.create_engine</code> constructor. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_CONNECTIONTYPE"></a><b>connectionType:</b> <code>access</code>, <code>pyodbc</code>, <code>mysql</code>, <code>postgres</code>, <code>sqlalchemy</code>, <code>sqlite</code>, <code>sqlserver</code> (default: <code>sqlite</code>) </p><blockquote class="doxtable">
<p>Specify the connection type that will be used to connect to the database.</p>
<p>The connection type <code>pyodbc</code> allows to connect to any DBMS that provides an ODBC (Open Database Connectivity) driver. The user is responsible that the required ODBC drivers are installed on the system. For Windows systems, the required <code>pyodbc</code> Python library is already included in the GAMS distribution. For non-Windows systems, the user is responsible for installing <a target="_blank" href="https://pypi.org/project/pyodbc/">pyodbc</a> and handling any other dependencies.</p>
<p>The connection type <code>sqlalchemy</code> allows to connect to various DBMS by providing the appropriate dialect and driver. The user is responsible that the required database drivers are installed on the system. Following database drivers are already included in the GAMS distribution: <a target="_blank" href="https://pypi.org/project/psycopg2/">psycopg2</a>, <a target="_blank" href="https://pypi.org/project/pymssql/">pymssql</a>, <a target="_blank" href="https://pypi.org/project/PyMySQL/">pymysql</a> and <a target="_blank" href="https://pypi.org/project/pyodbc/">pyodbc</a> (on Windows only).</p>
<dl class="section note"><dt>Note</dt><dd>If additional Python libraries need to be installed, one can either <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_ExtendingGMSPython">extend GMSPython</a> or <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_UsingAnExternalPython3Installation">use an external Python 3 installation</a> that provides the required libraries. </dd></dl>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_DTYPEMAP"></a><b>dTypeMap:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Allows to specify the dtype of columns in a dictionary as <code>key: value</code> pairs, i.e. <code>&lt;column&gt;: &lt;dtype&gt;</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_INDEXSUBSTITUTIONS"></a><b>indexSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for substitutions in the index columns. Each key in <code>indexSubstitutions</code> is replaced by its corresponding value. This option allows arbitrary replacements in the index columns. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Name of the symbol in the Connect database. The name must be unique for each symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_QUERY"></a><b>query:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the SQL query which will fetch the desired table from the database system. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_READSQLARGS"></a><b>readSQLArguments:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary containing keyword arguments for the <a target="_blank" href="https://pandas.pydata.org/docs/reference/api/pandas.read_sql.html">pandas.read_sql</a> method. Not all arguments of that method are exposed through the YAML interface of the SQLReader agent. By specifying <code>readSQLArguments</code>, it is possible to pass arguments directly to the <code>pandas.read_sql</code> method that is used by the SQLReader agent if <code>connectionType: sqlalchemy</code>. If the connection type is not <code>sqlalchemy</code>, this option can be used to parameterize the SQL query. A small example showing how this option can be used is given below. </p><pre class="fragment">query: "SELECT i,j FROM stock_table WHERE value_col &gt; %(value)s"
readSQLArguments: {'value': 10}
</pre><dl class="section note"><dt>Note</dt><dd>Different DBMS use different parameter markers and some do not support named parameter markers, e.g. <code>PyODBC</code>. </dd></dl>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_SYMBOLS"></a><b>symbols:</b> <em>list of symbols</em> (required) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_TYPE"></a><b>type:</b> <code>par</code>, <code>set</code> (default: <code>par</code>) </p><blockquote class="doxtable">
<p>Control the symbol type. Supported symbol types are <code>par</code> for GAMS parameters and <code>set</code> for GAMS sets. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_VALUECOLS"></a><b>valueColumns:</b> <code>infer</code>, <code>lastCol</code>, <code>none</code>, <em>list of strings</em> (default: <code>infer</code>) </p><blockquote class="doxtable">
<p>Specify columns to get the values from. The value columns contain numerical values in case of a GAMS parameter and set element text in case of a GAMS set. The columns are given as column names represented as a list of strings. For example: <code>valueColumns: ["i1", "i2"]</code>. If there is more than one value column specified, the column names are stacked to index automatically. As string one can specify the symbolic constant <code>lastCol</code> (i.e. <code>valueColumns: lastCol</code>) or <code>none</code> (i.e. <code>valueColumns: none</code>). When <code>lastCol</code> is passed the last column will be treated as a value column and all the other columns will be treated as index columns. When <code>none</code> is passed all columns will be treated as index columns. Specifying <code>none</code> is only valid for symbol type <code>set</code> since symbol type <code>par</code> requires at least one value column. The default <code>infer</code> uses <code>lastCol</code> for symbol type <code>par</code> and <code>none</code> for symbol type <code>set</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLREADER_VALUESUB"></a><b>valueSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for substitutions in the value column. Each key in <code>valueSubstitutions</code> is replaced by its corresponding value. The replacement is only performed on the values which is the numerical value in case of a GAMS parameter and the set element text in case of a GAMS set. While it is possible to make arbitrary replacements, this is especially useful for controlling sparse/dense reading. </p>
</blockquote>
<h2><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER"></a>
SQLWriter</h2>
<p>The SQLWriter agent allows to write symbols (sets and parameters) from the Connect database to a specified database management system (DBMS). Variables and equations need to be turned into parameters with the <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent before they can be written. The SQLWriter provides DBMS specific connection types for fast and efficient communication with MS-Access, MySQL, Postgres, SQLite and SQL Server (MS-SQL), as well as the generic connection types, PyODBC and SQLAlchemy, that allow to connect to various DBMS if the required database drivers are installed on the system. The SQLAlchemy connection type is based on <code>pandas.DataFrame</code> class' I/O API method <code>to_sql</code>. See <a class="el" href="#UG_GAMSCONNECT_GETTING_STARTED_CONNECT_SQL">getting started example</a> for a simple example that uses the SQLWriter.</p>
<dl class="section note"><dt>Note</dt><dd>The connectivity to MS-Access databases is available on Windows only and requires a 64-bit MS-Access ODBC driver. See <a class="el" href="#UG_GAMSCONNECT_SQLWRITER_CONNECTION">connection</a> for more information.</dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Scope   </th><th class="markdownTableHeadLeft">Default   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_COLUMNENCLOSER">columnEncloser</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>'</code>   </td><td class="markdownTableBodyLeft">Specify if the database uses special character to enclose column names.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_CONNECTION">connection</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Connection dictionary to specify credentials for the database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_CONNECTIONARGUMENTS">connectionArguments</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary containing keyword arguments for the <code>connect</code> constructor of the respective SQL library or for the <code>sqlalchemy.create_engine</code> constructor.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_CONNECTIONTYPE">connectionType</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>sqlite</code>   </td><td class="markdownTableBodyLeft">Specify the connection type that will be used to connect to the database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_DTYPEMAP">dTypeMap</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify if the database has a special data type for text and numerical data type columns.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_FAST">fast</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Accelerate data inserts using some non-standard pragmas. For SQLite only.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_IFEXISTS">ifExists</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>fail</code>   </td><td class="markdownTableBodyLeft">Specify the behavior when a table with the same name exists in the database/schema.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_INSERTMETHOD">insertMethod</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>default</code>   </td><td class="markdownTableBodyLeft">Specify the insertion method to be used to write the table in the database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_NAME">name</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the name of the symbol in the Connect database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_SCHEMANAME">schemaName</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Specify the schema name.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_SKIPTEXT">skipText</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Indicate if the set element text will be skipped.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_SMALL">small</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Reduce the size of the database by storing UELs in a separate table. For SQLite only.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_SYMBOLS">symbols</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>all</code>   </td><td class="markdownTableBodyLeft">Specify symbol specific options.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_TABLENAME">tableName</a>   </td><td class="markdownTableBodyLeft">symbols   </td><td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft">Specify the SQL table/relation in the provided database/schema.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_TOSQLARGS">toSQLArguments</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary containing keyword arguments for the <code>pandas.to_sql</code> method.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_TRACE">trace</a>   </td><td class="markdownTableBodyLeft">root   </td><td class="markdownTableBodyLeft"><code>0</code>   </td><td class="markdownTableBodyLeft">Specify the trace level for debugging output.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_UNSTACK">unstack</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>False</code>   </td><td class="markdownTableBodyLeft">Indicate if the last index column will be used as a header row.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><a class="el" href="#UG_GAMSCONNECT_SQLWRITER_VALUESUB">valueSubstitutions</a>   </td><td class="markdownTableBodyLeft">root/symbols   </td><td class="markdownTableBodyLeft"><code>null</code>   </td><td class="markdownTableBodyLeft">Dictionary used for mapping in the value column of the <code>DataFrame</code>.   </td></tr>
</table>
<p>Detailed description of the options:</p>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_COLUMNENCLOSER"></a><b>columnEncloser:</b> <em>string</em> (default: <code>'</code>) </p><blockquote class="doxtable">
<p>When connecting to a database via <code>connectionType: pyodbc</code>, this option can be used to specify the character used to enclose column names. If the database uses <code>[]</code> to enclose column names, then the same can be set through this option. For example, <code>columnEncloser: "[]"</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_CONNECTION"></a><b>connection:</b> <em>dictionary</em> (required) </p><blockquote class="doxtable">
<p>Allows to specify the credentials to access the database. See <a class="el" href="#UG_GAMSCONNECT_SQLREADER_CONNECTION">SQLReader connection</a> for further details and some examples.</p>
<dl class="section note"><dt>Note</dt><dd>The connectivity to MS-Access databases is available on Windows only and requires a 64-bit MS-Access ODBC driver. If no MS-Access is installed or a 32-bit version of MS-Access, download and install a 64-bit MS-Access ODBC Driver as a redistributable package from MS (e.g. <a target="_blank" href="https://www.microsoft.com/en-in/download/details.aspx?id=39358">MS-Access 2013 Runtime_x64</a>). </dd></dl>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_CONNECTIONARGUMENTS"></a><b>connectionArguments:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary containing keyword arguments for the <code>connect</code> constructor of the respective SQL library or for the <code>sqlalchemy.create_engine</code> constructor. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_CONNECTIONTYPE"></a><b>connectionType:</b> <code>access</code>, <code>pyodbc</code>, <code>mysql</code>, <code>postgres</code>, <code>sqlalchemy</code>, <code>sqlite</code>, <code>sqlserver</code> (default: <code>sqlite</code>) </p><blockquote class="doxtable">
<p>Specify the connection type that will be used to connect to the database.</p>
<p>The connection type <code>pyodbc</code> allows to connect to any DBMS that provides an ODBC (Open Database Connectivity) driver. The user is responsible that the required ODBC drivers are installed on the system. For Windows systems, the required <code>pyodbc</code> Python library is already included in the GAMS distribution. For non-Windows systems, the user is responsible for installing <a target="_blank" href="https://pypi.org/project/pyodbc/">pyodbc</a> and handling any other dependencies for the local Python installation.</p>
<dl class="section note"><dt>Note</dt><dd><code>pyodbc</code> provides a simple and consistent API to connect to many different databases using the ODBC interface. This introduces the challenge that database specific properties are not taken into consideration. For example, different databases have different escaping syntax in order to escape special characters in column names of a table. Thus, the implementation for connection type <code>pyodbc</code> is kept as a general purpose connector to different databases while not escaping the special characters.</dd></dl>
<p>The connection type <code>sqlalchemy</code> allows to connect to various DBMS by providing the appropriate dialect and driver. The user is responsible that the required database drivers are installed on the system. Following database drivers are already included in the GAMS distribution: <a target="_blank" href="https://pypi.org/project/psycopg2/">psycopg2</a>, <a target="_blank" href="https://pypi.org/project/pymssql/">pymssql</a>, <a target="_blank" href="https://pypi.org/project/PyMySQL/">pymysql</a> and <a target="_blank" href="https://pypi.org/project/pyodbc/">pyodbc</a> (on Windows only).</p>
<dl class="section note"><dt>Note</dt><dd>If additional Python libraries need to be installed, one can either <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_ExtendingGMSPython">extend GMSPython</a> or <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_UsingAnExternalPython3Installation">use an external Python 3 installation</a> that provides the required libraries. </dd></dl>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_DTYPEMAP"></a><b>dTypeMap:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>When connecting to a database via <code>connectionType: pyodbc</code>, this option can be used to specify custom data types for text and numerical data if the database does not support the default assignment which is as follows: </p><pre class="fragment">dTypeMap: {'float': 'FLOAT', 'integer': 'BIGINT', 'text': 'TEXT'}
</pre><p> If the database stores integers using <code>BIGINT</code> data type but stores floating point numbers as <code>DOUBLE</code> and text using <code>BLOB</code> data type, then the option should take the following key-value pairs, <code>dTypeMap: {'float': 'DOUBLE', 'text': 'BLOB'}</code>. Keys other than <code>float</code>, <code>integer</code>, and <code>text</code> will be ignored. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_FAST"></a><b>fast:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Specify if the SQLWriter should accelerate data inserts using some non-standard pragmas for <code>connectionType: sqlite</code>. Enabling this option turns off the SQLite journal and the synchronize option which speeds up data inserts but reduces data consistency in case of a program crash. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_IFEXISTS"></a><b>ifExists:</b> <code>append</code>, <code>fail</code>, <code>replace</code> (default: <code>fail</code>) </p><blockquote class="doxtable">
<p>Specify the behavior when a table with the same name exists in the database/schema. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_INSERTMETHOD"></a><b>insertMethod:</b> <code>bcp</code>, <code>bulkInsert</code>, <code>default</code> (default: <code>default</code>) </p><blockquote class="doxtable">
<p>Specify the insertion method to be used to write the table in the database.</p>
<p>The insertion method <code>bulkInsert</code> allows for faster insertion when exporting large amounts of data. It can be used together with connection types <code>access</code>, <code>mysql</code>, <code>postgres</code> and <code>sqlserver</code> (for local SQL Server databases). It creates a temporary CSV file and then imports the file into the database.</p>
<p>The insertion method <code>bcp</code> can only be used together with connection type <code>sqlserver</code>. It is based on the <a target="_blank" href="https://learn.microsoft.com/en-us/sql/tools/bcp-utility?view=sql-server-ver16&amp;tabs=windows">bulk copy program</a> (bcp) utility of SQL Server and allows for fast insertion when exporting large amounts of data to local and remote SQL Server databases. In order to use the insert method <code>bcp</code>, the ODBC driver for SQL Server and the bcp utility must be installed on the system. For more information on installing both requirements, refer to the official <a target="_blank" href="https://learn.microsoft.com/en-us/sql/tools/bcp-utility?view=sql-server-ver16&amp;tabs=windows#download-the-latest-version-of-the-bcp-utility">bcp utility documentation</a>.</p>
<dl class="section note"><dt>Note</dt><dd>For MySQL with <code>insertionMethod: bulkInsert</code> the option <code>LOCAL_INFILE</code> must be enabled on the server. </dd></dl>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_NAME"></a><b>name:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Specify the name of the symbol in the Connect database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_SCHEMANAME"></a><b>schemaName:</b> <em>string</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Specify the schema name for writing the table to the correct location. In Postgres, by default, it writes to a public schema already present in every database. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_SKIPTEXT"></a><b>skipText:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Indicate if the set element text will be skipped. If <code>False</code>, the set element text will be written to the last column of the database table. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_SMALL"></a><b>small:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Reduce the size of the database by storing UELs in a separate table for <code>connectionType: sqlite</code>. A user-friendly SQL VIEW is created to hide the complexity of the joins. The created tables are accessible through their corresponding SQL VIEW.</p>
<dl class="section note"><dt>Note</dt><dd>The SQL VIEW is created with the specified table name, whereas the underlying SQL TABLE is created using the table name with an appended <code>$</code>.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>This option can only be enabled when writing a new SQLite database file. The SQLWriter with activated <code>small</code> mode, does not support writing to an existing database. </dd></dl>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_SYMBOLS"></a><b>symbols:</b> <code>all</code>, <em>list of symbols</em> (default: <code>all</code>) </p><blockquote class="doxtable">
<p>A list containing symbol specific options. The default <code>all</code> writes each parameter and set into the specified DBMS where the table name is defined by the name of the symbol. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_TABLENAME"></a><b>tableName:</b> <em>string</em> (required) </p><blockquote class="doxtable">
<p>Name of the SQL table/relation in the provided database/schema. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_TOSQLARGS"></a><b>toSQLArguments:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary containing keyword arguments for the <a target="_blank" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_sql.html">pandas.to_sql</a> method. Not all arguments of that method are exposed through the YAML interface of the SQLWriter agent. By specifying <code>toSQLArguments</code>, it is possible to pass arguments directly to the <code>pandas.to_sql</code> method that is used by the SQLWriter agent if <code>connectionType: sqlalchemy</code>. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_TRACE"></a><b>trace:</b> <em>integer</em> (default: <code>0</code>) </p><blockquote class="doxtable">
<p>Specify the trace level for debugging output:</p><ul>
<li><code>trace = 0</code>: No trace output.</li>
<li><code>trace &gt; 0</code>: Log instructions and Connect container status.</li>
<li><code>trace &gt; 1</code>: Log additional scalar output.</li>
<li><code>trace &gt; 2</code>: Log abbreviated intermediate DataFrames.</li>
<li><code>trace &gt; 3</code>: Log entire intermediate DataFrames (potentially large output). </li>
</ul>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_UNSTACK"></a><b>unstack:</b> <em>boolean</em> (default: <code>False</code>) </p><blockquote class="doxtable">
<p>Indicate if the last index column will be used as a header row. </p>
</blockquote>
<p><a class="anchor" id="UG_GAMSCONNECT_SQLWRITER_VALUESUB"></a><b>valueSubstitutions:</b> <em>dictionary</em> (default: <code>null</code>) </p><blockquote class="doxtable">
<p>Dictionary used for mapping in the value column of the <code>DataFrame</code>. Each key in <code>valueSubstitutions</code> is replaced by its corresponding value. The replacement is only performed on the value column of the <code>DataFrame</code> which is the numerical value in case of a GAMS parameter and the set element text in case of a GAMS set. If GAMS special values should be replaced by custom values, use the string representation (upper case) in the dictionary, i.e. <code>INF</code>, <code>-INF</code>, <code>EPS</code>, <code>NA</code>, and <code>UNDEF</code>. For example, specify <code>{'EPS': 0}</code> to replace GAMS special value <code>EPS</code> by zero. See the <a class="el" href="API_PY_GAMSTRANSFER_ADDITIONAL_TOPICS.html#PY_GAMSTRANSFER_SPECVALS">GAMS Transfer documentation</a> for more information on GAMS special values. In contrast to the <a class="el" href="#UG_GAMSCONNECT_CSVWRITER_VALUESUB">CSVWriter</a> and the <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_VALUESUB">ExcelWriter</a>, the SQLWriter does not automatically convert numerical GAMS special values to their string representation. The actual values depend on the DBMS as well as the <a class="el" href="#UG_GAMSCONNECT_SQLWRITER_CONNECTIONTYPE">connectionType</a>. </p>
</blockquote>
<h1><a class="anchor" id="UG_GAMSCONNECT_EXAMPLES"></a>
Examples</h1>
<p>This section provides a collection of more complex examples. For simple examples see section <a class="el" href="#UG_GAMSCONNECT_GETTING_STARTED">Getting Started Examples</a>.</p>
<h2><a class="anchor" id="UG_GAMSCONNECT_EXAMPLES_CONNECT06"></a>
Connect Example for Excel (executeTool win32.ExcelMerge)</h2>
<p>The following example shows how to read and write Excel files in Connect. On Windows with Excel installed, the output sheets are merged back into the input workbook using tool <a class="el" href="T_WIN32_EXCELMERGE.html">win32.ExcelMerge</a>. The entire code is listed at the end of the example. This model is part of DataLib as model <a class="elRef" href="../datalib_ml/libhtml/datalib_connect05.html">connect05</a>. First, the original matrix <code>a</code> is read using the <a class="el" href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a> and is then written to input.xlsx using the <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER">ExcelWriter</a>. After clearing symbols <code>i</code> and <code>a</code> in the GAMS database, the <a class="el" href="#UG_GAMSCONNECT_EXCELREADER">ExcelReader</a> is used to read file input.xlsx back in and create parameter <code>a</code> in the Connect database. The <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent extracts set <code>i</code> from parameter <code>a</code>. With the <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a>, symbols <code>i</code> and <code>a</code> are written to the GAMS database. The tool <a class="el" href="T_LINALG_INVERT.html">linalg.invert</a> calculates the inverse <code>inva</code> of <code>a</code> which is then written to output.xlsx using Connect's GAMSReader and ExcelWriter at execution time. The following lines then check if the code is not executed on a UNIX system and if Excel is available. If both is true, output.xlsx is merged into input.xlsx using tool <a class="el" href="T_WIN32_EXCELMERGE.html">win32.ExcelMerge</a> and both symbols <code>inva</code> and <code>a</code> can be read from input.xslx with a single instance of the ExcelReader. If the code is executed on a UNIX system and/or Excel is not available, output.xlsx can not be merged into input.xlsx, and both files need to be read to create the symbols <code>inva</code> and <code>a</code>. The last part makes sure that <code>inva</code> is the inverse of <code>a</code>.</p>
<pre><code class="language-gams">set i / i1*i3 /; alias (i,j,k);
table a(i,j) 'original matrix'
      i1     i2     i3
i1    1      2      3
i2    1      3      4
i3    1      4      3
;
$onEmbeddedCode Connect:
- GAMSReader:
    symbols:
      - name: a
- ExcelWriter:
    file: input.xlsx
    symbols:
      - name: a
$offEmbeddedCode

$onMultiR
$clear i a

$onEmbeddedCode Connect:
- ExcelReader:
    file: input.xlsx
    symbols:
      - name: a
- Projection:
    name: a(i,j)
    newName: i(i)
    asSet: True
- GAMSWriter:
    symbols: all
    duplicateRecords: first
$offEmbeddedCode i a

parameter
  inva(i,j) 'inverse of a'
  chk(i,j)  'check the product a * inva'
  ;

executeTool.checkErrorLevel 'linalg.invert i a inva';

embeddedCode Connect:
- GAMSReader:
    symbols:
      - name: inva
- ExcelWriter:
    file: output.xlsx
    symbols:
      - name: inva
endEmbeddedCode

Scalar mergedRead /0/;
executeTool 'win32.msappavail Excel';
mergedRead$(errorLevel=0) = 1;

if (mergedRead,
    executeTool.checkErrorLevel 'win32.excelMerge output.xlsx input.xlsx';
    embeddedCode Connect:
    - ExcelReader:
        file: input.xlsx
        symbols:
          - name: a
          - name: inva
    - GAMSWriter:
        symbols: all
    endEmbeddedCode a inva
else
    embeddedCode Connect:
    - ExcelReader:
        file: input.xlsx
        symbols:
          - name: a
    - ExcelReader:
        file: output.xlsx
        symbols:
          - name: inva
    - GAMSWriter:
        symbols: all
    endEmbeddedCode a inva
);

chk(i,j) = sum{k, a(i,k)*inva(k,j)};
chk(i,j) = round(chk(i,j),15);
display a,inva,chk;
chk(i,i) = chk(i,i) - 1;
abort$[card(chk)] 'a * ainv &lt;&gt; identity';
</code></pre>
<h2><a class="anchor" id="UG_GAMSCONNECT_EXAMPLES_CONNECT01"></a>
Connect Example for Excel</h2>
<p>The following example shows how to read and write Excel files in Connect. The entire code is listed at the end of the example. This model is part of DataLib as model <a class="elRef" href="../datalib_ml/libhtml/datalib_connect01.html">connect01</a>. The example (inspired by the model <a class="elRef" href="../gamslib_ml/libhtml/gamslib_herves.html">herves</a>) reads a 3-dimensional parameter from a spreadsheet that has one row index (<code>code</code>) at the left side of the table and the other row index (<code>labId</code>) at the right of the table. A column index (<code>cut</code>) is at the top of the table. The column index consists of floating-point numbers. The goal it to read the data into GAMS but modify the labels of some sets: Only the first two decimal digits of the elements in <code>cut</code> are significant. Moreover, the <code>labId</code> should be prefixed with an <code>L</code>. A new spreadsheet with the new labels should be written. The layout of the table should remain with the exception of moving the <code>labId</code> column also to the left. Here is a screenshot of the original table:</p>
<div class="image">
<img src="connect_gs1.png" alt=""/>
<div class="caption">
Original spreadsheet data of table raw</div></div>
<p>The following GAMS code uses a separate GAMS program (<code>getdata.gms</code>) to get the raw data from the original spreadsheet. Connect runs inside a compile-time embedded code section and uses the Connect agent <a class="el" href="#UG_GAMSCONNECT_RAWEXCELREADER">RawExcelReader</a> to get the raw Excel data. In some subsequent GAMS code the sets <code>rr</code> and <code>cut[Id]</code> as well as the parameter <code>raw</code> are filled knowing the layout of the table (the code is written in a way that the table can grow). This GAMS program gets executed and instructed to create a GDX file. In a compile-time embedded Connect section the relevant symbols (<code>rr</code>, <code>cutId</code>, and <code>raw</code>) are read from this GDX file. The <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent extracts the domain <code>labid</code> from the set <code>rr</code> and some Python code using Connect agent <a class="el" href="#UG_GAMSCONNECT_PYTHONCODE">PythonCode</a> makes the label adjustments and sorts the data nicely. The Python code uses the <a class="el" href="API_PY_GAMSTRANSFER_MAIN_CLASSES.html#PY_GAMSTRANSFER_CREATE_CONTAINER">connect.container</a> methods to read from and write to the Connect database. Finally, the <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a> agent sends the data to GAMS. In the main program at execution-time an embedded Connect code section exports the <code>labdata</code> parameter in the required form (after reading it from GAMS with the <a class="el" href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a> agent). Here is a screenshot of the resulting table:</p>
<div class="image">
<img src="connect_gs2.png" alt=""/>
<div class="caption">
Table in newly created spreadsheet with new labels and layout</div></div>
<p>In the remainder of the GAMS code another execution-time embedded Connect code is used to read the data back from the newly created spreadsheet using Connect agent <a class="el" href="#UG_GAMSCONNECT_EXCELREADER">ExcelReader</a>. The set <code>rr</code> is created from parameter <code>labdata</code> using the <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent and everything is written back to GAMS with Connect agent <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a>. The original data and the data from the newly created spreadsheet are exported to GDX (using execute_unload) and compared to verify that the data is identical by calling <a class="el" href="T_GDXDIFF.html">gdxdiff</a>.</p>
<pre><code class="language-gams">Set code, labId, cut, rr(code&lt;,labId);
parameter labdata(code,labid,cut);
$onEcho &gt; getdata.gms
* Symbols for RawExcelReader
alias (u,*); Set s,w,r,c,ws(s,w),vs(s,r,c),vu(s,r,c,u); Parameter vf(s,r,c);
$onEmbeddedCode Connect:
- RawExcelReader:
    file: labdata.xlsx
- GAMSWriter:
    symbols: all
$offEmbeddedCode

* Symbols to be filled
alias (*,code,labId,cut); Parameter raw(code,labId,cut); Set cutId, rr(code,labId)
Set cX(c,cut) 'column index', rX(r,code,labId) 'row index';
Singleton set cLast(c); Scalar lastPos;
loop(ws(s,'ZAg'),
  lastPos = smax(vu(s,r,c,u), c.pos); cLast(c) = c.pos=lastPos;
  loop(r$(ord(r)&gt;4),
    rX(r,code,labId) $= vu(s,r,'C1',code) and vu(s,r,cLast,labId));
  loop(c$(ord(c)&gt;1 and not cLast(c)),
    cX(c,cut) $= vu(s,'R4',c,cut));
  loop((rX(r,code,labId),cX(c,cut)),
    raw(code,labId,cut) = vf(s,r,c))
  loop(cX(c,cut),
    cutId(cut) = yes)
);
option rr&lt;rX;
$offEcho
$call.checkErrorLevel gams getdata.gms lo=%gams.lo% gdx=getdata.gdx
$onEmbeddedCode Connect:
- GDXReader:
    file: getdata.gdx
    symbols: [ {name: rr}, {name: raw}, {name: cutId, newName: cut} ]
- Projection:
    name: rr(code,labid)
    newName: labid(labid)
- PythonCode:
    code: |
      labid_records = sorted([ 'L'+t[0] for t in connect.container['labid'].records.values ], key=lambda t: int(t[1:]))
      rr_records = sorted([ (t[0],
                               'L'+t[1]) for t in connect.container['rr'].records.values ], key=lambda t: int(t[0]))
      # Trim elements of set cut to two decimal places
      cut_records = sorted([ '{:.2f}'.format(float(t[0])) for t in connect.container['cut'].records.values ], key=float)
      labdata_records = [ (t[0],
                             'L'+t[1],
                             '{:.2f}'.format(float(t[2])),
                             t[-1]) for t in connect.container['raw'].records.values ]

      connect.container.addSet('labid_mod', ['*'], records=labid_records)
      connect.container.addSet('rr_mod', ['*']*2, records=rr_records)
      connect.container.addSet('cut_mod', ['*'], records=cut_records)
      connect.container.addParameter('labdata', ['*']*3, records=labdata_records)
- GAMSWriter:
    symbols: [ {name: labid_mod, newName: labid}, {name: rr_mod, newName: rr}, {name: cut_mod, newName: cut}, {name: labdata} ]
    duplicateRecords: first
$offEmbeddedCode
execute_unload 'labdata.gdx', labdata, cut, rr;

* Reintroduce 0 (zeros)
labdata(rr,cut) = labdata(rr,cut) + eps;

execute 'rm -f labdatanew.xlsx';
* Write new workbook with good table
embeddedCode Connect:
- GAMSReader:
    symbols: [ {name: labdata} ]
- ExcelWriter:
    file: labdatanew.xlsx
    valueSubstitutions: {EPS: 0}
    symbols:
      - name: labdata
        range: ZAg!A4
endEmbeddedCode
option clear=rr, clear=labdata;

embeddedCode Connect:
- ExcelReader:
    file: labdatanew.xlsx
    symbols:
      - name: labdata
        rowDimension: 2
        range: ZAg!A4
- Projection:
    name: labdata(code,labid,cut)
    newName: rr(code,labid)
    asSet: True
- GAMSWriter:
    symbols: all
    duplicateRecords: first
endEmbeddedCode
execute_unload 'labdatanew.gdx', labdata, cut, rr;
execute.checkErrorLevel 'gdxdiff labdata.gdx labdatanew.gdx &gt; %system.NullFile%';
</code></pre>
<h2><a class="anchor" id="UG_GAMSCONNECT_EXAMPLES_CONNECT02"></a>
Connect Example for CSV</h2>
<p>The following example shows how to read and write CSV files in Connect. The entire code is listed at the end of the example. This model is part of DataLib as model <a class="elRef" href="../datalib_ml/libhtml/datalib_connect02.html">connect02</a>. It starts out with defining some data (<code>stockprice</code>) in a table statement in GAMS. With compile-time embedded Connect code utilizing the <a class="el" href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a> agent to bring this data into Connect and exporting it as a CSV file with agent <a class="el" href="#UG_GAMSCONNECT_CSVWRITER">CSVWriter</a>. The <a class="el" href="#UG_GAMSCONNECT_GDXWRITER">GDXWriter</a> agent also creates a GDX file with the data which is then used in a subsequent call to feed <a class="el" href="T_GDXDUMP.html">gdxdump</a> that produces the same CSV file as <a class="el" href="#UG_GAMSCONNECT_CSVWRITER">CSVWriter</a>. The text comparison tool <code>diff</code> is used to compare the two CSV files. The CSV file look as follows:</p>
<pre class="fragment">"date_0","AAPL","GOOG","MMM","MSFT","WMT"
"2012-20-11",12.124061,314.008026,60.966354,21.068886,46.991535
"2112-20-11",12.139372,311.741516,60.731037,20.850344,47.150307
"2212-20-11",12.203673,313.674286,61.467381,20.890808,46.991535
"2312-20-11",12.350039,315.387848,62.401108,21.068886,47.626663
"2712-20-11",12.448025,318.929565,62.461876,21.076981,47.499634
"2812-20-11",12.328911,318.655609,61.604042,20.898905,47.420238
"2912-20-11",12.404848,320.000549,62.332813,21.060795,47.626663
"3012-20-11",12.401172,321.744019,62.044331,21.012224,47.444057
</pre><p>In remainder of the example this CSV file is read back via the Connect agent <a class="el" href="#UG_GAMSCONNECT_CSVREADER">CSVReader</a>. The code also utilizes the tool <a class="el" href="T_DATA_CSVREAD.html">csvread</a> to read the CSV file into a GDX file. The code compares the results of both methods. <a class="el" href="T_DATA_CSVREAD.html">CSVRead</a> also creates sets with the index elements as <code>Dim1</code>, <code>Dim2</code>, ... Therefore, Connect utilizes the <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> agent to extract the index sets <code>date</code> and <code>symbol</code> from the parameter <code>stockprice</code> as sets <code>Dim1</code> and <code>Dim2</code>. The Connect agent <a class="el" href="#UG_GAMSCONNECT_GDXWRITER">GDXWriter</a> creates a GDX file of the Connect database which then can be compared with the GDX file created by <a class="el" href="T_DATA_CSVREAD.html">csvread</a>. The GDX comparison tool <a class="el" href="T_GDXDIFF.html">gdxdiff</a> is used to compare the two GDX files.</p>
<pre><code class="language-gams">Set date,symbol;
Table stockprice(date&lt;,symbol&lt;)
                AAPL       GOOG       MMM      MSFT       WMT
2012-20-11 12.124061 314.008026 60.966354 21.068886 46.991535
2112-20-11 12.139372 311.741516 60.731037 20.850344 47.150307
2212-20-11 12.203673 313.674286 61.467381 20.890808 46.991535
2312-20-11 12.350039 315.387848 62.401108 21.068886 47.626663
2712-20-11 12.448025 318.929565 62.461876 21.076981 47.499634
2812-20-11 12.328911 318.655609 61.604042 20.898905 47.420238
2912-20-11 12.404848 320.000549 62.332813 21.060795 47.626663
3012-20-11 12.401172 321.744019 62.044331 21.012224 47.444057
;

* Use Connect CSVWriter to write GAMS data in CSV format moving the symbol index into the column (unstack: True)
$onEmbeddedCode Connect:
- GAMSReader:
    symbols: [ {name: stockprice} ]
- GDXWriter:
    file: sp_connect.gdx
    symbols: all
- CSVWriter:
    file: sp_connect.csv
    name: stockprice
    header: True
    unstack: True
    quoting: 2
$offEmbeddedCode

* Use gdxdump to create a CSV file and text compare the Connect and gdxdump CSV files
$call.checkErrorLevel  gdxdump sp_connect.gdx output=sp_gdxdump.csv symb=stockprice format=csv columnDimension=Y &gt; %system.NullFile%
$call.checkErrorLevel  diff -q sp_connect.csv sp_gdxdump.csv &gt; %system.nullFile%

* Use Connect CSVReader to read the newly created CSV file and deposit the result in a csvread compatible format
$onEmbeddedCode Connect:
- CSVReader:
    file: sp_connect.csv
    name: stockprice
    indexColumns: 1
    valueColumns: "2:lastCol"
- Projection:
    name: stockprice(date,symbol)
    newName: Dim1(date)
    asSet: True
- Projection:
    name: stockprice(date,symbol)
    newName: Dim2(symbol)
    asSet: True
- GDXWriter:
    file: sp_connect.gdx
    symbols: all
    duplicateRecords: first
$offEmbeddedCode

* Use CSVRead to create a GDX file and compare the Connect and CSVRead GDX files
$call gamstool csvread sp_connect.csv id=stockprice index=1 values=2..lastCol useHeader=yes gdxout=sp_csvread.gdx &gt; %system.NullFile%
$call.checkErrorLevel gdxdiff sp_connect.gdx sp_csvread.gdx &gt; %system.NullFile%
</code></pre>
<h1><a class="anchor" id="UG_GAMSCONNECT_GAMSCONNECT_CMDPROGRAM"></a>
Command Line Utility gamsconnect</h1>
<p>The GAMS system directory contains the utility <code>gamsconnect</code> to run Connect instructions directly from the command line. On Windows the utility has the callable extension <code>.cmd</code>. This script wraps the Python script <code>connectdriver.py</code> by calling the Python interpreter that ships with GAMS. <code>gamsconnect</code> operates as the other Connect drivers on a YAML instruction file. The agents <a class="el" href="#UG_GAMSCONNECT_GAMSREADER">GAMSReader</a> and <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER">GAMSWriter</a> are not available from <code>gamsconnect</code> and will trigger an exception. Substitutions can be passed to <code>gamsconnect</code> via command line arguments as <code>key=value</code>, e.g. <code>filename=myfile.csv</code> and even <code>gams.scrdir=/tmp/</code>. <code>gamsconnect</code> is called like this:</p>
<pre class="fragment">gamsconnect &lt;YAMLFile&gt; [key1=value1 [key2=value2 [key3=value3 [...]]]]
</pre><h1><a class="anchor" id="UG_GAMSCONNECT_ADVANCED"></a>
Advanced Topics</h1>
<h2><a class="anchor" id="UG_GAMSCONNECT_CASE_SENSITIVITY"></a>
Concept of Case Sensitivity</h2>
<p>This section describes the general concept of case sensitivity in Connect. Connect is a YAML and Python based framework and is therefore <b>case sensitive</b>. The case sensitivity provides Connect users with a better control of arbitrary data that does not necessarily come in a GAMS compatible format. Many agents allow users to clean up, manipulate or transform data in other ways where case sensitivity provides the most flexibility. However, since Connect has many GAMS dependencies (GAMS is case insensitive) and processes data from many other data formats that have their own concept of case sensitivity, there are some exceptions:</p>
<ul>
<li>GAMS related operations (e.g. <a class="el" href="#UG_GAMSCONNECT_DOMAINWRITER_DROPDOMAINVIOLATIONS">dropDomainViolations</a>, <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_DUPLICATERECORDS">duplicateRecords</a>).</li>
<li>Symbol names in the Connect database. Example: A symbol <code>p</code> in the Connect database can be accessed via symbol name <code>p</code> or <code>P</code>. And if <code>p</code> exists already, a Connect agent can not create a new symbol <code>P</code>.</li>
<li>Due to the case insensitivity of symbol names in the Connect database, the index list of the DomainWriter option <a class="el" href="#UG_GAMSCONNECT_DOMAINWRITER_NAME">name</a> is also processed case insensitive. In contrast to Concatenate or Projection where the index list is solely intended to establish the index order, the DomainWriter needs to access sets in the Connect database in order to establish regular domains.</li>
<li>The behavior can sometimes be case insensitive due to the data source/target (e.g. <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_RNG">range</a>, <a class="el" href="#UG_GAMSCONNECT_EXCELWRITER_INDEX">index</a>, <a class="el" href="#UG_GAMSCONNECT_EXCELREADER_IGNORECOLUMNS">ignoreColumns</a>).</li>
<li>The behavior can sometimes be case insensitive due to the operating system (e.g. the <code>file</code> option is case insensitive on Windows).</li>
<li>The behavior can sometimes be case insensitive due to other Python libraries used (e.g. <a class="el" href="#UG_GAMSCONNECT_CSVREADER_READCSVARGS">readCSVArguments</a> passes key-value pairs directly to pandas).</li>
</ul>
<p>This implies that most Connect operations are done case sensitive. For instance, agents like <a class="el" href="#UG_GAMSCONNECT_FILTER">Filter</a>, <a class="el" href="#UG_GAMSCONNECT_LABELMANIPULATOR">LabelManipulator</a> or <a class="el" href="#UG_GAMSCONNECT_PROJECTION">Projection</a> operate case sensitive. Consider the following example that uses the Projection agent:</p>
<pre><code class="language-gams">$onecho &gt; p.csv
i1,j1,2.5
i1,j2,1.7
i2,j1,1.8
I2,j2,1.4
$offEcho

Set i;
Parameter p_reduced(i&lt;);

$onEmbeddedCode Connect:
- CSVReader:
    header: False
    file: p.csv
    name: p
    indexColumns: [1,2]
    valueColumns: 3
- Projection:
    name: p(i,j)
    newName: p_reduced(i)
    aggregationMethod: first
- PythonCode:
    code: |
        print(connect.container['p_reduced'].records)
- GAMSWriter:
    symbols:
      - name: p_reduced
        duplicateRecords: first
$offEmbeddedCode

display p_reduced;
</code></pre>
<p>Since Projection aggregates case sensitive, both records <code>I2 1.4</code> and <code>i2 1.8</code> are kept:</p>
<pre class="fragment">    0  value
0  I2    1.4
1  i1    2.5
2  i2    1.8
</pre><p>From a GAMS (case insensitive) perspective these two records are duplicates. Therefore, <a class="el" href="#UG_GAMSCONNECT_GAMSWRITER_DUPLICATERECORDS">duplicateRecords</a> must be set when writing symbol <code>p_reduced</code> to GAMS. With <code>duplicateRecords: first</code> only the first duplicate record is kept.</p>
<p>Case sensitivity also holds for substituting indices or values. Consider the following example where the index <code>j2</code> should be substituted by <code>ABC</code> when reading the CSV file <code>p.csv</code>:</p>
<pre><code class="language-gams">$onecho &gt; p.csv
i1,j1,2.5
i1,J2,1.7
i2,j1,1.8
i2,j2,1.4
$offecho

Set i,j;
Parameter p(i&lt;,j&lt;);

$onEmbeddedCode Connect:
- CSVReader:
    file: p.csv
    name: p
    indexColumns: [1,2]
    valueColumns: [3]
    header: false
    indexSubstitutions: { j2: ABC }
- GAMSWriter:
    symbols: all
$offEmbeddedCode

display i, j, p;
</code></pre>
<p>Since substituting indices is done case sensitive, the index <code>J2</code> will not be substituted.</p>
<pre class="fragment">            j1          J2         ABC

i1       2.500       1.700
i2       1.800                   1.400
</pre><h2><a class="anchor" id="UG_GAMSCONNECT_TEXT_SUBSTITUTIONS_IN_YAML_FILE"></a>
Text Substitutions in YAML Instructions</h2>
<p>In many cases one would like to <em>parameterize</em> the text in the Connect instructions. For example, some of the Connect agents require a file name. Instead of hard coding the file name into the YAML instructions, text substitutions allow to have a <em>place holder</em> for the attribute that is substituted out before giving the instructions to Connect. The place holder in the YAML instructions uses the syntax <code>%SOMETEXT%</code>, similar to the GAMS <a class="el" href="UG_GamsCall.html#UG_GamsCall_DoubleDashParametersEtc_CompileTimeVars">compile-time variables</a>. For example:</p>
<pre class="fragment">- CSVReader:
    file: %MYFILENAME%
    name: distance
    indexColumns: [1, 2]
    valueColumns: [3]
</pre><p>Depending on how Connect runs, the substitution is done in various ways. The section <a class="el" href="UG_EmbeddedCode.html#UG_EmbeddedCode_Connect_Substitution">Substitutions in Embedded Connect Code</a> described the substitution mechanisms for embedded Connect code. When Connect is initiated via the command line parameters <a class="el" href="UG_GamsCall.html#GAMSAOconnectin">connectIn</a> or <a class="el" href="UG_GamsCall.html#GAMSAOconnectout">connectOut</a>, the user defined parameter specified by <a class="el" href="UG_GamsCall.html#UG_GamsCall_DoubleDashParametersEtc_DoubleDashParam">double-dash command line parameters</a> and the given GAMS command line parameters, e.g. <code>%gams.input%</code> will be substituted in the YAML file. The list of parameters available for substitution is printed to the GAMS log at the beginning of the job in the section <code>GAMS Parameters defined</code>.</p>
<p>When Connect is initiated via the shell command <code>gamsconnect</code> all substitutions need to be specified on the command line: </p><pre class="fragment">gamsconnect myci.yaml key1=val1 key2=val2 ...
</pre><p> <code>key</code> can be just <code>MYFILENAME</code> or be composed like <code>gams.Input</code> or <code>system.dirSep</code>.</p>
<h2><a class="anchor" id="UG_GAMSCONNECT_ENCODING"></a>
Encoding of YAML Instructions</h2>
<p>All instructions provided to the Connect framework are read using <code>UTF-8</code> encoding (<code>utf-8-sig</code>). This can be customized by adding a comment in the format <code># coding=&lt;encoding name&gt;</code> or <code># -*- coding: &lt;encoding name&gt; -*-</code> as first line in the YAML code. Note that <code>UTF-16</code> encoding is not supported.</p>
<h2><a class="anchor" id="UG_GAMSCONNECT_SORTING_BEHAVIOR"></a>
Sorting Behavior of Connect Agents</h2>
<p>A note on the sorting behavior of Connect agents. All reader and transformer agents do not guarantee a specific order of the created symbol records. However, as the symbol records in the Connect database are saved in <em>categorical data structures</em>, the order in the data source is preserved in <em>ordered categories</em>. All writer agents guarantee that symbol records are written in the order of the categories. Here is an example:</p>
<pre><code class="language-gams">$onecho &gt; ijk_in.csv
i,j,k1,k2
i1,j2,,3
i2,j1,4,
i1,j1,1,2
i2,j2,5,6
$offecho

embeddedCode Connect:
- CSVReader:
    file: ijk_in.csv
    name: ijk
    valueColumns: "3:lastCol"
    indexColumns: [1,2]
- PythonCode:
    code: |
        sym = connect.container["ijk"]
        print("ijk records in the Connect database after reading:\n", sym.records)
        
        data_sorted = sym.records.sort_values(sym.records.columns[:-1].tolist())
        print("ijk records sorted according to categories:\n", data_sorted)
        
        sym.reorderUELs(uels=['j1','j2'], dimensions=1)
        data_sorted = sym.records.sort_values(sym.records.columns[:-1].tolist())
        print("ijk records sorted according to reordered categories:\n", data_sorted)
- CSVWriter:
    file: ijk_out.csv
    name: ijk
    unstack: True
endEmbeddedCode
</code></pre>
<p>From the data source <code>ijk_in.csv</code>, the <a class="el" href="#UG_GAMSCONNECT_CSVREADER">CSVReader</a> creates the symbol records as shown with the first print: </p><pre class="fragment">ijk records in the Connect database after reading:
     i   j level_2  value
0  i1  j2      k2    3.0
1  i2  j1      k1    4.0
2  i1  j1      k1    1.0
3  i1  j1      k2    2.0
4  i2  j2      k1    5.0
5  i2  j2      k2    6.0
</pre><p>The ordered categories are inferred from the data source, therefore the order for column <code>i</code> is <code>['i1','i2']</code>, for column <code>j</code> <code>['j2','j1']</code> and for column <code>k</code> the order of the header <code>['k1','k2']</code> is preserved. The categories define the order of the symbol records if sorted: </p><pre class="fragment">ijk records sorted according to categories:
     i   j level_2  value
0  i1  j2      k2    3.0
2  i1  j1      k1    1.0
3  i1  j1      k2    2.0
4  i2  j2      k1    5.0
5  i2  j2      k2    6.0
1  i2  j1      k1    4.0
</pre><p>If the order is not as desired, <code>.reorderUELs()</code> can be used to change the order of the categories, e.g. to <code>['j1','j2']</code> for column <code>j</code>: </p><pre class="fragment">ijk records sorted according to reordered categories:
     i   j level_2  value
2  i1  j1      k1    1.0
3  i1  j1      k2    2.0
0  i1  j2      k2    3.0
1  i2  j1      k1    4.0
4  i2  j2      k1    5.0
5  i2  j2      k2    6.0
</pre><p>The <a class="el" href="#UG_GAMSCONNECT_CSVWRITER">CSVWriter</a> automatically sorts the symbol records according to the categories (note that the order of column <code>j</code> was changed with the <a class="el" href="#UG_GAMSCONNECT_PYTHONCODE">PythonCode</a> agent) and therefore, the content of file <code>ijk_out.csv</code> looks as follows: </p><pre class="fragment">i,j,k1,k2
i1,j1,1.0,2.0
i1,j2,,3.0
i2,j1,4.0,
i2,j2,5.0,6.0
</pre><h2><a class="anchor" id="UG_GAMSCONNECT_CUSTOM_PYTHON_CODE"></a>
Use Connect Agents in Custom Python Code</h2>
<p>Instead of passing instructions via one of the Connect interfaces, users can execute them directly in their Python code by creating an instance of <code>ConnectDatabase</code> and calling method <code>.execute(instructions)</code>. The <code>instructions</code> argument is expected to be either a Python dictionary of form: </p><pre class="fragment">{
   '&lt;agent name&gt;':
   {
      '&lt;root option1&gt;': &lt;value&gt;,
      '&lt;root option2&gt;': &lt;value&gt;,
      ... ,
      '&lt;root option3&gt;':
      [
         {
             '&lt;option1&gt;': &lt;value&gt;,
             '&lt;option2&gt;': &lt;value&gt;,
             ...
         },
         {
             '&lt;option1&gt;': &lt;value&gt;,
             '&lt;option2&gt;': &lt;value&gt;,
             ...
         },
         ...
      ]
   }
}
</pre><p> or a list of such dictionaries in case multiple Connect agents need to be executed. Users can either construct the Python dictionary themselves or let YAML create the dictionary from a YAML script. The following example creates an instance of <code>ConnectDatabase</code> and executes two agents: First, the CSV file <code>stockprice.csv</code> is read into the Connect database and second, the symbol <code>stockprice</code> is written to the GAMS database. In this example, the agent instructions are directly specified as Python dictionaries.</p>
<pre><code class="language-gams">Set dates, stocks;
Parameter stockprice(dates&lt;,stocks&lt;);

$onEcho &gt; stockprice.csv
date;symbol;price
2016/01/04;AAPL;105,35
2016/01/04;AXP;67,59
2016/01/04;BA;140,50
$offEcho

$onEmbeddedCode Python:
from gams.connect import ConnectDatabase
cdb = ConnectDatabase(gams._system_directory, ecdb=gams)
cdb.execute({'CSVReader': {'file': 'stockprice.csv', 'name': 'stockprice', 'indexColumns': [1, 2],
                            'valueColumns': [3], 'fieldSeparator': ';', 'decimalSeparator': ','}})
cdb.execute({'GAMSWriter': {'symbols': [{'name': 'stockprice'}]}})
$offEmbeddedCode

display stockprice;
</code></pre>
<p>We can also construct the Python dictionaries by using YAML:</p>
<pre><code class="language-gams">Set dates, stocks;
Parameter stockprice(dates&lt;,stocks&lt;);

$onEcho &gt; stockprice.csv
date;symbol;price
2016/01/04;AAPL;105,35
2016/01/04;AXP;67,59
2016/01/04;BA;140,50
$offEcho

$onEmbeddedCode Python:
import yaml
from gams.connect import ConnectDatabase
cdb = ConnectDatabase(gams._system_directory, ecdb=gams)

inst = yaml.safe_load('''
- CSVReader:
    file: stockprice.csv
    name: stockprice
    indexColumns: [1, 2]
    valueColumns: [3]
    fieldSeparator: ';'
    decimalSeparator: ','
- GAMSWriter:
    symbols:
      - name: stockprice
''')
cdb.execute(inst)
$offEmbeddedCode

display stockprice;
</pre></code></pre><p>Here YAML creates a list of dictionaries (i.e. a list of tasks) from the given YAML script. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- modified HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
</div><!-- doc-content -->    
</div><!-- doc-contents -->
</div><!-- content-area -->
  <footer id="footer-area" class="bottomnav"> 
       <a id="print" class="printbtn left">Printer-friendly version </a> 
       <div class="right"> Copyright &copy; <a target="_blank" href="https://www.gams.com/">GAMS Development Corporation</a> </div>
  </footer>
<script src="./style/jquery.highlight.js"></script>
<script src="./style/navtree.js"></script>
<script src="./style/navtreeinfo.js"></script>
<script src="./style/navtreeindex.js"></script>
<script>
if (recallStatus("toc") == "hidden" || recallStatus("layout") == "collapsed") {
    $('#context-sidebar').hide();
    $('#split-bar').hide();
}
$(document).ready(function(){
   initTOCPage();
   var gamsversion = "49";
   $('#versionfilter').val('/'+gamsversion+'/docs/index.html');
$('#versionfilter').on('change', function () {
   var url = $(this).val(); 
   if (url) { 
      window.location = url; 
   }
   return false;
});

});
</script>
<div id="gamsfooter">
  




<div class="gams-site">
  <footer id="gams-site-footer" class="d-print-none">

    <div class="container">
      <div class="row">

      <div class="col-md-3 col-sm-4 mb-3">
        <strong>GAMS Development Corp.</strong><br>
        <strong>GAMS Software GmbH</strong><br>
        <br>
        <a class="mr-1" href="https://www.youtube.com/channel/UCfTAizXPo4vN54CC-Zs9TTg"><i data-feather="youtube" stroke="white" stroke-width="1" ></i></a>
        <a class="mr-1" href="https://twitter.com/gamssoftware"><i data-feather="twitter" stroke="white" stroke-width="1" ></i></a>
        <a class="mr-1" href="https://www.linkedin.com/company/gams-development-corporation/"><i data-feather="linkedin" stroke="white" stroke-width="1" ></i></a>
        <p class="mt-2">
          <a class="font-weight-bolder" href="https://www.gams.com/newsletter/signup/?utm_source=website&utm_medium=footer&utm_campaign=newsletter_signup">Newsletter</a>
        </p>
      </div>

      <div class="col-md-3 col-sm-4 mb-3">
          <strong>General Information and Sales</strong><br>
          <div class="mt-2">
            U.S.  (+1) 202 342-0180 <br>
            Europe: (+49) 221 949-9170
          </div>
          <a href="mailto:sales@gams.com?subject=Inquiry" class="mt-2 pl-4 pr-4 btn btn-gams-orange">
            <strong>SALES@GAMS.COM</strong>
          </a>
      </div>

      <div class="col-md-3 d-none d-md-block">
      </div>


    <div class="col-md-3 col-sm-4 mb-3">
        <ul class="list-unstyled ">
            <li><a  href="https://status.gams.com">Service status</a></li>
            <li><a  href="/about/privacy">Privacy policy</a></li>
            <li><a  href="/impressum">Impressum / Legal</a></li>
            <li><a  target="_blank" href="/GAMS_EULA.pdf">License Agreement</a></li>
            <li><a  target="_blank" href="/GAMS_Cloud_License_Agreement.pdf">Cloud License Agreement</a></li>
            <li><a  target="_blank" href="/GAMS_Code_of_Conduct.pdf">Code of Conduct</a></li>
            <li><a  target="_blank" href="/GAMS_Open_Source_Strategy.pdf">Open Source Strategy</a></li>
            <li><a href="/archives" >Archives</a></li>
            <li><a  href="/contact">Contact Us</a></li>
      </ul>
      </div>

  </div>

  GAMS is a registered trademark of GAMS Software GmbH in the European Union

    </div>
  </footer>
</div>















<script src="/js/bundle.js"></script>




<script src="/js/gamsSearch.js"></script>



<script src="/js/lightbox.js"></script>




<script>


  $(document).ready(function() {

    $(document).on('click', '.dropdown-menu', function(e) {
      e.stopPropagation();
    });

    
    if ($(window).width() < 992) {
      $('.dropdown-menu a').click(function(e) {


        
        if ($(this).next('.submenu').length) {
          e.preventDefault();
          $(this).next('.submenu').toggle();
        }

        
        $('.dropdown').on('hide.bs.dropdown', function() {
          $(this).find('.submenu').hide();
        })
      });
    }

    
    
    
    
    

    
    
    
    
    
    
    


    function fixModal(m) {
      
      console.log(m);
        $(m).on('shown.bs.modal', function () {
        var mobd = $('.modal-backdrop');
        var cont = $('.gams-modal-container');
        cont.append(mobd);
        $('body').css('overflow','hidden');
        })
        
        $(m).on('hide.bs.modal', function () {
          if ($(".modal-backdrop").length > 1) {  
            $(".modal-backdrop").remove();        
          }
          $('body').css('overflow','');
        })  
    }

    var modals = ['#uni_searchModal','#galleryModal', '#navTryModal'];
    modals.forEach(fixModal);


  })
</script>

<script>

$('#navTryModal').modal(options)


</script>












<script>
    feather.replace()
</script>















</div> 
</body>
</html>
